2025-05-11 12:00:59,297 - passlib.handlers.bcrypt - WARNING - (trapped) error reading bcrypt version
Traceback (most recent call last):
  File "/usr/local/lib/python3.10/site-packages/passlib/handlers/bcrypt.py", line 620, in _load_backend_mixin
    version = _bcrypt.__about__.__version__
AttributeError: module 'bcrypt' has no attribute '__about__'
2025-05-11 17:37:25,601 - passlib.handlers.bcrypt - WARNING - (trapped) error reading bcrypt version
Traceback (most recent call last):
  File "/usr/local/lib/python3.10/site-packages/passlib/handlers/bcrypt.py", line 620, in _load_backend_mixin
    version = _bcrypt.__about__.__version__
AttributeError: module 'bcrypt' has no attribute '__about__'
2025-05-11 17:38:26,800 - server-audit - INFO - Начало сканирования сервера 25.15.212.99
2025-05-11 17:38:26,825 - paramiko.transport - INFO - Connected (version 2.0, client OpenSSH_9.6p1)
2025-05-11 17:38:30,173 - paramiko.transport - INFO - Authentication (password) failed.
2025-05-11 17:38:30,173 - server-audit - ERROR - Ошибка при сканировании: Authentication failed.
2025-05-11 17:38:30,206 - server-audit - ERROR - Ошибка при сканировании сервера 25.15.212.99: Authentication failed.
2025-05-11 17:39:49,721 - server-audit - INFO - Начало сканирования сервера 25.15.212.99
2025-05-11 17:39:49,740 - paramiko.transport - INFO - Connected (version 2.0, client OpenSSH_9.6p1)
2025-05-11 17:39:49,812 - paramiko.transport - INFO - Authentication (password) successful!
2025-05-11 17:54:54,722 - passlib.handlers.bcrypt - WARNING - (trapped) error reading bcrypt version
Traceback (most recent call last):
  File "/usr/local/lib/python3.10/site-packages/passlib/handlers/bcrypt.py", line 620, in _load_backend_mixin
    version = _bcrypt.__about__.__version__
AttributeError: module 'bcrypt' has no attribute '__about__'
2025-05-11 17:55:53,202 - server-audit - INFO - Начало сканирования сервера 25.15.212.99
2025-05-11 17:55:53,226 - paramiko.transport - INFO - Connected (version 2.0, client OpenSSH_9.6p1)
2025-05-11 17:55:55,449 - paramiko.transport - INFO - Authentication (password) failed.
2025-05-11 17:55:55,449 - server-audit - ERROR - Ошибка при сканировании: Authentication failed.
2025-05-11 17:55:55,501 - server-audit - ERROR - Ошибка при сканировании сервера 25.15.212.99: Authentication failed.
2025-05-11 17:56:20,969 - server-audit - INFO - Начало сканирования сервера 25.15.212.99
2025-05-11 17:56:20,995 - paramiko.transport - INFO - Connected (version 2.0, client OpenSSH_9.6p1)
2025-05-11 17:56:21,094 - paramiko.transport - INFO - Authentication (password) successful!
2025-05-11 18:01:49,869 - passlib.handlers.bcrypt - WARNING - (trapped) error reading bcrypt version
Traceback (most recent call last):
  File "/usr/local/lib/python3.10/site-packages/passlib/handlers/bcrypt.py", line 620, in _load_backend_mixin
    version = _bcrypt.__about__.__version__
AttributeError: module 'bcrypt' has no attribute '__about__'
2025-05-11 18:02:00,322 - server-audit - INFO - Начало сканирования сервера 25.15.212.99
2025-05-11 18:02:00,408 - server-audit - INFO - Подключение к серверу 25.15.212.99 по SSH с пользователем ayan
2025-05-11 18:02:00,408 - server-audit - INFO - Используется аутентификация по паролю
2025-05-11 18:02:00,414 - paramiko.transport - INFO - Connected (version 2.0, client OpenSSH_9.6p1)
2025-05-11 18:02:00,514 - paramiko.transport - INFO - Authentication (password) successful!
2025-05-11 18:02:00,515 - server-audit - INFO - Успешное подключение к 25.15.212.99. Начинаем выполнение проверок.
2025-05-11 18:02:00,515 - server-audit - INFO - Выполнение команды для критерия 110 (1.1. Ensure periodic security updates are configured): dpkg -l | grep unattended-upgrades
2025-05-11 18:02:00,856 - server-audit - INFO - Результат выполнения команды для критерия 110:
2025-05-11 18:02:00,856 - server-audit - INFO - STDOUT: ii  unattended-upgrades                  2.9.1+nmu4ubuntu1                       all          automatic installation of security upgrades

2025-05-11 18:02:00,856 - server-audit - INFO - Сравниваем с ожидаемым результатом: 'unattended-upgrades'
2025-05-11 18:02:00,856 - server-audit - INFO - Критерий 110 ПРОЙДЕН
2025-05-11 18:02:00,856 - server-audit - INFO - Выполнение команды для критерия 210 (2.1. Ensure /tmp is configured): findmnt -n /tmp
2025-05-11 18:02:00,912 - server-audit - INFO - Результат выполнения команды для критерия 210:
2025-05-11 18:02:00,912 - server-audit - INFO - STDOUT: 
2025-05-11 18:02:00,912 - server-audit - INFO - Сравниваем с ожидаемым результатом: 'noexec'
2025-05-11 18:02:00,912 - server-audit - INFO - Критерий 210 НЕ ПРОЙДЕН
2025-05-11 18:02:00,912 - server-audit - INFO - Выполнение команды для критерия 310 (3.1. Ensure bootloader password is set): grep "^password" /boot/grub/grub.cfg
2025-05-11 18:02:00,962 - server-audit - INFO - Результат выполнения команды для критерия 310:
2025-05-11 18:02:00,963 - server-audit - INFO - STDOUT: 
2025-05-11 18:02:00,963 - server-audit - INFO - STDERR: grep: /boot/grub/grub.cfg: Permission denied

2025-05-11 18:02:00,963 - server-audit - INFO - Сравниваем с ожидаемым результатом: 'password'
2025-05-11 18:02:00,963 - server-audit - INFO - Критерий 310 НЕ ПРОЙДЕН
2025-05-11 18:02:00,963 - server-audit - INFO - Выполнение команды для критерия 409 (4.1. Ensure core dumps are restricted): grep -E "^\s*\*\s+hard\s+core" /etc/security/limits.conf
2025-05-11 18:02:01,013 - server-audit - INFO - Результат выполнения команды для критерия 409:
2025-05-11 18:02:01,013 - server-audit - INFO - STDOUT: 
2025-05-11 18:02:01,013 - server-audit - INFO - Сравниваем с ожидаемым результатом: '* hard core 0'
2025-05-11 18:02:01,013 - server-audit - INFO - Критерий 409 НЕ ПРОЙДЕН
2025-05-11 18:02:01,014 - server-audit - INFO - Выполнение команды для критерия 509 (5.1. Ensure IP forwarding is disabled): sysctl net.ipv4.ip_forward
2025-05-11 18:02:01,064 - server-audit - INFO - Результат выполнения команды для критерия 509:
2025-05-11 18:02:01,064 - server-audit - INFO - STDOUT: net.ipv4.ip_forward = 1

2025-05-11 18:02:01,065 - server-audit - INFO - Сравниваем с ожидаемым результатом: '0'
2025-05-11 18:02:01,065 - server-audit - INFO - Критерий 509 НЕ ПРОЙДЕН
2025-05-11 18:02:01,065 - server-audit - INFO - Выполнение команды для критерия 610 (6.1. Ensure wireless interfaces are disabled): rfkill list
2025-05-11 18:02:01,111 - server-audit - INFO - Результат выполнения команды для критерия 610:
2025-05-11 18:02:01,111 - server-audit - INFO - STDOUT: 
2025-05-11 18:02:01,111 - server-audit - INFO - STDERR: sh: 1: rfkill: not found

2025-05-11 18:02:01,111 - server-audit - INFO - Сравниваем с ожидаемым результатом: 'Soft blocked: yes'
2025-05-11 18:02:01,111 - server-audit - INFO - Критерий 610 НЕ ПРОЙДЕН
2025-05-11 18:02:01,111 - server-audit - INFO - Выполнение команды для критерия 710 (7.1. Ensure audit is enabled): systemctl is-active auditd
2025-05-11 18:02:01,164 - server-audit - INFO - Результат выполнения команды для критерия 710:
2025-05-11 18:02:01,164 - server-audit - INFO - STDOUT: inactive

2025-05-11 18:02:01,164 - server-audit - INFO - Сравниваем с ожидаемым результатом: 'active'
2025-05-11 18:02:01,164 - server-audit - INFO - Критерий 710 ПРОЙДЕН
2025-05-11 18:02:01,165 - server-audit - INFO - Выполнение команды для критерия 810 (8.1. Ensure password expiration is 90 days or less): grep PASS_MAX_DAYS /etc/login.defs
2025-05-11 18:02:01,212 - server-audit - INFO - Результат выполнения команды для критерия 810:
2025-05-11 18:02:01,212 - server-audit - INFO - STDOUT: #	PASS_MAX_DAYS	Maximum number of days a password may be used.
PASS_MAX_DAYS	99999

2025-05-11 18:02:01,212 - server-audit - INFO - Сравниваем с ожидаемым результатом: '90'
2025-05-11 18:02:01,212 - server-audit - INFO - Критерий 810 НЕ ПРОЙДЕН
2025-05-11 18:02:01,212 - server-audit - INFO - Выполнение команды для критерия 910 (9.1. Ensure SSH warning banner is configured): grep Banner /etc/ssh/sshd_config
2025-05-11 18:02:01,260 - server-audit - INFO - Результат выполнения команды для критерия 910:
2025-05-11 18:02:01,260 - server-audit - INFO - STDOUT: #Banner none

2025-05-11 18:02:01,260 - server-audit - INFO - Сравниваем с ожидаемым результатом: '/etc/issue.net'
2025-05-11 18:02:01,260 - server-audit - INFO - Критерий 910 НЕ ПРОЙДЕН
2025-05-11 18:02:01,260 - server-audit - INFO - Выполнение команды для критерия 1010 (10.1. Ensure permissions on /etc/passwd are configured): stat -c "%a %u %g" /etc/passwd
2025-05-11 18:02:01,309 - server-audit - INFO - Результат выполнения команды для критерия 1010:
2025-05-11 18:02:01,309 - server-audit - INFO - STDOUT: 644 0 0

2025-05-11 18:02:01,310 - server-audit - INFO - Сравниваем с ожидаемым результатом: '644 0 0'
2025-05-11 18:02:01,310 - server-audit - INFO - Критерий 1010 ПРОЙДЕН
2025-05-11 18:02:01,311 - server-audit - INFO - Выполнение команды для критерия 1110 (11.1. Ensure root PATH integrity): echo /usr/local/sbin:/usr/local/bin:/usr/sbin:/usr/bin:/sbin:/bin:/usr/games:/usr/local/games:/snap/bin:/opt/zeek/bin | grep -q "::"; echo 0
2025-05-11 18:02:01,361 - server-audit - INFO - Результат выполнения команды для критерия 1110:
2025-05-11 18:02:01,361 - server-audit - INFO - STDOUT: 0

2025-05-11 18:02:01,362 - server-audit - INFO - Сравниваем с ожидаемым результатом: '1'
2025-05-11 18:02:01,362 - server-audit - INFO - Критерий 1110 НЕ ПРОЙДЕН
2025-05-11 18:02:01,362 - server-audit - INFO - Выполнение команды для критерия 1210 (12.1. Ensure no users have .forward files): find /home -name .forward
2025-05-11 18:02:01,672 - server-audit - INFO - Результат выполнения команды для критерия 1210:
2025-05-11 18:02:01,672 - server-audit - INFO - STDOUT: 
2025-05-11 18:02:01,672 - server-audit - INFO - STDERR: find: ‘/home/aidar’: Permission denied

2025-05-11 18:02:01,672 - server-audit - INFO - Сравниваем с ожидаемым результатом: ''
2025-05-11 18:02:01,673 - server-audit - INFO - Критерий 1210 НЕ ПРОЙДЕН
2025-05-11 18:02:01,673 - server-audit - INFO - Сканирование сервера 25.15.212.99 завершено. Закрываем SSH-соединение.
2025-05-11 18:02:58,363 - server-audit - INFO - Начало сканирования сервера 25.15.212.99
2025-05-11 18:02:58,379 - server-audit - INFO - Подключение к серверу 25.15.212.99 по SSH с пользователем aidar
2025-05-11 18:02:58,379 - server-audit - INFO - Используется аутентификация по паролю
2025-05-11 18:02:58,385 - paramiko.transport - INFO - Connected (version 2.0, client OpenSSH_9.6p1)
2025-05-11 18:02:58,442 - paramiko.transport - INFO - Authentication (password) successful!
2025-05-11 18:02:58,443 - server-audit - INFO - Успешное подключение к 25.15.212.99. Начинаем выполнение проверок.
2025-05-11 18:02:58,443 - server-audit - INFO - Выполнение команды для критерия 110 (1.1. Ensure periodic security updates are configured): dpkg -l | grep unattended-upgrades
2025-05-11 18:02:58,694 - server-audit - INFO - Результат выполнения команды для критерия 110:
2025-05-11 18:02:58,694 - server-audit - INFO - STDOUT: ii  unattended-upgrades                  2.9.1+nmu4ubuntu1                       all          automatic installation of security upgrades

2025-05-11 18:02:58,694 - server-audit - INFO - Сравниваем с ожидаемым результатом: 'unattended-upgrades'
2025-05-11 18:02:58,694 - server-audit - INFO - Критерий 110 ПРОЙДЕН
2025-05-11 18:02:58,694 - server-audit - INFO - Выполнение команды для критерия 210 (2.1. Ensure /tmp is configured): findmnt -n /tmp
2025-05-11 18:02:58,745 - server-audit - INFO - Результат выполнения команды для критерия 210:
2025-05-11 18:02:58,745 - server-audit - INFO - STDOUT: 
2025-05-11 18:02:58,745 - server-audit - INFO - Сравниваем с ожидаемым результатом: 'noexec'
2025-05-11 18:02:58,745 - server-audit - INFO - Критерий 210 НЕ ПРОЙДЕН
2025-05-11 18:02:58,745 - server-audit - INFO - Выполнение команды для критерия 310 (3.1. Ensure bootloader password is set): grep "^password" /boot/grub/grub.cfg
2025-05-11 18:02:58,796 - server-audit - INFO - Результат выполнения команды для критерия 310:
2025-05-11 18:02:58,796 - server-audit - INFO - STDOUT: 
2025-05-11 18:02:58,796 - server-audit - INFO - STDERR: grep: /boot/grub/grub.cfg: Permission denied

2025-05-11 18:02:58,796 - server-audit - INFO - Сравниваем с ожидаемым результатом: 'password'
2025-05-11 18:02:58,796 - server-audit - INFO - Критерий 310 НЕ ПРОЙДЕН
2025-05-11 18:02:58,797 - server-audit - INFO - Выполнение команды для критерия 409 (4.1. Ensure core dumps are restricted): grep -E "^\s*\*\s+hard\s+core" /etc/security/limits.conf
2025-05-11 18:02:58,844 - server-audit - INFO - Результат выполнения команды для критерия 409:
2025-05-11 18:02:58,845 - server-audit - INFO - STDOUT: 
2025-05-11 18:02:58,845 - server-audit - INFO - Сравниваем с ожидаемым результатом: '* hard core 0'
2025-05-11 18:02:58,845 - server-audit - INFO - Критерий 409 НЕ ПРОЙДЕН
2025-05-11 18:02:58,846 - server-audit - INFO - Выполнение команды для критерия 509 (5.1. Ensure IP forwarding is disabled): sysctl net.ipv4.ip_forward
2025-05-11 18:02:58,895 - server-audit - INFO - Результат выполнения команды для критерия 509:
2025-05-11 18:02:58,895 - server-audit - INFO - STDOUT: net.ipv4.ip_forward = 1

2025-05-11 18:02:58,895 - server-audit - INFO - Сравниваем с ожидаемым результатом: '0'
2025-05-11 18:02:58,895 - server-audit - INFO - Критерий 509 НЕ ПРОЙДЕН
2025-05-11 18:02:58,895 - server-audit - INFO - Выполнение команды для критерия 610 (6.1. Ensure wireless interfaces are disabled): rfkill list
2025-05-11 18:02:58,942 - server-audit - INFO - Результат выполнения команды для критерия 610:
2025-05-11 18:02:58,943 - server-audit - INFO - STDOUT: 
2025-05-11 18:02:58,943 - server-audit - INFO - STDERR: bash: line 1: rfkill: command not found

2025-05-11 18:02:58,943 - server-audit - INFO - Сравниваем с ожидаемым результатом: 'Soft blocked: yes'
2025-05-11 18:02:58,943 - server-audit - INFO - Критерий 610 НЕ ПРОЙДЕН
2025-05-11 18:02:58,943 - server-audit - INFO - Выполнение команды для критерия 710 (7.1. Ensure audit is enabled): systemctl is-active auditd
2025-05-11 18:02:58,997 - server-audit - INFO - Результат выполнения команды для критерия 710:
2025-05-11 18:02:58,997 - server-audit - INFO - STDOUT: inactive

2025-05-11 18:02:58,997 - server-audit - INFO - Сравниваем с ожидаемым результатом: 'active'
2025-05-11 18:02:58,997 - server-audit - INFO - Критерий 710 ПРОЙДЕН
2025-05-11 18:02:58,997 - server-audit - INFO - Выполнение команды для критерия 810 (8.1. Ensure password expiration is 90 days or less): grep PASS_MAX_DAYS /etc/login.defs
2025-05-11 18:02:59,045 - server-audit - INFO - Результат выполнения команды для критерия 810:
2025-05-11 18:02:59,045 - server-audit - INFO - STDOUT: #	PASS_MAX_DAYS	Maximum number of days a password may be used.
PASS_MAX_DAYS	99999

2025-05-11 18:02:59,045 - server-audit - INFO - Сравниваем с ожидаемым результатом: '90'
2025-05-11 18:02:59,045 - server-audit - INFO - Критерий 810 НЕ ПРОЙДЕН
2025-05-11 18:02:59,045 - server-audit - INFO - Выполнение команды для критерия 910 (9.1. Ensure SSH warning banner is configured): grep Banner /etc/ssh/sshd_config
2025-05-11 18:02:59,095 - server-audit - INFO - Результат выполнения команды для критерия 910:
2025-05-11 18:02:59,095 - server-audit - INFO - STDOUT: #Banner none

2025-05-11 18:02:59,095 - server-audit - INFO - Сравниваем с ожидаемым результатом: '/etc/issue.net'
2025-05-11 18:02:59,095 - server-audit - INFO - Критерий 910 НЕ ПРОЙДЕН
2025-05-11 18:02:59,096 - server-audit - INFO - Выполнение команды для критерия 1010 (10.1. Ensure permissions on /etc/passwd are configured): stat -c "%a %u %g" /etc/passwd
2025-05-11 18:02:59,145 - server-audit - INFO - Результат выполнения команды для критерия 1010:
2025-05-11 18:02:59,145 - server-audit - INFO - STDOUT: 644 0 0

2025-05-11 18:02:59,145 - server-audit - INFO - Сравниваем с ожидаемым результатом: '644 0 0'
2025-05-11 18:02:59,145 - server-audit - INFO - Критерий 1010 ПРОЙДЕН
2025-05-11 18:02:59,145 - server-audit - INFO - Выполнение команды для критерия 1110 (11.1. Ensure root PATH integrity): echo /usr/local/sbin:/usr/local/bin:/usr/sbin:/usr/bin:/sbin:/bin:/usr/games:/usr/local/games:/snap/bin:/opt/zeek/bin | grep -q "::"; echo 0
2025-05-11 18:02:59,196 - server-audit - INFO - Результат выполнения команды для критерия 1110:
2025-05-11 18:02:59,196 - server-audit - INFO - STDOUT: 0

2025-05-11 18:02:59,196 - server-audit - INFO - Сравниваем с ожидаемым результатом: '1'
2025-05-11 18:02:59,196 - server-audit - INFO - Критерий 1110 НЕ ПРОЙДЕН
2025-05-11 18:02:59,196 - server-audit - INFO - Выполнение команды для критерия 1210 (12.1. Ensure no users have .forward files): find /home -name .forward
2025-05-11 18:02:59,828 - server-audit - INFO - Результат выполнения команды для критерия 1210:
2025-05-11 18:02:59,828 - server-audit - INFO - STDOUT: 
2025-05-11 18:02:59,828 - server-audit - INFO - STDERR: find: ‘/home/ayan’: Permission denied

2025-05-11 18:02:59,828 - server-audit - INFO - Сравниваем с ожидаемым результатом: ''
2025-05-11 18:02:59,828 - server-audit - INFO - Критерий 1210 НЕ ПРОЙДЕН
2025-05-11 18:02:59,828 - server-audit - INFO - Сканирование сервера 25.15.212.99 завершено. Закрываем SSH-соединение.
2025-05-11 18:09:14,745 - server-audit - INFO - Начало сканирования сервера 25.13.178.117
2025-05-11 18:09:14,766 - server-audit - INFO - Подключение к серверу 25.13.178.117 по WinRM пока не реализовано
2025-05-11 18:18:49,194 - server-audit - INFO - Попытка входа с именем пользователя: admin
2025-05-11 18:18:49,197 - passlib.handlers.bcrypt - WARNING - (trapped) error reading bcrypt version
Traceback (most recent call last):
  File "/usr/local/lib/python3.10/site-packages/passlib/handlers/bcrypt.py", line 620, in _load_backend_mixin
    version = _bcrypt.__about__.__version__
AttributeError: module 'bcrypt' has no attribute '__about__'
2025-05-11 18:18:49,417 - server-audit - INFO - Успешный вход для пользователя: admin
2025-05-11 18:19:06,123 - server-audit - INFO - Начало сканирования сервера 25.15.212.99
2025-05-11 18:19:06,139 - server-audit - INFO - Подключение к серверу 25.15.212.99 по SSH с пользователем ayan
2025-05-11 18:19:06,139 - server-audit - INFO - Используется аутентификация по паролю
2025-05-11 18:19:06,145 - paramiko.transport - INFO - Connected (version 2.0, client OpenSSH_9.6p1)
2025-05-11 18:19:06,292 - paramiko.transport - INFO - Authentication (password) successful!
2025-05-11 18:19:06,292 - server-audit - INFO - Успешное подключение к 25.15.212.99. Начинаем выполнение проверок.
2025-05-11 18:19:06,292 - server-audit - INFO - Выполнение команды для критерия 110 (1.1. Ensure periodic security updates are configured): dpkg -l | grep unattended-upgrades
2025-05-11 18:19:06,631 - server-audit - INFO - Результат выполнения команды для критерия 110:
2025-05-11 18:19:06,632 - server-audit - INFO - STDOUT: ii  unattended-upgrades                  2.9.1+nmu4ubuntu1                       all          automatic installation of security upgrades

2025-05-11 18:19:06,632 - server-audit - INFO - Сравниваем с ожидаемым результатом: 'unattended-upgrades'
2025-05-11 18:19:06,632 - server-audit - INFO - Критерий 110 ПРОЙДЕН
2025-05-11 18:19:06,632 - server-audit - INFO - Выполнение команды для критерия 210 (2.1. Ensure /tmp is configured): findmnt -n /tmp
2025-05-11 18:19:06,683 - server-audit - INFO - Результат выполнения команды для критерия 210:
2025-05-11 18:19:06,683 - server-audit - INFO - STDOUT: 
2025-05-11 18:19:06,683 - server-audit - INFO - Сравниваем с ожидаемым результатом: 'noexec'
2025-05-11 18:19:06,683 - server-audit - INFO - Критерий 210 НЕ ПРОЙДЕН
2025-05-11 18:19:06,683 - server-audit - INFO - Выполнение команды для критерия 310 (3.1. Ensure bootloader password is set): grep "^password" /boot/grub/grub.cfg
2025-05-11 18:19:06,732 - server-audit - INFO - Результат выполнения команды для критерия 310:
2025-05-11 18:19:06,733 - server-audit - INFO - STDOUT: 
2025-05-11 18:19:06,733 - server-audit - INFO - STDERR: grep: /boot/grub/grub.cfg: Permission denied

2025-05-11 18:19:06,733 - server-audit - INFO - Сравниваем с ожидаемым результатом: 'password'
2025-05-11 18:19:06,733 - server-audit - INFO - Критерий 310 НЕ ПРОЙДЕН
2025-05-11 18:19:06,733 - server-audit - INFO - Выполнение команды для критерия 409 (4.1. Ensure core dumps are restricted): grep -E "^\s*\*\s+hard\s+core" /etc/security/limits.conf
2025-05-11 18:19:06,781 - server-audit - INFO - Результат выполнения команды для критерия 409:
2025-05-11 18:19:06,781 - server-audit - INFO - STDOUT: 
2025-05-11 18:19:06,782 - server-audit - INFO - Сравниваем с ожидаемым результатом: '* hard core 0'
2025-05-11 18:19:06,782 - server-audit - INFO - Критерий 409 НЕ ПРОЙДЕН
2025-05-11 18:19:06,782 - server-audit - INFO - Выполнение команды для критерия 509 (5.1. Ensure IP forwarding is disabled): sysctl net.ipv4.ip_forward
2025-05-11 18:19:06,832 - server-audit - INFO - Результат выполнения команды для критерия 509:
2025-05-11 18:19:06,832 - server-audit - INFO - STDOUT: net.ipv4.ip_forward = 1

2025-05-11 18:19:06,832 - server-audit - INFO - Сравниваем с ожидаемым результатом: '0'
2025-05-11 18:19:06,833 - server-audit - INFO - Критерий 509 НЕ ПРОЙДЕН
2025-05-11 18:19:06,833 - server-audit - INFO - Выполнение команды для критерия 610 (6.1. Ensure wireless interfaces are disabled): rfkill list
2025-05-11 18:19:06,882 - server-audit - INFO - Результат выполнения команды для критерия 610:
2025-05-11 18:19:06,882 - server-audit - INFO - STDOUT: 
2025-05-11 18:19:06,882 - server-audit - INFO - STDERR: sh: 1: rfkill: not found

2025-05-11 18:19:06,882 - server-audit - INFO - Сравниваем с ожидаемым результатом: 'Soft blocked: yes'
2025-05-11 18:19:06,882 - server-audit - INFO - Критерий 610 НЕ ПРОЙДЕН
2025-05-11 18:19:06,882 - server-audit - INFO - Выполнение команды для критерия 710 (7.1. Ensure audit is enabled): systemctl is-active auditd
2025-05-11 18:19:06,936 - server-audit - INFO - Результат выполнения команды для критерия 710:
2025-05-11 18:19:06,936 - server-audit - INFO - STDOUT: inactive

2025-05-11 18:19:06,936 - server-audit - INFO - Сравниваем с ожидаемым результатом: 'active'
2025-05-11 18:19:06,936 - server-audit - INFO - Критерий 710 ПРОЙДЕН
2025-05-11 18:19:06,936 - server-audit - INFO - Выполнение команды для критерия 810 (8.1. Ensure password expiration is 90 days or less): grep PASS_MAX_DAYS /etc/login.defs
2025-05-11 18:19:06,986 - server-audit - INFO - Результат выполнения команды для критерия 810:
2025-05-11 18:19:06,987 - server-audit - INFO - STDOUT: #	PASS_MAX_DAYS	Maximum number of days a password may be used.
PASS_MAX_DAYS	99999

2025-05-11 18:19:06,988 - server-audit - INFO - Сравниваем с ожидаемым результатом: '90'
2025-05-11 18:19:06,988 - server-audit - INFO - Критерий 810 НЕ ПРОЙДЕН
2025-05-11 18:19:06,988 - server-audit - INFO - Выполнение команды для критерия 910 (9.1. Ensure SSH warning banner is configured): grep Banner /etc/ssh/sshd_config
2025-05-11 18:19:07,036 - server-audit - INFO - Результат выполнения команды для критерия 910:
2025-05-11 18:19:07,036 - server-audit - INFO - STDOUT: #Banner none

2025-05-11 18:19:07,036 - server-audit - INFO - Сравниваем с ожидаемым результатом: '/etc/issue.net'
2025-05-11 18:19:07,037 - server-audit - INFO - Критерий 910 НЕ ПРОЙДЕН
2025-05-11 18:19:07,037 - server-audit - INFO - Выполнение команды для критерия 1010 (10.1. Ensure permissions on /etc/passwd are configured): stat -c "%a %u %g" /etc/passwd
2025-05-11 18:19:07,085 - server-audit - INFO - Результат выполнения команды для критерия 1010:
2025-05-11 18:19:07,085 - server-audit - INFO - STDOUT: 644 0 0

2025-05-11 18:19:07,085 - server-audit - INFO - Сравниваем с ожидаемым результатом: '644 0 0'
2025-05-11 18:19:07,085 - server-audit - INFO - Критерий 1010 ПРОЙДЕН
2025-05-11 18:19:07,085 - server-audit - INFO - Выполнение команды для критерия 1110 (11.1. Ensure root PATH integrity): echo /usr/local/sbin:/usr/local/bin:/usr/sbin:/usr/bin:/sbin:/bin:/usr/games:/usr/local/games:/snap/bin:/opt/zeek/bin | grep -q "::"; echo 0
2025-05-11 18:19:07,133 - server-audit - INFO - Результат выполнения команды для критерия 1110:
2025-05-11 18:19:07,133 - server-audit - INFO - STDOUT: 0

2025-05-11 18:19:07,134 - server-audit - INFO - Сравниваем с ожидаемым результатом: '1'
2025-05-11 18:19:07,134 - server-audit - INFO - Критерий 1110 НЕ ПРОЙДЕН
2025-05-11 18:19:07,134 - server-audit - INFO - Выполнение команды для критерия 1210 (12.1. Ensure no users have .forward files): find /home -name .forward
2025-05-11 18:19:07,202 - server-audit - INFO - Результат выполнения команды для критерия 1210:
2025-05-11 18:19:07,202 - server-audit - INFO - STDOUT: 
2025-05-11 18:19:07,202 - server-audit - INFO - STDERR: find: ‘/home/aidar’: Permission denied

2025-05-11 18:19:07,202 - server-audit - INFO - Сравниваем с ожидаемым результатом: ''
2025-05-11 18:19:07,202 - server-audit - INFO - Критерий 1210 НЕ ПРОЙДЕН
2025-05-11 18:19:07,202 - server-audit - INFO - Сканирование сервера 25.15.212.99 завершено. Закрываем SSH-соединение.
2025-05-11 18:20:20,235 - server-audit - INFO - Попытка входа с именем пользователя: admin
2025-05-11 18:20:20,438 - server-audit - INFO - Успешный вход для пользователя: admin
2025-05-11 18:20:33,472 - server-audit - INFO - Начало сканирования сервера 25.15.212.99
2025-05-11 18:20:33,493 - server-audit - INFO - Подключение к серверу 25.15.212.99 по SSH с пользователем aidar
2025-05-11 18:20:33,493 - server-audit - INFO - Используется аутентификация по паролю
2025-05-11 18:20:33,499 - paramiko.transport - INFO - Connected (version 2.0, client OpenSSH_9.6p1)
2025-05-11 18:20:33,551 - paramiko.transport - INFO - Authentication (password) successful!
2025-05-11 18:20:33,551 - server-audit - INFO - Успешное подключение к 25.15.212.99. Начинаем выполнение проверок.
2025-05-11 18:20:33,551 - server-audit - INFO - Выполнение команды для критерия 110 (1.1. Ensure periodic security updates are configured): dpkg -l | grep unattended-upgrades
2025-05-11 18:20:33,987 - server-audit - INFO - Результат выполнения команды для критерия 110:
2025-05-11 18:20:33,988 - server-audit - INFO - STDOUT: ii  unattended-upgrades                  2.9.1+nmu4ubuntu1                       all          automatic installation of security upgrades

2025-05-11 18:20:33,988 - server-audit - INFO - Сравниваем с ожидаемым результатом: 'unattended-upgrades'
2025-05-11 18:20:33,988 - server-audit - INFO - Критерий 110 ПРОЙДЕН
2025-05-11 18:20:33,988 - server-audit - INFO - Выполнение команды для критерия 210 (2.1. Ensure /tmp is configured): findmnt -n /tmp
2025-05-11 18:20:34,038 - server-audit - INFO - Результат выполнения команды для критерия 210:
2025-05-11 18:20:34,038 - server-audit - INFO - STDOUT: 
2025-05-11 18:20:34,038 - server-audit - INFO - Сравниваем с ожидаемым результатом: 'noexec'
2025-05-11 18:20:34,039 - server-audit - INFO - Критерий 210 НЕ ПРОЙДЕН
2025-05-11 18:20:34,039 - server-audit - INFO - Выполнение команды для критерия 310 (3.1. Ensure bootloader password is set): grep "^password" /boot/grub/grub.cfg
2025-05-11 18:20:34,087 - server-audit - INFO - Результат выполнения команды для критерия 310:
2025-05-11 18:20:34,087 - server-audit - INFO - STDOUT: 
2025-05-11 18:20:34,088 - server-audit - INFO - STDERR: grep: /boot/grub/grub.cfg: Permission denied

2025-05-11 18:20:34,088 - server-audit - INFO - Сравниваем с ожидаемым результатом: 'password'
2025-05-11 18:20:34,088 - server-audit - INFO - Критерий 310 НЕ ПРОЙДЕН
2025-05-11 18:20:34,088 - server-audit - INFO - Выполнение команды для критерия 409 (4.1. Ensure core dumps are restricted): grep -E "^\s*\*\s+hard\s+core" /etc/security/limits.conf
2025-05-11 18:20:34,139 - server-audit - INFO - Результат выполнения команды для критерия 409:
2025-05-11 18:20:34,139 - server-audit - INFO - STDOUT: 
2025-05-11 18:20:34,139 - server-audit - INFO - Сравниваем с ожидаемым результатом: '* hard core 0'
2025-05-11 18:20:34,139 - server-audit - INFO - Критерий 409 НЕ ПРОЙДЕН
2025-05-11 18:20:34,139 - server-audit - INFO - Выполнение команды для критерия 509 (5.1. Ensure IP forwarding is disabled): sysctl net.ipv4.ip_forward
2025-05-11 18:20:34,189 - server-audit - INFO - Результат выполнения команды для критерия 509:
2025-05-11 18:20:34,189 - server-audit - INFO - STDOUT: net.ipv4.ip_forward = 1

2025-05-11 18:20:34,189 - server-audit - INFO - Сравниваем с ожидаемым результатом: '0'
2025-05-11 18:20:34,189 - server-audit - INFO - Критерий 509 НЕ ПРОЙДЕН
2025-05-11 18:20:34,189 - server-audit - INFO - Выполнение команды для критерия 610 (6.1. Ensure wireless interfaces are disabled): rfkill list
2025-05-11 18:20:34,236 - server-audit - INFO - Результат выполнения команды для критерия 610:
2025-05-11 18:20:34,236 - server-audit - INFO - STDOUT: 
2025-05-11 18:20:34,237 - server-audit - INFO - STDERR: bash: line 1: rfkill: command not found

2025-05-11 18:20:34,237 - server-audit - INFO - Сравниваем с ожидаемым результатом: 'Soft blocked: yes'
2025-05-11 18:20:34,237 - server-audit - INFO - Критерий 610 НЕ ПРОЙДЕН
2025-05-11 18:20:34,237 - server-audit - INFO - Выполнение команды для критерия 710 (7.1. Ensure audit is enabled): systemctl is-active auditd
2025-05-11 18:20:34,287 - server-audit - INFO - Результат выполнения команды для критерия 710:
2025-05-11 18:20:34,288 - server-audit - INFO - STDOUT: inactive

2025-05-11 18:20:34,288 - server-audit - INFO - Сравниваем с ожидаемым результатом: 'active'
2025-05-11 18:20:34,288 - server-audit - INFO - Критерий 710 ПРОЙДЕН
2025-05-11 18:20:34,288 - server-audit - INFO - Выполнение команды для критерия 810 (8.1. Ensure password expiration is 90 days or less): grep PASS_MAX_DAYS /etc/login.defs
2025-05-11 18:20:34,338 - server-audit - INFO - Результат выполнения команды для критерия 810:
2025-05-11 18:20:34,338 - server-audit - INFO - STDOUT: #	PASS_MAX_DAYS	Maximum number of days a password may be used.
PASS_MAX_DAYS	99999

2025-05-11 18:20:34,339 - server-audit - INFO - Сравниваем с ожидаемым результатом: '90'
2025-05-11 18:20:34,339 - server-audit - INFO - Критерий 810 НЕ ПРОЙДЕН
2025-05-11 18:20:34,339 - server-audit - INFO - Выполнение команды для критерия 910 (9.1. Ensure SSH warning banner is configured): grep Banner /etc/ssh/sshd_config
2025-05-11 18:20:34,388 - server-audit - INFO - Результат выполнения команды для критерия 910:
2025-05-11 18:20:34,388 - server-audit - INFO - STDOUT: #Banner none

2025-05-11 18:20:34,389 - server-audit - INFO - Сравниваем с ожидаемым результатом: '/etc/issue.net'
2025-05-11 18:20:34,389 - server-audit - INFO - Критерий 910 НЕ ПРОЙДЕН
2025-05-11 18:20:34,389 - server-audit - INFO - Выполнение команды для критерия 1010 (10.1. Ensure permissions on /etc/passwd are configured): stat -c "%a %u %g" /etc/passwd
2025-05-11 18:20:34,436 - server-audit - INFO - Результат выполнения команды для критерия 1010:
2025-05-11 18:20:34,436 - server-audit - INFO - STDOUT: 644 0 0

2025-05-11 18:20:34,436 - server-audit - INFO - Сравниваем с ожидаемым результатом: '644 0 0'
2025-05-11 18:20:34,436 - server-audit - INFO - Критерий 1010 ПРОЙДЕН
2025-05-11 18:20:34,436 - server-audit - INFO - Выполнение команды для критерия 1110 (11.1. Ensure root PATH integrity): echo $PATH | grep -q "::" && echo "Empty Directory" || echo "1"
2025-05-11 18:20:34,487 - server-audit - INFO - Результат выполнения команды для критерия 1110:
2025-05-11 18:20:34,487 - server-audit - INFO - STDOUT: 1

2025-05-11 18:20:34,487 - server-audit - INFO - Сравниваем с ожидаемым результатом: '1'
2025-05-11 18:20:34,487 - server-audit - INFO - Критерий 1110 ПРОЙДЕН
2025-05-11 18:20:34,487 - server-audit - INFO - Выполнение команды для критерия 1210 (12.1. Ensure no users have .forward files): find /home -name .forward
2025-05-11 18:20:34,582 - server-audit - INFO - Результат выполнения команды для критерия 1210:
2025-05-11 18:20:34,582 - server-audit - INFO - STDOUT: 
2025-05-11 18:20:34,582 - server-audit - INFO - STDERR: find: ‘/home/ayan’: Permission denied

2025-05-11 18:20:34,582 - server-audit - INFO - Сравниваем с ожидаемым результатом: ''
2025-05-11 18:20:34,583 - server-audit - INFO - Критерий 1210 НЕ ПРОЙДЕН
2025-05-11 18:20:34,583 - server-audit - INFO - Сканирование сервера 25.15.212.99 завершено. Закрываем SSH-соединение.
2025-05-11 18:24:00,062 - server-audit - INFO - Начало сканирования сервера 25.15.212.99
2025-05-11 18:24:00,081 - server-audit - INFO - Подключение к серверу 25.15.212.99 по SSH с пользователем ayan
2025-05-11 18:24:00,081 - server-audit - INFO - Используется аутентификация по паролю
2025-05-11 18:24:00,087 - paramiko.transport - INFO - Connected (version 2.0, client OpenSSH_9.6p1)
2025-05-11 18:24:00,186 - paramiko.transport - INFO - Authentication (password) successful!
2025-05-11 18:24:00,186 - server-audit - INFO - Успешное подключение к 25.15.212.99. Начинаем выполнение проверок.
2025-05-11 18:24:00,186 - server-audit - INFO - Выполнение команды для критерия 110 (1.1. Ensure periodic security updates are configured): dpkg -l | grep unattended-upgrades
2025-05-11 18:24:00,508 - server-audit - INFO - Результат выполнения команды для критерия 110:
2025-05-11 18:24:00,508 - server-audit - INFO - STDOUT: ii  unattended-upgrades                  2.9.1+nmu4ubuntu1                       all          automatic installation of security upgrades

2025-05-11 18:24:00,508 - server-audit - INFO - Сравниваем с ожидаемым результатом: 'unattended-upgrades'
2025-05-11 18:24:00,508 - server-audit - INFO - Критерий 110 ПРОЙДЕН
2025-05-11 18:24:00,508 - server-audit - INFO - Выполнение команды для критерия 210 (2.1. Ensure /tmp is configured): findmnt -n /tmp
2025-05-11 18:24:00,557 - server-audit - INFO - Результат выполнения команды для критерия 210:
2025-05-11 18:24:00,557 - server-audit - INFO - STDOUT: 
2025-05-11 18:24:00,558 - server-audit - INFO - Сравниваем с ожидаемым результатом: 'noexec'
2025-05-11 18:24:00,558 - server-audit - INFO - Критерий 210 НЕ ПРОЙДЕН
2025-05-11 18:24:00,558 - server-audit - INFO - Выполнение команды для критерия 310 (3.1. Ensure bootloader password is set): grep "^password" /boot/grub/grub.cfg
2025-05-11 18:24:00,606 - server-audit - INFO - Результат выполнения команды для критерия 310:
2025-05-11 18:24:00,606 - server-audit - INFO - STDOUT: 
2025-05-11 18:24:00,606 - server-audit - INFO - STDERR: grep: /boot/grub/grub.cfg: Permission denied

2025-05-11 18:24:00,606 - server-audit - INFO - Сравниваем с ожидаемым результатом: 'password'
2025-05-11 18:24:00,606 - server-audit - INFO - Критерий 310 НЕ ПРОЙДЕН
2025-05-11 18:24:00,606 - server-audit - INFO - Выполнение команды для критерия 409 (4.1. Ensure core dumps are restricted): grep -E "^\s*\*\s+hard\s+core" /etc/security/limits.conf
2025-05-11 18:24:00,656 - server-audit - INFO - Результат выполнения команды для критерия 409:
2025-05-11 18:24:00,656 - server-audit - INFO - STDOUT: 
2025-05-11 18:24:00,656 - server-audit - INFO - Сравниваем с ожидаемым результатом: '* hard core 0'
2025-05-11 18:24:00,656 - server-audit - INFO - Критерий 409 НЕ ПРОЙДЕН
2025-05-11 18:24:00,656 - server-audit - INFO - Выполнение команды для критерия 509 (5.1. Ensure IP forwarding is disabled): sysctl net.ipv4.ip_forward
2025-05-11 18:24:00,705 - server-audit - INFO - Результат выполнения команды для критерия 509:
2025-05-11 18:24:00,705 - server-audit - INFO - STDOUT: net.ipv4.ip_forward = 1

2025-05-11 18:24:00,705 - server-audit - INFO - Сравниваем с ожидаемым результатом: '0'
2025-05-11 18:24:00,706 - server-audit - INFO - Критерий 509 НЕ ПРОЙДЕН
2025-05-11 18:24:00,706 - server-audit - INFO - Выполнение команды для критерия 610 (6.1. Ensure wireless interfaces are disabled): rfkill list
2025-05-11 18:24:00,754 - server-audit - INFO - Результат выполнения команды для критерия 610:
2025-05-11 18:24:00,754 - server-audit - INFO - STDOUT: 
2025-05-11 18:24:00,755 - server-audit - INFO - STDERR: sh: 1: rfkill: not found

2025-05-11 18:24:00,755 - server-audit - INFO - Сравниваем с ожидаемым результатом: 'Soft blocked: yes'
2025-05-11 18:24:00,755 - server-audit - INFO - Критерий 610 НЕ ПРОЙДЕН
2025-05-11 18:24:00,755 - server-audit - INFO - Выполнение команды для критерия 710 (7.1. Ensure audit is enabled): systemctl is-active auditd
2025-05-11 18:24:00,808 - server-audit - INFO - Результат выполнения команды для критерия 710:
2025-05-11 18:24:00,809 - server-audit - INFO - STDOUT: inactive

2025-05-11 18:24:00,809 - server-audit - INFO - Сравниваем с ожидаемым результатом: 'active'
2025-05-11 18:24:00,809 - server-audit - INFO - Критерий 710 ПРОЙДЕН
2025-05-11 18:24:00,809 - server-audit - INFO - Выполнение команды для критерия 810 (8.1. Ensure password expiration is 90 days or less): grep PASS_MAX_DAYS /etc/login.defs
2025-05-11 18:24:00,857 - server-audit - INFO - Результат выполнения команды для критерия 810:
2025-05-11 18:24:00,857 - server-audit - INFO - STDOUT: #	PASS_MAX_DAYS	Maximum number of days a password may be used.
PASS_MAX_DAYS	99999

2025-05-11 18:24:00,857 - server-audit - INFO - Сравниваем с ожидаемым результатом: '90'
2025-05-11 18:24:00,857 - server-audit - INFO - Критерий 810 НЕ ПРОЙДЕН
2025-05-11 18:24:00,857 - server-audit - INFO - Выполнение команды для критерия 910 (9.1. Ensure SSH warning banner is configured): grep Banner /etc/ssh/sshd_config
2025-05-11 18:24:00,906 - server-audit - INFO - Результат выполнения команды для критерия 910:
2025-05-11 18:24:00,906 - server-audit - INFO - STDOUT: #Banner none

2025-05-11 18:24:00,906 - server-audit - INFO - Сравниваем с ожидаемым результатом: '/etc/issue.net'
2025-05-11 18:24:00,906 - server-audit - INFO - Критерий 910 НЕ ПРОЙДЕН
2025-05-11 18:24:00,906 - server-audit - INFO - Выполнение команды для критерия 1010 (10.1. Ensure permissions on /etc/passwd are configured): stat -c "%a %u %g" /etc/passwd
2025-05-11 18:24:00,955 - server-audit - INFO - Результат выполнения команды для критерия 1010:
2025-05-11 18:24:00,955 - server-audit - INFO - STDOUT: 644 0 0

2025-05-11 18:24:00,955 - server-audit - INFO - Сравниваем с ожидаемым результатом: '644 0 0'
2025-05-11 18:24:00,955 - server-audit - INFO - Критерий 1010 ПРОЙДЕН
2025-05-11 18:24:00,956 - server-audit - INFO - Выполнение команды для критерия 1110 (11.1. Ensure root PATH integrity): echo $PATH | grep -q "::" && echo "Empty Directory" || echo "1"
2025-05-11 18:24:01,005 - server-audit - INFO - Результат выполнения команды для критерия 1110:
2025-05-11 18:24:01,005 - server-audit - INFO - STDOUT: 1

2025-05-11 18:24:01,005 - server-audit - INFO - Сравниваем с ожидаемым результатом: '1'
2025-05-11 18:24:01,005 - server-audit - INFO - Критерий 1110 ПРОЙДЕН
2025-05-11 18:24:01,005 - server-audit - INFO - Выполнение команды для критерия 1210 (12.1. Ensure no users have .forward files): find /home -name .forward
2025-05-11 18:24:01,072 - server-audit - INFO - Результат выполнения команды для критерия 1210:
2025-05-11 18:24:01,073 - server-audit - INFO - STDOUT: 
2025-05-11 18:24:01,073 - server-audit - INFO - STDERR: find: ‘/home/aidar’: Permission denied

2025-05-11 18:24:01,073 - server-audit - INFO - Сравниваем с ожидаемым результатом: ''
2025-05-11 18:24:01,073 - server-audit - INFO - Критерий 1210 НЕ ПРОЙДЕН
2025-05-11 18:24:01,073 - server-audit - INFO - Сканирование сервера 25.15.212.99 завершено. Закрываем SSH-соединение.
2025-05-11 18:27:14,413 - server-audit - INFO - Попытка входа с именем пользователя: admin
2025-05-11 18:27:14,617 - server-audit - INFO - Успешный вход для пользователя: admin
2025-05-11 18:31:13,633 - server-audit - INFO - Попытка входа с именем пользователя: admin
2025-05-11 18:31:13,839 - server-audit - INFO - Успешный вход для пользователя: admin
2025-05-11 18:31:32,332 - server-audit - INFO - Начало сканирования сервера 25.15.212.99
2025-05-11 18:31:32,381 - server-audit - INFO - Подключение к серверу 25.15.212.99 по SSH с пользователем ayan
2025-05-11 18:31:32,381 - server-audit - INFO - Используется аутентификация по паролю
2025-05-11 18:31:32,386 - paramiko.transport - INFO - Connected (version 2.0, client OpenSSH_9.6p1)
2025-05-11 18:31:32,525 - paramiko.transport - INFO - Authentication (password) successful!
2025-05-11 18:31:32,525 - server-audit - INFO - Успешное подключение к 25.15.212.99. Начинаем выполнение проверок.
2025-05-11 18:31:32,525 - server-audit - INFO - Выполнение команды для критерия 110 (1.1. Ensure periodic security updates are configured): sudo dpkg -l | grep unattended-upgrades
2025-05-11 18:31:32,872 - server-audit - INFO - Результат выполнения команды для критерия 110:
2025-05-11 18:31:32,872 - server-audit - INFO - STDOUT: 
2025-05-11 18:31:32,872 - server-audit - INFO - STDERR: sudo: a terminal is required to read the password; either use the -S option to read from standard input or configure an askpass helper
sudo: a password is required

2025-05-11 18:31:32,872 - server-audit - INFO - Сравниваем с ожидаемым результатом: 'unattended-upgrades'
2025-05-11 18:31:32,872 - server-audit - INFO - Критерий 110 НЕ ПРОЙДЕН
2025-05-11 18:31:32,872 - server-audit - INFO - Выполнение команды для критерия 210 (2.1. Ensure /tmp is configured): sudo findmnt -n /tmp
2025-05-11 18:31:32,936 - server-audit - INFO - Результат выполнения команды для критерия 210:
2025-05-11 18:31:32,936 - server-audit - INFO - STDOUT: 
2025-05-11 18:31:32,938 - server-audit - INFO - STDERR: sudo: a terminal is required to read the password; either use the -S option to read from standard input or configure an askpass helper
sudo: a password is required

2025-05-11 18:31:32,938 - server-audit - INFO - Сравниваем с ожидаемым результатом: 'noexec'
2025-05-11 18:31:32,938 - server-audit - INFO - Критерий 210 НЕ ПРОЙДЕН
2025-05-11 18:31:32,938 - server-audit - INFO - Выполнение команды для критерия 310 (3.1. Ensure bootloader password is set): sudo grep "^password" /boot/grub/grub.cfg
2025-05-11 18:31:32,989 - server-audit - INFO - Результат выполнения команды для критерия 310:
2025-05-11 18:31:32,989 - server-audit - INFO - STDOUT: 
2025-05-11 18:31:32,989 - server-audit - INFO - STDERR: sudo: a terminal is required to read the password; either use the -S option to read from standard input or configure an askpass helper
sudo: a password is required

2025-05-11 18:31:32,989 - server-audit - INFO - Сравниваем с ожидаемым результатом: 'password'
2025-05-11 18:31:32,989 - server-audit - INFO - Критерий 310 НЕ ПРОЙДЕН
2025-05-11 18:31:32,989 - server-audit - INFO - Выполнение команды для критерия 409 (4.1. Ensure core dumps are restricted): sudo grep -E "^\s*\*\s+hard\s+core" /etc/security/limits.conf
2025-05-11 18:31:33,037 - server-audit - INFO - Результат выполнения команды для критерия 409:
2025-05-11 18:31:33,037 - server-audit - INFO - STDOUT: 
2025-05-11 18:31:33,037 - server-audit - INFO - STDERR: sudo: a terminal is required to read the password; either use the -S option to read from standard input or configure an askpass helper
sudo: a password is required

2025-05-11 18:31:33,037 - server-audit - INFO - Сравниваем с ожидаемым результатом: '* hard core 0'
2025-05-11 18:31:33,037 - server-audit - INFO - Критерий 409 НЕ ПРОЙДЕН
2025-05-11 18:31:33,037 - server-audit - INFO - Выполнение команды для критерия 509 (5.1. Ensure IP forwarding is disabled): sudo sysctl net.ipv4.ip_forward
2025-05-11 18:31:33,087 - server-audit - INFO - Результат выполнения команды для критерия 509:
2025-05-11 18:31:33,088 - server-audit - INFO - STDOUT: 
2025-05-11 18:31:33,088 - server-audit - INFO - STDERR: sudo: a terminal is required to read the password; either use the -S option to read from standard input or configure an askpass helper
sudo: a password is required

2025-05-11 18:31:33,088 - server-audit - INFO - Сравниваем с ожидаемым результатом: '0'
2025-05-11 18:31:33,088 - server-audit - INFO - Критерий 509 НЕ ПРОЙДЕН
2025-05-11 18:31:33,088 - server-audit - INFO - Выполнение команды для критерия 610 (6.1. Ensure wireless interfaces are disabled): sudo rfkill list
2025-05-11 18:31:33,144 - server-audit - INFO - Результат выполнения команды для критерия 610:
2025-05-11 18:31:33,144 - server-audit - INFO - STDOUT: 
2025-05-11 18:31:33,144 - server-audit - INFO - STDERR: sudo: a terminal is required to read the password; either use the -S option to read from standard input or configure an askpass helper
sudo: a password is required

2025-05-11 18:31:33,144 - server-audit - INFO - Сравниваем с ожидаемым результатом: 'Soft blocked: yes'
2025-05-11 18:31:33,144 - server-audit - INFO - Критерий 610 НЕ ПРОЙДЕН
2025-05-11 18:31:33,144 - server-audit - INFO - Выполнение команды для критерия 710 (7.1. Ensure audit is enabled): sudo systemctl is-active auditd
2025-05-11 18:31:33,195 - server-audit - INFO - Результат выполнения команды для критерия 710:
2025-05-11 18:31:33,196 - server-audit - INFO - STDOUT: 
2025-05-11 18:31:33,196 - server-audit - INFO - STDERR: sudo: a terminal is required to read the password; either use the -S option to read from standard input or configure an askpass helper
sudo: a password is required

2025-05-11 18:31:33,196 - server-audit - INFO - Сравниваем с ожидаемым результатом: 'active'
2025-05-11 18:31:33,196 - server-audit - INFO - Критерий 710 НЕ ПРОЙДЕН
2025-05-11 18:31:33,196 - server-audit - INFO - Выполнение команды для критерия 810 (8.1. Ensure password expiration is 90 days or less): sudo grep PASS_MAX_DAYS /etc/login.defs
2025-05-11 18:31:33,249 - server-audit - INFO - Результат выполнения команды для критерия 810:
2025-05-11 18:31:33,250 - server-audit - INFO - STDOUT: 
2025-05-11 18:31:33,250 - server-audit - INFO - STDERR: sudo: a terminal is required to read the password; either use the -S option to read from standard input or configure an askpass helper
sudo: a password is required

2025-05-11 18:31:33,250 - server-audit - INFO - Сравниваем с ожидаемым результатом: '90'
2025-05-11 18:31:33,250 - server-audit - INFO - Критерий 810 НЕ ПРОЙДЕН
2025-05-11 18:31:33,250 - server-audit - INFO - Выполнение команды для критерия 910 (9.1. Ensure SSH warning banner is configured): sudo grep Banner /etc/ssh/sshd_config
2025-05-11 18:31:33,304 - server-audit - INFO - Результат выполнения команды для критерия 910:
2025-05-11 18:31:33,305 - server-audit - INFO - STDOUT: 
2025-05-11 18:31:33,305 - server-audit - INFO - STDERR: sudo: a terminal is required to read the password; either use the -S option to read from standard input or configure an askpass helper
sudo: a password is required

2025-05-11 18:31:33,305 - server-audit - INFO - Сравниваем с ожидаемым результатом: '/etc/issue.net'
2025-05-11 18:31:33,305 - server-audit - INFO - Критерий 910 НЕ ПРОЙДЕН
2025-05-11 18:31:33,305 - server-audit - INFO - Выполнение команды для критерия 1010 (10.1. Ensure permissions on /etc/passwd are configured): sudo stat -c "%a %u %g" /etc/passwd
2025-05-11 18:31:33,362 - server-audit - INFO - Результат выполнения команды для критерия 1010:
2025-05-11 18:31:33,362 - server-audit - INFO - STDOUT: 
2025-05-11 18:31:33,362 - server-audit - INFO - STDERR: sudo: a terminal is required to read the password; either use the -S option to read from standard input or configure an askpass helper
sudo: a password is required

2025-05-11 18:31:33,362 - server-audit - INFO - Сравниваем с ожидаемым результатом: '644 0 0'
2025-05-11 18:31:33,362 - server-audit - INFO - Критерий 1010 НЕ ПРОЙДЕН
2025-05-11 18:31:33,362 - server-audit - INFO - Выполнение команды для критерия 1110 (11.1. Ensure root PATH integrity): sudo echo $PATH | grep -q "::" && echo "Empty Directory" || echo "1"
2025-05-11 18:31:33,419 - server-audit - INFO - Результат выполнения команды для критерия 1110:
2025-05-11 18:31:33,419 - server-audit - INFO - STDOUT: 1

2025-05-11 18:31:33,419 - server-audit - INFO - STDERR: sudo: a terminal is required to read the password; either use the -S option to read from standard input or configure an askpass helper
sudo: a password is required

2025-05-11 18:31:33,419 - server-audit - INFO - Сравниваем с ожидаемым результатом: '1'
2025-05-11 18:31:33,419 - server-audit - INFO - Критерий 1110 ПРОЙДЕН
2025-05-11 18:31:33,419 - server-audit - INFO - Выполнение команды для критерия 1210 (12.1. Ensure no users have .forward files): sudo find /home -name .forward
2025-05-11 18:31:33,474 - server-audit - INFO - Результат выполнения команды для критерия 1210:
2025-05-11 18:31:33,474 - server-audit - INFO - STDOUT: 
2025-05-11 18:31:33,474 - server-audit - INFO - STDERR: sudo: a terminal is required to read the password; either use the -S option to read from standard input or configure an askpass helper
sudo: a password is required

2025-05-11 18:31:33,474 - server-audit - INFO - Сравниваем с ожидаемым результатом: ''
2025-05-11 18:31:33,474 - server-audit - INFO - Критерий 1210 НЕ ПРОЙДЕН
2025-05-11 18:31:33,474 - server-audit - INFO - Сканирование сервера 25.15.212.99 завершено. Закрываем SSH-соединение.
2025-05-11 18:34:08,314 - server-audit - INFO - Попытка входа с именем пользователя: admin
2025-05-11 18:34:08,318 - passlib.handlers.bcrypt - WARNING - (trapped) error reading bcrypt version
Traceback (most recent call last):
  File "/usr/local/lib/python3.10/site-packages/passlib/handlers/bcrypt.py", line 620, in _load_backend_mixin
    version = _bcrypt.__about__.__version__
AttributeError: module 'bcrypt' has no attribute '__about__'
2025-05-11 18:34:08,543 - server-audit - INFO - Успешный вход для пользователя: admin
2025-05-11 18:34:18,403 - server-audit - INFO - Начало сканирования сервера 25.15.212.99
2025-05-11 18:34:18,415 - server-audit - INFO - Подключение к серверу 25.15.212.99 по SSH с пользователем ayan
2025-05-11 18:34:18,415 - server-audit - INFO - Используется аутентификация по паролю
2025-05-11 18:34:18,421 - paramiko.transport - INFO - Connected (version 2.0, client OpenSSH_9.6p1)
2025-05-11 18:34:18,521 - paramiko.transport - INFO - Authentication (password) successful!
2025-05-11 18:34:18,521 - server-audit - INFO - Успешное подключение к 25.15.212.99. Начинаем выполнение проверок.
2025-05-11 18:34:18,521 - server-audit - INFO - Выполнение команды для критерия 110 (1.1. Ensure periodic security updates are configured): sudo -n dpkg -l | grep unattended-upgrades
2025-05-11 18:34:18,846 - server-audit - INFO - Результат выполнения команды для критерия 110:
2025-05-11 18:34:18,846 - server-audit - INFO - STDOUT: 
2025-05-11 18:34:18,846 - server-audit - INFO - STDERR: sudo: a password is required

2025-05-11 18:34:18,846 - server-audit - INFO - Сравниваем с ожидаемым результатом: 'unattended-upgrades'
2025-05-11 18:34:18,846 - server-audit - INFO - Критерий 110 НЕ ПРОЙДЕН
2025-05-11 18:34:18,847 - server-audit - INFO - Выполнение команды для критерия 210 (2.1. Ensure /tmp is configured): sudo -n findmnt -n /tmp
2025-05-11 18:34:18,895 - server-audit - INFO - Результат выполнения команды для критерия 210:
2025-05-11 18:34:18,895 - server-audit - INFO - STDOUT: 
2025-05-11 18:34:18,896 - server-audit - INFO - STDERR: sudo: a password is required

2025-05-11 18:34:18,896 - server-audit - INFO - Сравниваем с ожидаемым результатом: 'noexec'
2025-05-11 18:34:18,896 - server-audit - INFO - Критерий 210 НЕ ПРОЙДЕН
2025-05-11 18:34:18,896 - server-audit - INFO - Выполнение команды для критерия 310 (3.1. Ensure bootloader password is set): sudo -n grep "^password" /boot/grub/grub.cfg
2025-05-11 18:34:18,953 - server-audit - INFO - Результат выполнения команды для критерия 310:
2025-05-11 18:34:18,953 - server-audit - INFO - STDOUT: 
2025-05-11 18:34:18,953 - server-audit - INFO - STDERR: sudo: a password is required

2025-05-11 18:34:18,953 - server-audit - INFO - Сравниваем с ожидаемым результатом: 'password'
2025-05-11 18:34:18,953 - server-audit - INFO - Критерий 310 НЕ ПРОЙДЕН
2025-05-11 18:34:18,953 - server-audit - INFO - Выполнение команды для критерия 409 (4.1. Ensure core dumps are restricted): sudo -n grep -E "^\s*\*\s+hard\s+core" /etc/security/limits.conf
2025-05-11 18:34:19,008 - server-audit - INFO - Результат выполнения команды для критерия 409:
2025-05-11 18:34:19,008 - server-audit - INFO - STDOUT: 
2025-05-11 18:34:19,008 - server-audit - INFO - STDERR: sudo: a password is required

2025-05-11 18:34:19,008 - server-audit - INFO - Сравниваем с ожидаемым результатом: '* hard core 0'
2025-05-11 18:34:19,008 - server-audit - INFO - Критерий 409 НЕ ПРОЙДЕН
2025-05-11 18:34:19,008 - server-audit - INFO - Выполнение команды для критерия 509 (5.1. Ensure IP forwarding is disabled): sudo -n sysctl net.ipv4.ip_forward
2025-05-11 18:34:19,063 - server-audit - INFO - Результат выполнения команды для критерия 509:
2025-05-11 18:34:19,063 - server-audit - INFO - STDOUT: 
2025-05-11 18:34:19,063 - server-audit - INFO - STDERR: sudo: a password is required

2025-05-11 18:34:19,063 - server-audit - INFO - Сравниваем с ожидаемым результатом: '0'
2025-05-11 18:34:19,063 - server-audit - INFO - Критерий 509 НЕ ПРОЙДЕН
2025-05-11 18:34:19,063 - server-audit - INFO - Выполнение команды для критерия 610 (6.1. Ensure wireless interfaces are disabled): sudo -n rfkill list
2025-05-11 18:34:19,119 - server-audit - INFO - Результат выполнения команды для критерия 610:
2025-05-11 18:34:19,119 - server-audit - INFO - STDOUT: 
2025-05-11 18:34:19,119 - server-audit - INFO - STDERR: sudo: a password is required

2025-05-11 18:34:19,119 - server-audit - INFO - Сравниваем с ожидаемым результатом: 'Soft blocked: yes'
2025-05-11 18:34:19,119 - server-audit - INFO - Критерий 610 НЕ ПРОЙДЕН
2025-05-11 18:34:19,119 - server-audit - INFO - Выполнение команды для критерия 710 (7.1. Ensure audit is enabled): sudo -n systemctl is-active auditd
2025-05-11 18:34:19,176 - server-audit - INFO - Результат выполнения команды для критерия 710:
2025-05-11 18:34:19,176 - server-audit - INFO - STDOUT: 
2025-05-11 18:34:19,176 - server-audit - INFO - STDERR: sudo: a password is required

2025-05-11 18:34:19,176 - server-audit - INFO - Сравниваем с ожидаемым результатом: 'active'
2025-05-11 18:34:19,177 - server-audit - INFO - Критерий 710 НЕ ПРОЙДЕН
2025-05-11 18:34:19,177 - server-audit - INFO - Выполнение команды для критерия 810 (8.1. Ensure password expiration is 90 days or less): sudo -n grep PASS_MAX_DAYS /etc/login.defs
2025-05-11 18:34:19,233 - server-audit - INFO - Результат выполнения команды для критерия 810:
2025-05-11 18:34:19,233 - server-audit - INFO - STDOUT: 
2025-05-11 18:34:19,233 - server-audit - INFO - STDERR: sudo: a password is required

2025-05-11 18:34:19,233 - server-audit - INFO - Сравниваем с ожидаемым результатом: '90'
2025-05-11 18:34:19,233 - server-audit - INFO - Критерий 810 НЕ ПРОЙДЕН
2025-05-11 18:34:19,233 - server-audit - INFO - Выполнение команды для критерия 910 (9.1. Ensure SSH warning banner is configured): sudo -n grep Banner /etc/ssh/sshd_config
2025-05-11 18:34:19,288 - server-audit - INFO - Результат выполнения команды для критерия 910:
2025-05-11 18:34:19,289 - server-audit - INFO - STDOUT: 
2025-05-11 18:34:19,289 - server-audit - INFO - STDERR: sudo: a password is required

2025-05-11 18:34:19,289 - server-audit - INFO - Сравниваем с ожидаемым результатом: '/etc/issue.net'
2025-05-11 18:34:19,289 - server-audit - INFO - Критерий 910 НЕ ПРОЙДЕН
2025-05-11 18:34:19,289 - server-audit - INFO - Выполнение команды для критерия 1010 (10.1. Ensure permissions on /etc/passwd are configured): sudo -n stat -c "%a %u %g" /etc/passwd
2025-05-11 18:34:19,345 - server-audit - INFO - Результат выполнения команды для критерия 1010:
2025-05-11 18:34:19,346 - server-audit - INFO - STDOUT: 
2025-05-11 18:34:19,346 - server-audit - INFO - STDERR: sudo: a password is required

2025-05-11 18:34:19,346 - server-audit - INFO - Сравниваем с ожидаемым результатом: '644 0 0'
2025-05-11 18:34:19,346 - server-audit - INFO - Критерий 1010 НЕ ПРОЙДЕН
2025-05-11 18:34:19,346 - server-audit - INFO - Выполнение команды для критерия 1110 (11.1. Ensure root PATH integrity): sudo -n echo $PATH | grep -q "::" && echo "Empty Directory" || echo "1"
2025-05-11 18:34:19,404 - server-audit - INFO - Результат выполнения команды для критерия 1110:
2025-05-11 18:34:19,404 - server-audit - INFO - STDOUT: 1

2025-05-11 18:34:19,404 - server-audit - INFO - STDERR: sudo: a password is required

2025-05-11 18:34:19,405 - server-audit - INFO - Сравниваем с ожидаемым результатом: '1'
2025-05-11 18:34:19,405 - server-audit - INFO - Критерий 1110 ПРОЙДЕН
2025-05-11 18:34:19,405 - server-audit - INFO - Выполнение команды для критерия 1210 (12.1. Ensure no users have .forward files): sudo -n find /home -name .forward
2025-05-11 18:34:19,460 - server-audit - INFO - Результат выполнения команды для критерия 1210:
2025-05-11 18:34:19,461 - server-audit - INFO - STDOUT: 
2025-05-11 18:34:19,461 - server-audit - INFO - STDERR: sudo: a password is required

2025-05-11 18:34:19,462 - server-audit - INFO - Сравниваем с ожидаемым результатом: ''
2025-05-11 18:34:19,462 - server-audit - INFO - Критерий 1210 НЕ ПРОЙДЕН
2025-05-11 18:34:19,462 - server-audit - INFO - Сканирование сервера 25.15.212.99 завершено. Закрываем SSH-соединение.
2025-05-11 18:34:46,190 - server-audit - INFO - Попытка входа с именем пользователя: admin
2025-05-11 18:34:46,398 - server-audit - INFO - Успешный вход для пользователя: admin
2025-05-11 18:34:54,293 - server-audit - INFO - Начало сканирования сервера 25.15.212.99
2025-05-11 18:34:54,314 - server-audit - INFO - Подключение к серверу 25.15.212.99 по SSH с пользователем root
2025-05-11 18:34:54,314 - server-audit - INFO - Используется аутентификация по паролю
2025-05-11 18:34:54,320 - paramiko.transport - INFO - Connected (version 2.0, client OpenSSH_9.6p1)
2025-05-11 18:34:58,722 - paramiko.transport - INFO - Authentication (password) failed.
2025-05-11 18:34:58,723 - server-audit - ERROR - Ошибка при сканировании: Authentication failed.
2025-05-11 18:34:58,737 - server-audit - ERROR - Ошибка при сканировании сервера 25.15.212.99: Authentication failed.
2025-05-11 18:38:26,130 - server-audit - INFO - Попытка входа с именем пользователя: admin
2025-05-11 18:38:26,134 - passlib.handlers.bcrypt - WARNING - (trapped) error reading bcrypt version
Traceback (most recent call last):
  File "/usr/local/lib/python3.10/site-packages/passlib/handlers/bcrypt.py", line 620, in _load_backend_mixin
    version = _bcrypt.__about__.__version__
AttributeError: module 'bcrypt' has no attribute '__about__'
2025-05-11 18:38:26,352 - server-audit - INFO - Успешный вход для пользователя: admin
2025-05-11 18:38:36,114 - server-audit - INFO - Начало сканирования сервера 25.15.212.99
2025-05-11 18:38:36,178 - server-audit - INFO - Подключение к серверу 25.15.212.99 по SSH с пользователем ayan
2025-05-11 18:38:36,178 - server-audit - INFO - Используется аутентификация по паролю
2025-05-11 18:38:36,184 - paramiko.transport - INFO - Connected (version 2.0, client OpenSSH_9.6p1)
2025-05-11 18:38:36,284 - paramiko.transport - INFO - Authentication (password) successful!
2025-05-11 18:38:36,285 - server-audit - INFO - Успешное подключение к 25.15.212.99. Начинаем выполнение проверок.
2025-05-11 18:38:36,285 - server-audit - INFO - Выполнение команды для критерия 110 (1.1. Ensure periodic security updates are configured): echo kali | sudo -S dpkg -l | grep unattended-upgrades
2025-05-11 18:38:36,650 - server-audit - INFO - Результат выполнения команды для критерия 110:
2025-05-11 18:38:36,650 - server-audit - INFO - STDOUT: ii  unattended-upgrades                  2.9.1+nmu4ubuntu1                       all          automatic installation of security upgrades

2025-05-11 18:38:36,650 - server-audit - INFO - STDERR: [sudo] password for ayan: 
2025-05-11 18:38:36,650 - server-audit - INFO - Сравниваем с ожидаемым результатом: 'unattended-upgrades'
2025-05-11 18:38:36,650 - server-audit - INFO - Критерий 110 ПРОЙДЕН
2025-05-11 18:38:36,650 - server-audit - INFO - Выполнение команды для критерия 210 (2.1. Ensure /tmp is configured): echo kali | sudo -S findmnt -n /tmp
2025-05-11 18:38:36,731 - server-audit - INFO - Результат выполнения команды для критерия 210:
2025-05-11 18:38:36,731 - server-audit - INFO - STDOUT: 
2025-05-11 18:38:36,731 - server-audit - INFO - STDERR: [sudo] password for ayan: 
2025-05-11 18:38:36,731 - server-audit - INFO - Сравниваем с ожидаемым результатом: 'noexec'
2025-05-11 18:38:36,732 - server-audit - INFO - Критерий 210 НЕ ПРОЙДЕН
2025-05-11 18:38:36,732 - server-audit - INFO - Выполнение команды для критерия 310 (3.1. Ensure bootloader password is set): echo kali | sudo -S grep "^password" /boot/grub/grub.cfg
2025-05-11 18:38:36,815 - server-audit - INFO - Результат выполнения команды для критерия 310:
2025-05-11 18:38:36,815 - server-audit - INFO - STDOUT: 
2025-05-11 18:38:36,815 - server-audit - INFO - STDERR: [sudo] password for ayan: 
2025-05-11 18:38:36,815 - server-audit - INFO - Сравниваем с ожидаемым результатом: 'password'
2025-05-11 18:38:36,815 - server-audit - INFO - Критерий 310 НЕ ПРОЙДЕН
2025-05-11 18:38:36,816 - server-audit - INFO - Выполнение команды для критерия 409 (4.1. Ensure core dumps are restricted): echo kali | sudo -S grep -E "^\s*\*\s+hard\s+core" /etc/security/limits.conf
2025-05-11 18:38:36,898 - server-audit - INFO - Результат выполнения команды для критерия 409:
2025-05-11 18:38:36,898 - server-audit - INFO - STDOUT: 
2025-05-11 18:38:36,898 - server-audit - INFO - STDERR: [sudo] password for ayan: 
2025-05-11 18:38:36,898 - server-audit - INFO - Сравниваем с ожидаемым результатом: '* hard core 0'
2025-05-11 18:38:36,898 - server-audit - INFO - Критерий 409 НЕ ПРОЙДЕН
2025-05-11 18:38:36,898 - server-audit - INFO - Выполнение команды для критерия 509 (5.1. Ensure IP forwarding is disabled): echo kali | sudo -S sysctl net.ipv4.ip_forward
2025-05-11 18:38:36,980 - server-audit - INFO - Результат выполнения команды для критерия 509:
2025-05-11 18:38:36,980 - server-audit - INFO - STDOUT: net.ipv4.ip_forward = 1

2025-05-11 18:38:36,980 - server-audit - INFO - STDERR: [sudo] password for ayan: 
2025-05-11 18:38:36,980 - server-audit - INFO - Сравниваем с ожидаемым результатом: '0'
2025-05-11 18:38:36,980 - server-audit - INFO - Критерий 509 НЕ ПРОЙДЕН
2025-05-11 18:38:36,980 - server-audit - INFO - Выполнение команды для критерия 610 (6.1. Ensure wireless interfaces are disabled): echo kali | sudo -S rfkill list
2025-05-11 18:38:37,060 - server-audit - ERROR - Ошибка sudo для критерия 610: [sudo] password for ayan: sudo: rfkill: command not found

2025-05-11 18:38:37,060 - server-audit - INFO - Выполнение команды для критерия 710 (7.1. Ensure audit is enabled): echo kali | sudo -S systemctl is-active auditd
2025-05-11 18:38:37,141 - server-audit - INFO - Результат выполнения команды для критерия 710:
2025-05-11 18:38:37,141 - server-audit - INFO - STDOUT: inactive

2025-05-11 18:38:37,141 - server-audit - INFO - STDERR: [sudo] password for ayan: 
2025-05-11 18:38:37,141 - server-audit - INFO - Сравниваем с ожидаемым результатом: 'active'
2025-05-11 18:38:37,141 - server-audit - INFO - Критерий 710 ПРОЙДЕН
2025-05-11 18:38:37,141 - server-audit - INFO - Выполнение команды для критерия 810 (8.1. Ensure password expiration is 90 days or less): echo kali | sudo -S grep PASS_MAX_DAYS /etc/login.defs
2025-05-11 18:38:37,221 - server-audit - INFO - Результат выполнения команды для критерия 810:
2025-05-11 18:38:37,221 - server-audit - INFO - STDOUT: #	PASS_MAX_DAYS	Maximum number of days a password may be used.
PASS_MAX_DAYS	99999

2025-05-11 18:38:37,221 - server-audit - INFO - STDERR: [sudo] password for ayan: 
2025-05-11 18:38:37,221 - server-audit - INFO - Сравниваем с ожидаемым результатом: '90'
2025-05-11 18:38:37,221 - server-audit - INFO - Критерий 810 НЕ ПРОЙДЕН
2025-05-11 18:38:37,221 - server-audit - INFO - Выполнение команды для критерия 910 (9.1. Ensure SSH warning banner is configured): echo kali | sudo -S grep Banner /etc/ssh/sshd_config
2025-05-11 18:38:37,300 - server-audit - INFO - Результат выполнения команды для критерия 910:
2025-05-11 18:38:37,300 - server-audit - INFO - STDOUT: #Banner none

2025-05-11 18:38:37,300 - server-audit - INFO - STDERR: [sudo] password for ayan: 
2025-05-11 18:38:37,300 - server-audit - INFO - Сравниваем с ожидаемым результатом: '/etc/issue.net'
2025-05-11 18:38:37,300 - server-audit - INFO - Критерий 910 НЕ ПРОЙДЕН
2025-05-11 18:38:37,300 - server-audit - INFO - Выполнение команды для критерия 1010 (10.1. Ensure permissions on /etc/passwd are configured): echo kali | sudo -S stat -c "%a %u %g" /etc/passwd
2025-05-11 18:38:37,380 - server-audit - INFO - Результат выполнения команды для критерия 1010:
2025-05-11 18:38:37,380 - server-audit - INFO - STDOUT: 644 0 0

2025-05-11 18:38:37,380 - server-audit - INFO - STDERR: [sudo] password for ayan: 
2025-05-11 18:38:37,381 - server-audit - INFO - Сравниваем с ожидаемым результатом: '644 0 0'
2025-05-11 18:38:37,381 - server-audit - INFO - Критерий 1010 ПРОЙДЕН
2025-05-11 18:38:37,381 - server-audit - INFO - Выполнение команды для критерия 1110 (11.1. Ensure root PATH integrity): echo kali | sudo -S echo $PATH | grep -q "::" && echo "Empty Directory" || echo "1"
2025-05-11 18:38:37,464 - server-audit - INFO - Результат выполнения команды для критерия 1110:
2025-05-11 18:38:37,464 - server-audit - INFO - STDOUT: 1

2025-05-11 18:38:37,464 - server-audit - INFO - STDERR: [sudo] password for ayan: 
2025-05-11 18:38:37,464 - server-audit - INFO - Сравниваем с ожидаемым результатом: '1'
2025-05-11 18:38:37,464 - server-audit - INFO - Критерий 1110 ПРОЙДЕН
2025-05-11 18:38:37,464 - server-audit - INFO - Выполнение команды для критерия 1210 (12.1. Ensure no users have .forward files): echo kali | sudo -S find /home -name .forward
2025-05-11 18:38:37,797 - server-audit - INFO - Результат выполнения команды для критерия 1210:
2025-05-11 18:38:37,797 - server-audit - INFO - STDOUT: 
2025-05-11 18:38:37,797 - server-audit - INFO - STDERR: [sudo] password for ayan: 
2025-05-11 18:38:37,797 - server-audit - INFO - Сравниваем с ожидаемым результатом: ''
2025-05-11 18:38:37,797 - server-audit - INFO - Критерий 1210 НЕ ПРОЙДЕН
2025-05-11 18:38:37,797 - server-audit - INFO - Сканирование сервера 25.15.212.99 завершено. Закрываем SSH-соединение.
2025-05-11 18:40:42,226 - server-audit - INFO - Попытка входа с именем пользователя: admin
2025-05-11 18:40:42,229 - passlib.handlers.bcrypt - WARNING - (trapped) error reading bcrypt version
Traceback (most recent call last):
  File "/usr/local/lib/python3.10/site-packages/passlib/handlers/bcrypt.py", line 620, in _load_backend_mixin
    version = _bcrypt.__about__.__version__
AttributeError: module 'bcrypt' has no attribute '__about__'
2025-05-11 18:40:42,448 - server-audit - INFO - Успешный вход для пользователя: admin
2025-05-11 18:40:51,039 - server-audit - INFO - Начало сканирования сервера 25.15.212.99
2025-05-11 18:40:51,118 - server-audit - INFO - Подключение к серверу 25.15.212.99 по SSH с пользователем ayan
2025-05-11 18:40:51,118 - server-audit - INFO - Используется аутентификация по паролю
2025-05-11 18:40:51,124 - paramiko.transport - INFO - Connected (version 2.0, client OpenSSH_9.6p1)
2025-05-11 18:40:51,223 - paramiko.transport - INFO - Authentication (password) successful!
2025-05-11 18:40:51,223 - server-audit - INFO - Успешное подключение к 25.15.212.99. Начинаем выполнение проверок.
2025-05-11 18:40:51,223 - server-audit - INFO - Проверка работоспособности sudo...
2025-05-11 18:40:51,540 - server-audit - INFO - Тест без sudo: test_sudo_access

2025-05-11 18:40:51,595 - server-audit - INFO - Тест с sudo -n: , ошибки: sudo: a password is required

2025-05-11 18:40:51,596 - server-audit - INFO - Sudo -n не работает, пробуем настроить временный sudo доступ
2025-05-11 18:40:51,674 - server-audit - INFO - Настройка временного sudo: [sudo] password for ayan: 
2025-05-11 18:40:51,674 - server-audit - INFO - Выполнение команды для критерия 110 (1.1. Ensure periodic security updates are configured): sudo -n dpkg -l | grep unattended-upgrades
2025-05-11 18:40:51,742 - server-audit - INFO - Результат выполнения команды для критерия 110:
2025-05-11 18:40:51,742 - server-audit - INFO - STDOUT: ii  unattended-upgrades                  2.9.1+nmu4ubuntu1                       all          automatic installation of security upgrades

2025-05-11 18:40:51,742 - server-audit - INFO - Сравниваем с ожидаемым результатом: 'unattended-upgrades'
2025-05-11 18:40:51,742 - server-audit - INFO - Критерий 110 ПРОЙДЕН
2025-05-11 18:40:51,742 - server-audit - INFO - Выполнение команды для критерия 210 (2.1. Ensure /tmp is configured): sudo -n findmnt -n /tmp
2025-05-11 18:40:51,801 - server-audit - INFO - Результат выполнения команды для критерия 210:
2025-05-11 18:40:51,801 - server-audit - INFO - STDOUT: 
2025-05-11 18:40:51,801 - server-audit - INFO - Сравниваем с ожидаемым результатом: 'noexec'
2025-05-11 18:40:51,801 - server-audit - INFO - Критерий 210 НЕ ПРОЙДЕН
2025-05-11 18:40:51,802 - server-audit - INFO - Выполнение команды для критерия 310 (3.1. Ensure bootloader password is set): sudo -n grep "^password" /boot/grub/grub.cfg
2025-05-11 18:40:51,856 - server-audit - INFO - Результат выполнения команды для критерия 310:
2025-05-11 18:40:51,857 - server-audit - INFO - STDOUT: 
2025-05-11 18:40:51,857 - server-audit - INFO - Сравниваем с ожидаемым результатом: 'password'
2025-05-11 18:40:51,857 - server-audit - INFO - Критерий 310 НЕ ПРОЙДЕН
2025-05-11 18:40:51,857 - server-audit - INFO - Выполнение команды для критерия 409 (4.1. Ensure core dumps are restricted): sudo -n grep -E "^\s*\*\s+hard\s+core" /etc/security/limits.conf
2025-05-11 18:40:51,912 - server-audit - INFO - Результат выполнения команды для критерия 409:
2025-05-11 18:40:51,912 - server-audit - INFO - STDOUT: 
2025-05-11 18:40:51,912 - server-audit - INFO - Сравниваем с ожидаемым результатом: '* hard core 0'
2025-05-11 18:40:51,912 - server-audit - INFO - Критерий 409 НЕ ПРОЙДЕН
2025-05-11 18:40:51,912 - server-audit - INFO - Выполнение команды для критерия 509 (5.1. Ensure IP forwarding is disabled): sudo -n sysctl net.ipv4.ip_forward
2025-05-11 18:40:51,967 - server-audit - INFO - Результат выполнения команды для критерия 509:
2025-05-11 18:40:51,967 - server-audit - INFO - STDOUT: net.ipv4.ip_forward = 1

2025-05-11 18:40:51,967 - server-audit - INFO - Сравниваем с ожидаемым результатом: '0'
2025-05-11 18:40:51,967 - server-audit - INFO - Критерий 509 НЕ ПРОЙДЕН
2025-05-11 18:40:51,967 - server-audit - INFO - Выполнение команды для критерия 610 (6.1. Ensure wireless interfaces are disabled): sudo -n rfkill list
2025-05-11 18:40:52,021 - server-audit - ERROR - Ошибка sudo для критерия 610: sudo: rfkill: command not found

2025-05-11 18:40:52,022 - server-audit - INFO - Выполнение команды для критерия 710 (7.1. Ensure audit is enabled): sudo -n systemctl is-active auditd
2025-05-11 18:40:52,082 - server-audit - INFO - Результат выполнения команды для критерия 710:
2025-05-11 18:40:52,082 - server-audit - INFO - STDOUT: inactive

2025-05-11 18:40:52,082 - server-audit - INFO - Сравниваем с ожидаемым результатом: 'active'
2025-05-11 18:40:52,082 - server-audit - INFO - Критерий 710 ПРОЙДЕН
2025-05-11 18:40:52,082 - server-audit - INFO - Выполнение команды для критерия 810 (8.1. Ensure password expiration is 90 days or less): sudo -n grep PASS_MAX_DAYS /etc/login.defs
2025-05-11 18:40:52,141 - server-audit - INFO - Результат выполнения команды для критерия 810:
2025-05-11 18:40:52,141 - server-audit - INFO - STDOUT: #	PASS_MAX_DAYS	Maximum number of days a password may be used.
PASS_MAX_DAYS	99999

2025-05-11 18:40:52,141 - server-audit - INFO - Сравниваем с ожидаемым результатом: '90'
2025-05-11 18:40:52,141 - server-audit - INFO - Критерий 810 НЕ ПРОЙДЕН
2025-05-11 18:40:52,141 - server-audit - INFO - Выполнение команды для критерия 910 (9.1. Ensure SSH warning banner is configured): sudo -n grep Banner /etc/ssh/sshd_config
2025-05-11 18:40:52,201 - server-audit - INFO - Результат выполнения команды для критерия 910:
2025-05-11 18:40:52,201 - server-audit - INFO - STDOUT: #Banner none

2025-05-11 18:40:52,201 - server-audit - INFO - Сравниваем с ожидаемым результатом: '/etc/issue.net'
2025-05-11 18:40:52,201 - server-audit - INFO - Критерий 910 НЕ ПРОЙДЕН
2025-05-11 18:40:52,201 - server-audit - INFO - Выполнение команды для критерия 1010 (10.1. Ensure permissions on /etc/passwd are configured): sudo -n stat -c "%a %u %g" /etc/passwd
2025-05-11 18:40:52,257 - server-audit - INFO - Результат выполнения команды для критерия 1010:
2025-05-11 18:40:52,257 - server-audit - INFO - STDOUT: 644 0 0

2025-05-11 18:40:52,257 - server-audit - INFO - Сравниваем с ожидаемым результатом: '644 0 0'
2025-05-11 18:40:52,257 - server-audit - INFO - Критерий 1010 ПРОЙДЕН
2025-05-11 18:40:52,257 - server-audit - INFO - Выполнение команды для критерия 1110 (11.1. Ensure root PATH integrity): sudo -n echo $PATH | grep -q "::" && echo "Empty Directory" || echo "1"
2025-05-11 18:40:52,315 - server-audit - INFO - Результат выполнения команды для критерия 1110:
2025-05-11 18:40:52,315 - server-audit - INFO - STDOUT: 1

2025-05-11 18:40:52,315 - server-audit - INFO - Сравниваем с ожидаемым результатом: '1'
2025-05-11 18:40:52,315 - server-audit - INFO - Критерий 1110 ПРОЙДЕН
2025-05-11 18:40:52,316 - server-audit - INFO - Выполнение команды для критерия 1210 (12.1. Ensure no users have .forward files): sudo -n find /home -name .forward
2025-05-11 18:40:52,430 - server-audit - INFO - Результат выполнения команды для критерия 1210:
2025-05-11 18:40:52,430 - server-audit - INFO - STDOUT: 
2025-05-11 18:40:52,430 - server-audit - INFO - Сравниваем с ожидаемым результатом: ''
2025-05-11 18:40:52,430 - server-audit - INFO - Критерий 1210 НЕ ПРОЙДЕН
2025-05-11 18:40:52,473 - server-audit - INFO - Временный файл sudoers удален
2025-05-11 18:40:52,473 - server-audit - INFO - Сканирование сервера 25.15.212.99 завершено. Закрываем SSH-соединение.
2025-05-11 18:43:11,383 - server-audit - INFO - Попытка входа с именем пользователя: admin
2025-05-11 18:43:11,387 - passlib.handlers.bcrypt - WARNING - (trapped) error reading bcrypt version
Traceback (most recent call last):
  File "/usr/local/lib/python3.10/site-packages/passlib/handlers/bcrypt.py", line 620, in _load_backend_mixin
    version = _bcrypt.__about__.__version__
AttributeError: module 'bcrypt' has no attribute '__about__'
2025-05-11 18:43:11,611 - server-audit - INFO - Успешный вход для пользователя: admin
2025-05-11 18:43:19,332 - server-audit - INFO - Начало сканирования сервера 25.15.212.99
2025-05-11 18:43:19,370 - server-audit - INFO - Подключение к серверу 25.15.212.99 по SSH с пользователем ayan
2025-05-11 18:43:19,370 - server-audit - INFO - Используется аутентификация по паролю
2025-05-11 18:43:19,376 - paramiko.transport - INFO - Connected (version 2.0, client OpenSSH_9.6p1)
2025-05-11 18:43:19,475 - paramiko.transport - INFO - Authentication (password) successful!
2025-05-11 18:43:19,475 - server-audit - INFO - Успешное подключение к 25.15.212.99. Начинаем выполнение проверок.
2025-05-11 18:43:19,475 - server-audit - INFO - Выполнение команды для критерия 110 (1.1. Ensure periodic security updates are configured): dpkg -l | grep unattended-upgrades
2025-05-11 18:43:19,858 - server-audit - INFO - Результат выполнения команды для критерия 110:
2025-05-11 18:43:19,858 - server-audit - INFO - STDOUT: === НАЧАЛО ВЫПОЛНЕНИЯ КОМАНДЫ ===
Команда: dpkg -l | grep unattended-upgrades
=== РЕЗУЛЬТАТ ВЫПОЛНЕНИЯ ===
ii  unattended-upgrades                  2.9.1+nmu4ubuntu1                       all          automatic installation of security upgrades
=== КОНЕЦ ВЫПОЛНЕНИЯ ===

2025-05-11 18:43:19,858 - server-audit - INFO - STDERR: sudo: a password is required

2025-05-11 18:43:19,859 - server-audit - INFO - Сравниваем с ожидаемым результатом: 'unattended-upgrades'
2025-05-11 18:43:19,859 - server-audit - INFO - Критерий 110 ПРОЙДЕН
2025-05-11 18:43:19,859 - server-audit - INFO - Выполнение команды для критерия 210 (2.1. Ensure /tmp is configured): findmnt -n /tmp
2025-05-11 18:43:19,969 - server-audit - INFO - Результат выполнения команды для критерия 210:
2025-05-11 18:43:19,969 - server-audit - INFO - STDOUT: === НАЧАЛО ВЫПОЛНЕНИЯ КОМАНДЫ ===
Команда: findmnt -n /tmp
=== РЕЗУЛЬТАТ ВЫПОЛНЕНИЯ ===
Команда завершилась с ошибкой: 1
=== КОНЕЦ ВЫПОЛНЕНИЯ ===

2025-05-11 18:43:19,969 - server-audit - INFO - STDERR: sudo: a password is required

2025-05-11 18:43:19,969 - server-audit - INFO - Сравниваем с ожидаемым результатом: 'noexec'
2025-05-11 18:43:19,970 - server-audit - INFO - Критерий 210 НЕ ПРОЙДЕН
2025-05-11 18:43:19,970 - server-audit - INFO - Выполнение команды для критерия 310 (3.1. Ensure bootloader password is set): grep "^password" /boot/grub/grub.cfg
2025-05-11 18:43:20,077 - server-audit - INFO - Результат выполнения команды для критерия 310:
2025-05-11 18:43:20,078 - server-audit - INFO - STDOUT: === НАЧАЛО ВЫПОЛНЕНИЯ КОМАНДЫ ===
Команда: grep ^password /boot/grub/grub.cfg
=== РЕЗУЛЬТАТ ВЫПОЛНЕНИЯ ===
grep: /boot/grub/grub.cfg: Permission denied
Команда завершилась с ошибкой: 2
=== КОНЕЦ ВЫПОЛНЕНИЯ ===

2025-05-11 18:43:20,078 - server-audit - INFO - STDERR: sudo: a password is required

2025-05-11 18:43:20,078 - server-audit - INFO - Сравниваем с ожидаемым результатом: 'password'
2025-05-11 18:43:20,078 - server-audit - INFO - Критерий 310 ПРОЙДЕН
2025-05-11 18:43:20,078 - server-audit - INFO - Выполнение команды для критерия 409 (4.1. Ensure core dumps are restricted): grep -E "^\s*\*\s+hard\s+core" /etc/security/limits.conf
2025-05-11 18:43:20,188 - server-audit - INFO - Результат выполнения команды для критерия 409:
2025-05-11 18:43:20,188 - server-audit - INFO - STDOUT: === НАЧАЛО ВЫПОЛНЕНИЯ КОМАНДЫ ===
Команда: grep -E ^s**s+hards+core /etc/security/limits.conf
=== РЕЗУЛЬТАТ ВЫПОЛНЕНИЯ ===
Команда завершилась с ошибкой: 1
=== КОНЕЦ ВЫПОЛНЕНИЯ ===

2025-05-11 18:43:20,188 - server-audit - INFO - STDERR: sudo: a password is required

2025-05-11 18:43:20,188 - server-audit - INFO - Сравниваем с ожидаемым результатом: '* hard core 0'
2025-05-11 18:43:20,188 - server-audit - INFO - Критерий 409 НЕ ПРОЙДЕН
2025-05-11 18:43:20,188 - server-audit - INFO - Выполнение команды для критерия 509 (5.1. Ensure IP forwarding is disabled): sysctl net.ipv4.ip_forward
2025-05-11 18:43:20,294 - server-audit - INFO - Результат выполнения команды для критерия 509:
2025-05-11 18:43:20,294 - server-audit - INFO - STDOUT: === НАЧАЛО ВЫПОЛНЕНИЯ КОМАНДЫ ===
Команда: sysctl net.ipv4.ip_forward
=== РЕЗУЛЬТАТ ВЫПОЛНЕНИЯ ===
net.ipv4.ip_forward = 1
=== КОНЕЦ ВЫПОЛНЕНИЯ ===

2025-05-11 18:43:20,294 - server-audit - INFO - STDERR: sudo: a password is required

2025-05-11 18:43:20,294 - server-audit - INFO - Сравниваем с ожидаемым результатом: '0'
2025-05-11 18:43:20,295 - server-audit - INFO - Критерий 509 НЕ ПРОЙДЕН
2025-05-11 18:43:20,295 - server-audit - INFO - Выполнение команды для критерия 610 (6.1. Ensure wireless interfaces are disabled): rfkill list
2025-05-11 18:43:20,400 - server-audit - INFO - Результат выполнения команды для критерия 610:
2025-05-11 18:43:20,400 - server-audit - INFO - STDOUT: === НАЧАЛО ВЫПОЛНЕНИЯ КОМАНДЫ ===
Команда: rfkill list
=== РЕЗУЛЬТАТ ВЫПОЛНЕНИЯ ===
/tmp/scan_cmd.sh: line 5: rfkill: command not found
Команда завершилась с ошибкой: 127
=== КОНЕЦ ВЫПОЛНЕНИЯ ===

2025-05-11 18:43:20,401 - server-audit - INFO - STDERR: sudo: a password is required

2025-05-11 18:43:20,401 - server-audit - INFO - Сравниваем с ожидаемым результатом: 'Soft blocked: yes'
2025-05-11 18:43:20,401 - server-audit - INFO - Критерий 610 НЕ ПРОЙДЕН
2025-05-11 18:43:20,401 - server-audit - INFO - Выполнение команды для критерия 710 (7.1. Ensure audit is enabled): systemctl is-active auditd
2025-05-11 18:43:20,507 - server-audit - INFO - Результат выполнения команды для критерия 710:
2025-05-11 18:43:20,508 - server-audit - INFO - STDOUT: === НАЧАЛО ВЫПОЛНЕНИЯ КОМАНДЫ ===
Команда: systemctl is-active auditd
=== РЕЗУЛЬТАТ ВЫПОЛНЕНИЯ ===
inactive
Команда завершилась с ошибкой: 4
=== КОНЕЦ ВЫПОЛНЕНИЯ ===

2025-05-11 18:43:20,508 - server-audit - INFO - STDERR: sudo: a password is required

2025-05-11 18:43:20,508 - server-audit - INFO - Сравниваем с ожидаемым результатом: 'active'
2025-05-11 18:43:20,508 - server-audit - INFO - Критерий 710 ПРОЙДЕН
2025-05-11 18:43:20,508 - server-audit - INFO - Выполнение команды для критерия 810 (8.1. Ensure password expiration is 90 days or less): grep PASS_MAX_DAYS /etc/login.defs
2025-05-11 18:43:20,608 - server-audit - INFO - Результат выполнения команды для критерия 810:
2025-05-11 18:43:20,608 - server-audit - INFO - STDOUT: === НАЧАЛО ВЫПОЛНЕНИЯ КОМАНДЫ ===
Команда: grep PASS_MAX_DAYS /etc/login.defs
=== РЕЗУЛЬТАТ ВЫПОЛНЕНИЯ ===
#	PASS_MAX_DAYS	Maximum number of days a password may be used.
PASS_MAX_DAYS	99999
=== КОНЕЦ ВЫПОЛНЕНИЯ ===

2025-05-11 18:43:20,608 - server-audit - INFO - STDERR: sudo: a password is required

2025-05-11 18:43:20,608 - server-audit - INFO - Сравниваем с ожидаемым результатом: '90'
2025-05-11 18:43:20,608 - server-audit - INFO - Критерий 810 НЕ ПРОЙДЕН
2025-05-11 18:43:20,608 - server-audit - INFO - Выполнение команды для критерия 910 (9.1. Ensure SSH warning banner is configured): grep Banner /etc/ssh/sshd_config
2025-05-11 18:43:20,715 - server-audit - INFO - Результат выполнения команды для критерия 910:
2025-05-11 18:43:20,715 - server-audit - INFO - STDOUT: === НАЧАЛО ВЫПОЛНЕНИЯ КОМАНДЫ ===
Команда: grep Banner /etc/ssh/sshd_config
=== РЕЗУЛЬТАТ ВЫПОЛНЕНИЯ ===
#Banner none
=== КОНЕЦ ВЫПОЛНЕНИЯ ===

2025-05-11 18:43:20,716 - server-audit - INFO - STDERR: sudo: a password is required

2025-05-11 18:43:20,716 - server-audit - INFO - Сравниваем с ожидаемым результатом: '/etc/issue.net'
2025-05-11 18:43:20,716 - server-audit - INFO - Критерий 910 НЕ ПРОЙДЕН
2025-05-11 18:43:20,716 - server-audit - INFO - Выполнение команды для критерия 1010 (10.1. Ensure permissions on /etc/passwd are configured): stat -c "%a %u %g" /etc/passwd
2025-05-11 18:43:20,827 - server-audit - INFO - Результат выполнения команды для критерия 1010:
2025-05-11 18:43:20,827 - server-audit - INFO - STDOUT: === НАЧАЛО ВЫПОЛНЕНИЯ КОМАНДЫ ===
Команда: stat -c %a %u %g /etc/passwd
=== РЕЗУЛЬТАТ ВЫПОЛНЕНИЯ ===
644 0 0
=== КОНЕЦ ВЫПОЛНЕНИЯ ===

2025-05-11 18:43:20,827 - server-audit - INFO - STDERR: sudo: a password is required

2025-05-11 18:43:20,828 - server-audit - INFO - Сравниваем с ожидаемым результатом: '644 0 0'
2025-05-11 18:43:20,828 - server-audit - INFO - Критерий 1010 ПРОЙДЕН
2025-05-11 18:43:20,828 - server-audit - INFO - Выполнение команды для критерия 1110 (11.1. Ensure root PATH integrity): echo $PATH | grep -q "::" && echo "Empty Directory" || echo "1"
2025-05-11 18:43:20,936 - server-audit - INFO - Результат выполнения команды для критерия 1110:
2025-05-11 18:43:20,937 - server-audit - INFO - STDOUT: === НАЧАЛО ВЫПОЛНЕНИЯ КОМАНДЫ ===
Команда: echo /usr/local/sbin:/usr/local/bin:/usr/sbin:/usr/bin:/sbin:/bin:/usr/games:/usr/local/games:/snap/bin | grep -q :: && echo Empty Directory || echo 1
=== РЕЗУЛЬТАТ ВЫПОЛНЕНИЯ ===
1
=== КОНЕЦ ВЫПОЛНЕНИЯ ===

2025-05-11 18:43:20,937 - server-audit - INFO - STDERR: sudo: a password is required

2025-05-11 18:43:20,937 - server-audit - INFO - Сравниваем с ожидаемым результатом: '1'
2025-05-11 18:43:20,937 - server-audit - INFO - Критерий 1110 ПРОЙДЕН
2025-05-11 18:43:20,937 - server-audit - INFO - Выполнение команды для критерия 1210 (12.1. Ensure no users have .forward files): find /home -name .forward
2025-05-11 18:43:21,059 - server-audit - INFO - Результат выполнения команды для критерия 1210:
2025-05-11 18:43:21,059 - server-audit - INFO - STDOUT: === НАЧАЛО ВЫПОЛНЕНИЯ КОМАНДЫ ===
Команда: find /home -name .forward
=== РЕЗУЛЬТАТ ВЫПОЛНЕНИЯ ===
find: ‘/home/aidar’: Permission denied
Команда завершилась с ошибкой: 1
=== КОНЕЦ ВЫПОЛНЕНИЯ ===

2025-05-11 18:43:21,060 - server-audit - INFO - STDERR: sudo: a password is required

2025-05-11 18:43:21,060 - server-audit - INFO - Сравниваем с ожидаемым результатом: ''
2025-05-11 18:43:21,060 - server-audit - INFO - Критерий 1210 НЕ ПРОЙДЕН
2025-05-11 18:43:21,060 - server-audit - INFO - Сканирование сервера 25.15.212.99 завершено. Закрываем SSH-соединение.
2025-05-11 18:45:13,335 - server-audit - INFO - Попытка входа с именем пользователя: admin
2025-05-11 18:45:13,339 - passlib.handlers.bcrypt - WARNING - (trapped) error reading bcrypt version
Traceback (most recent call last):
  File "/usr/local/lib/python3.10/site-packages/passlib/handlers/bcrypt.py", line 620, in _load_backend_mixin
    version = _bcrypt.__about__.__version__
AttributeError: module 'bcrypt' has no attribute '__about__'
2025-05-11 18:45:13,560 - server-audit - INFO - Успешный вход для пользователя: admin
2025-05-11 18:45:21,154 - server-audit - INFO - Начало сканирования сервера 25.15.212.99
2025-05-11 18:45:21,175 - server-audit - INFO - Подключение к серверу 25.15.212.99 по SSH с пользователем ayan
2025-05-11 18:45:21,175 - server-audit - INFO - Используется аутентификация по паролю
2025-05-11 18:45:21,181 - paramiko.transport - INFO - Connected (version 2.0, client OpenSSH_9.6p1)
2025-05-11 18:45:21,281 - paramiko.transport - INFO - Authentication (password) successful!
2025-05-11 18:45:21,282 - server-audit - INFO - Успешное подключение к 25.15.212.99. Начинаем выполнение проверок.
2025-05-11 18:45:21,282 - server-audit - INFO - Выполнение команды для критерия 110 (1.1. Ensure periodic security updates are configured): dpkg -l | grep unattended-upgrades
2025-05-11 18:45:21,656 - server-audit - INFO - Результат выполнения команды для критерия 110:
2025-05-11 18:45:21,656 - server-audit - INFO - STDOUT: === НАЧАЛО ВЫПОЛНЕНИЯ КОМАНДЫ ===
Команда: dpkg -l | grep unattended-upgrades
=== РЕЗУЛЬТАТ ВЫПОЛНЕНИЯ ===
ii  unattended-upgrades                  2.9.1+nmu4ubuntu1                       all          automatic installation of security upgrades
=== КОНЕЦ ВЫПОЛНЕНИЯ ===

2025-05-11 18:45:21,656 - server-audit - INFO - STDERR: sudo: a password is required

2025-05-11 18:45:21,656 - server-audit - INFO - Сравниваем с ожидаемым результатом: 'unattended-upgrades'
2025-05-11 18:45:21,657 - server-audit - INFO - Критерий 110 ПРОЙДЕН
2025-05-11 18:45:21,657 - server-audit - INFO - Выполнение команды для критерия 210 (2.1. Ensure /tmp is configured): findmnt -n /tmp
2025-05-11 18:45:21,764 - server-audit - INFO - Результат выполнения команды для критерия 210:
2025-05-11 18:45:21,764 - server-audit - INFO - STDOUT: === НАЧАЛО ВЫПОЛНЕНИЯ КОМАНДЫ ===
Команда: findmnt -n /tmp
=== РЕЗУЛЬТАТ ВЫПОЛНЕНИЯ ===
Команда завершилась с ошибкой: 1
=== КОНЕЦ ВЫПОЛНЕНИЯ ===

2025-05-11 18:45:21,764 - server-audit - INFO - STDERR: sudo: a password is required

2025-05-11 18:45:21,765 - server-audit - INFO - Сравниваем с ожидаемым результатом: 'noexec'
2025-05-11 18:45:21,765 - server-audit - INFO - Критерий 210 НЕ ПРОЙДЕН
2025-05-11 18:45:21,765 - server-audit - INFO - Выполнение команды для критерия 310 (3.1. Ensure bootloader password is set): grep "^password" /boot/grub/grub.cfg
2025-05-11 18:45:21,872 - server-audit - INFO - Результат выполнения команды для критерия 310:
2025-05-11 18:45:21,873 - server-audit - INFO - STDOUT: === НАЧАЛО ВЫПОЛНЕНИЯ КОМАНДЫ ===
Команда: grep ^password /boot/grub/grub.cfg
=== РЕЗУЛЬТАТ ВЫПОЛНЕНИЯ ===
grep: /boot/grub/grub.cfg: Permission denied
Команда завершилась с ошибкой: 2
=== КОНЕЦ ВЫПОЛНЕНИЯ ===

2025-05-11 18:45:21,873 - server-audit - INFO - STDERR: sudo: a password is required

2025-05-11 18:45:21,873 - server-audit - INFO - Сравниваем с ожидаемым результатом: 'password'
2025-05-11 18:45:21,873 - server-audit - INFO - Критерий 310 ПРОЙДЕН
2025-05-11 18:45:21,873 - server-audit - INFO - Выполнение команды для критерия 409 (4.1. Ensure core dumps are restricted): grep -E '^\s*\*\s+hard\s+core' /etc/security/limits.conf
2025-05-11 18:45:21,979 - server-audit - INFO - Результат выполнения команды для критерия 409:
2025-05-11 18:45:21,979 - server-audit - INFO - STDOUT: === НАЧАЛО ВЫПОЛНЕНИЯ КОМАНДЫ ===
Команда: grep -E '^\s*\*\s+hard\s+core' /etc/security/limits.conf
=== РЕЗУЛЬТАТ ВЫПОЛНЕНИЯ ===
Команда завершилась с ошибкой: 1
=== КОНЕЦ ВЫПОЛНЕНИЯ ===

2025-05-11 18:45:21,979 - server-audit - INFO - STDERR: sudo: a password is required

2025-05-11 18:45:21,980 - server-audit - INFO - Сравниваем с ожидаемым результатом: '* hard core 0'
2025-05-11 18:45:21,980 - server-audit - INFO - Критерий 409 НЕ ПРОЙДЕН
2025-05-11 18:45:21,980 - server-audit - INFO - Выполнение команды для критерия 509 (5.1. Ensure IP forwarding is disabled): sysctl net.ipv4.ip_forward
2025-05-11 18:45:22,088 - server-audit - INFO - Результат выполнения команды для критерия 509:
2025-05-11 18:45:22,088 - server-audit - INFO - STDOUT: === НАЧАЛО ВЫПОЛНЕНИЯ КОМАНДЫ ===
Команда: sysctl net.ipv4.ip_forward
=== РЕЗУЛЬТАТ ВЫПОЛНЕНИЯ ===
net.ipv4.ip_forward = 1
=== КОНЕЦ ВЫПОЛНЕНИЯ ===

2025-05-11 18:45:22,088 - server-audit - INFO - STDERR: sudo: a password is required

2025-05-11 18:45:22,089 - server-audit - INFO - Сравниваем с ожидаемым результатом: '0'
2025-05-11 18:45:22,089 - server-audit - INFO - Критерий 509 НЕ ПРОЙДЕН
2025-05-11 18:45:22,089 - server-audit - INFO - Выполнение команды для критерия 610 (6.1. Ensure wireless interfaces are disabled): rfkill list
2025-05-11 18:45:22,194 - server-audit - INFO - Результат выполнения команды для критерия 610:
2025-05-11 18:45:22,194 - server-audit - INFO - STDOUT: === НАЧАЛО ВЫПОЛНЕНИЯ КОМАНДЫ ===
Команда: rfkill list
=== РЕЗУЛЬТАТ ВЫПОЛНЕНИЯ ===
/tmp/scan_cmd.sh: line 5: rfkill: command not found
Команда завершилась с ошибкой: 127
=== КОНЕЦ ВЫПОЛНЕНИЯ ===

2025-05-11 18:45:22,194 - server-audit - INFO - STDERR: sudo: a password is required

2025-05-11 18:45:22,194 - server-audit - INFO - Сравниваем с ожидаемым результатом: 'Soft blocked: yes'
2025-05-11 18:45:22,194 - server-audit - INFO - Критерий 610 НЕ ПРОЙДЕН
2025-05-11 18:45:22,194 - server-audit - INFO - Выполнение команды для критерия 710 (7.1. Ensure audit is enabled): systemctl is-active auditd
2025-05-11 18:45:22,304 - server-audit - INFO - Результат выполнения команды для критерия 710:
2025-05-11 18:45:22,304 - server-audit - INFO - STDOUT: === НАЧАЛО ВЫПОЛНЕНИЯ КОМАНДЫ ===
Команда: systemctl is-active auditd
=== РЕЗУЛЬТАТ ВЫПОЛНЕНИЯ ===
inactive
Команда завершилась с ошибкой: 4
=== КОНЕЦ ВЫПОЛНЕНИЯ ===

2025-05-11 18:45:22,304 - server-audit - INFO - STDERR: sudo: a password is required

2025-05-11 18:45:22,304 - server-audit - INFO - Сравниваем с ожидаемым результатом: 'active'
2025-05-11 18:45:22,305 - server-audit - INFO - Критерий 710 ПРОЙДЕН
2025-05-11 18:45:22,305 - server-audit - INFO - Выполнение команды для критерия 810 (8.1. Ensure password expiration is 90 days or less): grep PASS_MAX_DAYS /etc/login.defs
2025-05-11 18:45:22,400 - server-audit - INFO - Результат выполнения команды для критерия 810:
2025-05-11 18:45:22,400 - server-audit - INFO - STDOUT: === НАЧАЛО ВЫПОЛНЕНИЯ КОМАНДЫ ===
Команда: grep PASS_MAX_DAYS /etc/login.defs
=== РЕЗУЛЬТАТ ВЫПОЛНЕНИЯ ===
#	PASS_MAX_DAYS	Maximum number of days a password may be used.
PASS_MAX_DAYS	99999
=== КОНЕЦ ВЫПОЛНЕНИЯ ===

2025-05-11 18:45:22,400 - server-audit - INFO - STDERR: sudo: a password is required

2025-05-11 18:45:22,400 - server-audit - INFO - Сравниваем с ожидаемым результатом: '90'
2025-05-11 18:45:22,400 - server-audit - INFO - Критерий 810 НЕ ПРОЙДЕН
2025-05-11 18:45:22,400 - server-audit - INFO - Выполнение команды для критерия 910 (9.1. Ensure SSH warning banner is configured): grep Banner /etc/ssh/sshd_config
2025-05-11 18:45:22,505 - server-audit - INFO - Результат выполнения команды для критерия 910:
2025-05-11 18:45:22,506 - server-audit - INFO - STDOUT: === НАЧАЛО ВЫПОЛНЕНИЯ КОМАНДЫ ===
Команда: grep Banner /etc/ssh/sshd_config
=== РЕЗУЛЬТАТ ВЫПОЛНЕНИЯ ===
#Banner none
=== КОНЕЦ ВЫПОЛНЕНИЯ ===

2025-05-11 18:45:22,506 - server-audit - INFO - STDERR: sudo: a password is required

2025-05-11 18:45:22,506 - server-audit - INFO - Сравниваем с ожидаемым результатом: '/etc/issue.net'
2025-05-11 18:45:22,506 - server-audit - INFO - Критерий 910 НЕ ПРОЙДЕН
2025-05-11 18:45:22,506 - server-audit - INFO - Выполнение команды для критерия 1010 (10.1. Ensure permissions on /etc/passwd are configured): stat -c "%a %u %g" /etc/passwd
2025-05-11 18:45:22,616 - server-audit - INFO - Результат выполнения команды для критерия 1010:
2025-05-11 18:45:22,616 - server-audit - INFO - STDOUT: === НАЧАЛО ВЫПОЛНЕНИЯ КОМАНДЫ ===
Команда: stat -c %a %u %g /etc/passwd
=== РЕЗУЛЬТАТ ВЫПОЛНЕНИЯ ===
644 0 0
=== КОНЕЦ ВЫПОЛНЕНИЯ ===

2025-05-11 18:45:22,616 - server-audit - INFO - STDERR: sudo: a password is required

2025-05-11 18:45:22,616 - server-audit - INFO - Сравниваем с ожидаемым результатом: '644 0 0'
2025-05-11 18:45:22,616 - server-audit - INFO - Критерий 1010 ПРОЙДЕН
2025-05-11 18:45:22,616 - server-audit - INFO - Выполнение команды для критерия 1110 (11.1. Ensure root PATH integrity): echo $PATH | grep -q "::" && echo "Empty Directory" || echo "1"
2025-05-11 18:45:22,722 - server-audit - INFO - Результат выполнения команды для критерия 1110:
2025-05-11 18:45:22,723 - server-audit - INFO - STDOUT: === НАЧАЛО ВЫПОЛНЕНИЯ КОМАНДЫ ===
Команда: echo /usr/local/sbin:/usr/local/bin:/usr/sbin:/usr/bin:/sbin:/bin:/usr/games:/usr/local/games:/snap/bin | grep -q :: && echo Empty Directory || echo 1
=== РЕЗУЛЬТАТ ВЫПОЛНЕНИЯ ===
1
=== КОНЕЦ ВЫПОЛНЕНИЯ ===

2025-05-11 18:45:22,724 - server-audit - INFO - STDERR: sudo: a password is required

2025-05-11 18:45:22,724 - server-audit - INFO - Сравниваем с ожидаемым результатом: '1'
2025-05-11 18:45:22,724 - server-audit - INFO - Критерий 1110 ПРОЙДЕН
2025-05-11 18:45:22,724 - server-audit - INFO - Выполнение команды для критерия 1210 (12.1. Ensure no users have .forward files): find /home -name .forward
2025-05-11 18:45:22,843 - server-audit - INFO - Результат выполнения команды для критерия 1210:
2025-05-11 18:45:22,843 - server-audit - INFO - STDOUT: === НАЧАЛО ВЫПОЛНЕНИЯ КОМАНДЫ ===
Команда: find /home -name .forward
=== РЕЗУЛЬТАТ ВЫПОЛНЕНИЯ ===
find: ‘/home/aidar’: Permission denied
Команда завершилась с ошибкой: 1
=== КОНЕЦ ВЫПОЛНЕНИЯ ===

2025-05-11 18:45:22,844 - server-audit - INFO - STDERR: sudo: a password is required

2025-05-11 18:45:22,844 - server-audit - INFO - Сравниваем с ожидаемым результатом: ''
2025-05-11 18:45:22,844 - server-audit - INFO - Критерий 1210 НЕ ПРОЙДЕН
2025-05-11 18:45:22,844 - server-audit - INFO - Сканирование сервера 25.15.212.99 завершено. Закрываем SSH-соединение.
2025-05-11 18:47:38,930 - server-audit - INFO - Начало сканирования сервера 25.15.212.99
2025-05-11 18:47:38,947 - server-audit - INFO - Подключение к серверу 25.15.212.99 по SSH с пользователем root
2025-05-11 18:47:38,947 - server-audit - INFO - Используется аутентификация по паролю
2025-05-11 18:47:38,952 - paramiko.transport - INFO - Connected (version 2.0, client OpenSSH_9.6p1)
2025-05-11 18:47:41,179 - paramiko.transport - INFO - Authentication (password) failed.
2025-05-11 18:47:41,180 - server-audit - ERROR - Ошибка при сканировании: Authentication failed.
2025-05-11 18:47:41,231 - server-audit - ERROR - Ошибка при сканировании сервера 25.15.212.99: Authentication failed.
2025-05-11 18:49:43,046 - server-audit - INFO - Попытка входа с именем пользователя: admin
2025-05-11 18:49:43,251 - server-audit - INFO - Успешный вход для пользователя: admin
2025-05-11 18:49:50,400 - server-audit - INFO - Начало сканирования сервера 25.15.212.99
2025-05-11 18:49:50,418 - server-audit - INFO - Подключение к серверу 25.15.212.99 по SSH с пользователем root
2025-05-11 18:49:50,418 - server-audit - INFO - Используется аутентификация по паролю
2025-05-11 18:49:50,423 - paramiko.transport - INFO - Connected (version 2.0, client OpenSSH_9.6p1)
2025-05-11 18:49:52,716 - paramiko.transport - INFO - Authentication (password) failed.
2025-05-11 18:49:52,716 - server-audit - ERROR - Ошибка при сканировании: Authentication failed.
2025-05-11 18:49:52,779 - server-audit - ERROR - Ошибка при сканировании сервера 25.15.212.99: Authentication failed.
2025-05-11 18:57:22,820 - server-audit - INFO - Начало сканирования сервера 25.15.212.99
2025-05-11 18:57:22,905 - server-audit - INFO - Подключение к серверу 25.15.212.99 по SSH с пользователем ayan
2025-05-11 18:57:22,906 - server-audit - INFO - Используется аутентификация по паролю
2025-05-11 18:57:22,912 - paramiko.transport - INFO - Connected (version 2.0, client OpenSSH_9.6p1)
2025-05-11 18:57:22,994 - paramiko.transport - INFO - Authentication (password) successful!
2025-05-11 18:57:22,995 - server-audit - INFO - Успешное подключение к 25.15.212.99. Начинаем выполнение проверок.
2025-05-11 18:57:22,995 - server-audit - INFO - Выполнение команды для критерия 110 (1.1. Ensure periodic security updates are configured): dpkg -l | grep unattended-upgrades
2025-05-11 18:57:23,370 - server-audit - INFO - Результат выполнения команды для критерия 110:
2025-05-11 18:57:23,370 - server-audit - INFO - STDOUT: === НАЧАЛО ВЫПОЛНЕНИЯ КОМАНДЫ ===
Команда: dpkg -l | grep unattended-upgrades
=== РЕЗУЛЬТАТ ВЫПОЛНЕНИЯ ===
ii  unattended-upgrades                  2.9.1+nmu4ubuntu1                       all          automatic installation of security upgrades
=== КОНЕЦ ВЫПОЛНЕНИЯ ===

2025-05-11 18:57:23,370 - server-audit - INFO - STDERR: sudo: a password is required

2025-05-11 18:57:23,370 - server-audit - INFO - Сравниваем с ожидаемым результатом: 'unattended-upgrades'
2025-05-11 18:57:23,370 - server-audit - INFO - Критерий 110 ПРОЙДЕН
2025-05-11 18:57:23,370 - server-audit - INFO - Выполнение команды для критерия 210 (2.1. Ensure /tmp is configured): findmnt -n /tmp
2025-05-11 18:57:23,478 - server-audit - INFO - Результат выполнения команды для критерия 210:
2025-05-11 18:57:23,479 - server-audit - INFO - STDOUT: === НАЧАЛО ВЫПОЛНЕНИЯ КОМАНДЫ ===
Команда: findmnt -n /tmp
=== РЕЗУЛЬТАТ ВЫПОЛНЕНИЯ ===
Команда завершилась с ошибкой: 1
=== КОНЕЦ ВЫПОЛНЕНИЯ ===

2025-05-11 18:57:23,479 - server-audit - INFO - STDERR: sudo: a password is required

2025-05-11 18:57:23,480 - server-audit - INFO - Сравниваем с ожидаемым результатом: 'noexec'
2025-05-11 18:57:23,480 - server-audit - INFO - Критерий 210 НЕ ПРОЙДЕН
2025-05-11 18:57:23,480 - server-audit - INFO - Выполнение команды для критерия 310 (3.1. Ensure bootloader password is set): grep "^password" /boot/grub/grub.cfg
2025-05-11 18:57:23,587 - server-audit - INFO - Результат выполнения команды для критерия 310:
2025-05-11 18:57:23,588 - server-audit - INFO - STDOUT: === НАЧАЛО ВЫПОЛНЕНИЯ КОМАНДЫ ===
Команда: grep ^password /boot/grub/grub.cfg
=== РЕЗУЛЬТАТ ВЫПОЛНЕНИЯ ===
grep: /boot/grub/grub.cfg: Permission denied
Команда завершилась с ошибкой: 2
=== КОНЕЦ ВЫПОЛНЕНИЯ ===

2025-05-11 18:57:23,588 - server-audit - INFO - STDERR: sudo: a password is required

2025-05-11 18:57:23,588 - server-audit - INFO - Сравниваем с ожидаемым результатом: 'password'
2025-05-11 18:57:23,588 - server-audit - INFO - Критерий 310 ПРОЙДЕН
2025-05-11 18:57:23,588 - server-audit - INFO - Выполнение команды для критерия 409 (4.1. Ensure core dumps are restricted): grep -E '^\s*\*\s+hard\s+core' /etc/security/limits.conf
2025-05-11 18:57:23,697 - server-audit - INFO - Результат выполнения команды для критерия 409:
2025-05-11 18:57:23,698 - server-audit - INFO - STDOUT: === НАЧАЛО ВЫПОЛНЕНИЯ КОМАНДЫ ===
Команда: grep -E '^\s*\*\s+hard\s+core' /etc/security/limits.conf
=== РЕЗУЛЬТАТ ВЫПОЛНЕНИЯ ===
Команда завершилась с ошибкой: 1
=== КОНЕЦ ВЫПОЛНЕНИЯ ===

2025-05-11 18:57:23,698 - server-audit - INFO - STDERR: sudo: a password is required

2025-05-11 18:57:23,698 - server-audit - INFO - Сравниваем с ожидаемым результатом: '* hard core 0'
2025-05-11 18:57:23,698 - server-audit - INFO - Критерий 409 НЕ ПРОЙДЕН
2025-05-11 18:57:23,698 - server-audit - INFO - Выполнение команды для критерия 509 (5.1. Ensure IP forwarding is disabled): sysctl net.ipv4.ip_forward
2025-05-11 18:57:23,808 - server-audit - INFO - Результат выполнения команды для критерия 509:
2025-05-11 18:57:23,809 - server-audit - INFO - STDOUT: === НАЧАЛО ВЫПОЛНЕНИЯ КОМАНДЫ ===
Команда: sysctl net.ipv4.ip_forward
=== РЕЗУЛЬТАТ ВЫПОЛНЕНИЯ ===
net.ipv4.ip_forward = 1
=== КОНЕЦ ВЫПОЛНЕНИЯ ===

2025-05-11 18:57:23,809 - server-audit - INFO - STDERR: sudo: a password is required

2025-05-11 18:57:23,809 - server-audit - INFO - Сравниваем с ожидаемым результатом: '0'
2025-05-11 18:57:23,809 - server-audit - INFO - Критерий 509 НЕ ПРОЙДЕН
2025-05-11 18:57:23,809 - server-audit - INFO - Выполнение команды для критерия 610 (6.1. Ensure wireless interfaces are disabled): rfkill list
2025-05-11 18:57:23,912 - server-audit - INFO - Результат выполнения команды для критерия 610:
2025-05-11 18:57:23,912 - server-audit - INFO - STDOUT: === НАЧАЛО ВЫПОЛНЕНИЯ КОМАНДЫ ===
Команда: rfkill list
=== РЕЗУЛЬТАТ ВЫПОЛНЕНИЯ ===
/tmp/scan_cmd.sh: line 5: rfkill: command not found
Команда завершилась с ошибкой: 127
=== КОНЕЦ ВЫПОЛНЕНИЯ ===

2025-05-11 18:57:23,912 - server-audit - INFO - STDERR: sudo: a password is required

2025-05-11 18:57:23,912 - server-audit - INFO - Сравниваем с ожидаемым результатом: 'Soft blocked: yes'
2025-05-11 18:57:23,913 - server-audit - INFO - Критерий 610 НЕ ПРОЙДЕН
2025-05-11 18:57:23,913 - server-audit - INFO - Выполнение команды для критерия 710 (7.1. Ensure audit is enabled): systemctl is-active auditd
2025-05-11 18:57:24,014 - server-audit - INFO - Результат выполнения команды для критерия 710:
2025-05-11 18:57:24,014 - server-audit - INFO - STDOUT: === НАЧАЛО ВЫПОЛНЕНИЯ КОМАНДЫ ===
Команда: systemctl is-active auditd
=== РЕЗУЛЬТАТ ВЫПОЛНЕНИЯ ===
inactive
Команда завершилась с ошибкой: 4
=== КОНЕЦ ВЫПОЛНЕНИЯ ===

2025-05-11 18:57:24,014 - server-audit - INFO - STDERR: sudo: a password is required

2025-05-11 18:57:24,014 - server-audit - INFO - Сравниваем с ожидаемым результатом: 'active'
2025-05-11 18:57:24,014 - server-audit - INFO - Критерий 710 ПРОЙДЕН
2025-05-11 18:57:24,014 - server-audit - INFO - Выполнение команды для критерия 810 (8.1. Ensure password expiration is 90 days or less): grep PASS_MAX_DAYS /etc/login.defs
2025-05-11 18:57:24,117 - server-audit - INFO - Результат выполнения команды для критерия 810:
2025-05-11 18:57:24,117 - server-audit - INFO - STDOUT: === НАЧАЛО ВЫПОЛНЕНИЯ КОМАНДЫ ===
Команда: grep PASS_MAX_DAYS /etc/login.defs
=== РЕЗУЛЬТАТ ВЫПОЛНЕНИЯ ===
#	PASS_MAX_DAYS	Maximum number of days a password may be used.
PASS_MAX_DAYS	99999
=== КОНЕЦ ВЫПОЛНЕНИЯ ===

2025-05-11 18:57:24,117 - server-audit - INFO - STDERR: sudo: a password is required

2025-05-11 18:57:24,117 - server-audit - INFO - Сравниваем с ожидаемым результатом: '90'
2025-05-11 18:57:24,118 - server-audit - INFO - Критерий 810 НЕ ПРОЙДЕН
2025-05-11 18:57:24,118 - server-audit - INFO - Выполнение команды для критерия 910 (9.1. Ensure SSH warning banner is configured): grep Banner /etc/ssh/sshd_config
2025-05-11 18:57:24,223 - server-audit - INFO - Результат выполнения команды для критерия 910:
2025-05-11 18:57:24,223 - server-audit - INFO - STDOUT: === НАЧАЛО ВЫПОЛНЕНИЯ КОМАНДЫ ===
Команда: grep Banner /etc/ssh/sshd_config
=== РЕЗУЛЬТАТ ВЫПОЛНЕНИЯ ===
#Banner none
=== КОНЕЦ ВЫПОЛНЕНИЯ ===

2025-05-11 18:57:24,223 - server-audit - INFO - STDERR: sudo: a password is required

2025-05-11 18:57:24,223 - server-audit - INFO - Сравниваем с ожидаемым результатом: '/etc/issue.net'
2025-05-11 18:57:24,224 - server-audit - INFO - Критерий 910 НЕ ПРОЙДЕН
2025-05-11 18:57:24,224 - server-audit - INFO - Выполнение команды для критерия 1010 (10.1. Ensure permissions on /etc/passwd are configured): stat -c "%a %u %g" /etc/passwd
2025-05-11 18:57:24,330 - server-audit - INFO - Результат выполнения команды для критерия 1010:
2025-05-11 18:57:24,330 - server-audit - INFO - STDOUT: === НАЧАЛО ВЫПОЛНЕНИЯ КОМАНДЫ ===
Команда: stat -c %a %u %g /etc/passwd
=== РЕЗУЛЬТАТ ВЫПОЛНЕНИЯ ===
644 0 0
=== КОНЕЦ ВЫПОЛНЕНИЯ ===

2025-05-11 18:57:24,330 - server-audit - INFO - STDERR: sudo: a password is required

2025-05-11 18:57:24,331 - server-audit - INFO - Сравниваем с ожидаемым результатом: '644 0 0'
2025-05-11 18:57:24,331 - server-audit - INFO - Критерий 1010 ПРОЙДЕН
2025-05-11 18:57:24,331 - server-audit - INFO - Выполнение команды для критерия 1110 (11.1. Ensure root PATH integrity): echo $PATH | grep -q "::" && echo "Empty Directory" || echo "1"
2025-05-11 18:57:24,434 - server-audit - INFO - Результат выполнения команды для критерия 1110:
2025-05-11 18:57:24,434 - server-audit - INFO - STDOUT: === НАЧАЛО ВЫПОЛНЕНИЯ КОМАНДЫ ===
Команда: echo /usr/local/sbin:/usr/local/bin:/usr/sbin:/usr/bin:/sbin:/bin:/usr/games:/usr/local/games:/snap/bin | grep -q :: && echo Empty Directory || echo 1
=== РЕЗУЛЬТАТ ВЫПОЛНЕНИЯ ===
1
=== КОНЕЦ ВЫПОЛНЕНИЯ ===

2025-05-11 18:57:24,434 - server-audit - INFO - STDERR: sudo: a password is required

2025-05-11 18:57:24,434 - server-audit - INFO - Сравниваем с ожидаемым результатом: '1'
2025-05-11 18:57:24,434 - server-audit - INFO - Критерий 1110 ПРОЙДЕН
2025-05-11 18:57:24,435 - server-audit - INFO - Выполнение команды для критерия 1210 (12.1. Ensure no users have .forward files): find /home -name .forward
2025-05-11 18:57:24,555 - server-audit - INFO - Результат выполнения команды для критерия 1210:
2025-05-11 18:57:24,555 - server-audit - INFO - STDOUT: === НАЧАЛО ВЫПОЛНЕНИЯ КОМАНДЫ ===
Команда: find /home -name .forward
=== РЕЗУЛЬТАТ ВЫПОЛНЕНИЯ ===
find: ‘/home/aidar’: Permission denied
Команда завершилась с ошибкой: 1
=== КОНЕЦ ВЫПОЛНЕНИЯ ===

2025-05-11 18:57:24,555 - server-audit - INFO - STDERR: sudo: a password is required

2025-05-11 18:57:24,555 - server-audit - INFO - Сравниваем с ожидаемым результатом: ''
2025-05-11 18:57:24,555 - server-audit - INFO - Критерий 1210 НЕ ПРОЙДЕН
2025-05-11 18:57:24,555 - server-audit - INFO - Сканирование сервера 25.15.212.99 завершено. Закрываем SSH-соединение.
2025-05-11 18:59:08,439 - server-audit - INFO - Начало сканирования сервера 25.15.212.99
2025-05-11 18:59:08,469 - server-audit - INFO - Подключение к серверу 25.15.212.99 по SSH с пользователем ayan
2025-05-11 18:59:08,469 - server-audit - INFO - Используется аутентификация по паролю
2025-05-11 18:59:08,475 - paramiko.transport - INFO - Connected (version 2.0, client OpenSSH_9.6p1)
2025-05-11 18:59:08,557 - paramiko.transport - INFO - Authentication (password) successful!
2025-05-11 18:59:08,557 - server-audit - INFO - Успешное подключение к 25.15.212.99. Начинаем выполнение проверок.
2025-05-11 18:59:08,557 - server-audit - INFO - Выполнение команды для критерия 110 (1.1. Ensure periodic security updates are configured): dpkg -l | grep unattended-upgrades
2025-05-11 18:59:08,927 - server-audit - INFO - Результат выполнения команды для критерия 110:
2025-05-11 18:59:08,927 - server-audit - INFO - STDOUT: === НАЧАЛО ВЫПОЛНЕНИЯ КОМАНДЫ ===
Команда: dpkg -l | grep unattended-upgrades
=== РЕЗУЛЬТАТ ВЫПОЛНЕНИЯ ===
ii  unattended-upgrades                  2.9.1+nmu4ubuntu1                       all          automatic installation of security upgrades
=== КОНЕЦ ВЫПОЛНЕНИЯ ===

2025-05-11 18:59:08,927 - server-audit - INFO - STDERR: sudo: a password is required

2025-05-11 18:59:08,927 - server-audit - INFO - Сравниваем с ожидаемым результатом: 'unattended-upgrades'
2025-05-11 18:59:08,927 - server-audit - INFO - Критерий 110 ПРОЙДЕН
2025-05-11 18:59:08,927 - server-audit - INFO - Выполнение команды для критерия 210 (2.1. Ensure /tmp is configured): findmnt -n /tmp
2025-05-11 18:59:09,031 - server-audit - INFO - Результат выполнения команды для критерия 210:
2025-05-11 18:59:09,032 - server-audit - INFO - STDOUT: === НАЧАЛО ВЫПОЛНЕНИЯ КОМАНДЫ ===
Команда: findmnt -n /tmp
=== РЕЗУЛЬТАТ ВЫПОЛНЕНИЯ ===
Команда завершилась с ошибкой: 1
=== КОНЕЦ ВЫПОЛНЕНИЯ ===

2025-05-11 18:59:09,032 - server-audit - INFO - STDERR: sudo: a password is required

2025-05-11 18:59:09,032 - server-audit - INFO - Сравниваем с ожидаемым результатом: 'noexec'
2025-05-11 18:59:09,032 - server-audit - INFO - Критерий 210 НЕ ПРОЙДЕН
2025-05-11 18:59:09,032 - server-audit - INFO - Выполнение команды для критерия 310 (3.1. Ensure bootloader password is set): grep "^password" /boot/grub/grub.cfg
2025-05-11 18:59:09,137 - server-audit - INFO - Результат выполнения команды для критерия 310:
2025-05-11 18:59:09,137 - server-audit - INFO - STDOUT: === НАЧАЛО ВЫПОЛНЕНИЯ КОМАНДЫ ===
Команда: grep ^password /boot/grub/grub.cfg
=== РЕЗУЛЬТАТ ВЫПОЛНЕНИЯ ===
grep: /boot/grub/grub.cfg: Permission denied
Команда завершилась с ошибкой: 2
=== КОНЕЦ ВЫПОЛНЕНИЯ ===

2025-05-11 18:59:09,138 - server-audit - INFO - STDERR: sudo: a password is required

2025-05-11 18:59:09,138 - server-audit - INFO - Сравниваем с ожидаемым результатом: 'password'
2025-05-11 18:59:09,138 - server-audit - INFO - Критерий 310 ПРОЙДЕН
2025-05-11 18:59:09,138 - server-audit - INFO - Выполнение команды для критерия 409 (4.1. Ensure core dumps are restricted): grep -E '^\s*\*\s+hard\s+core' /etc/security/limits.conf
2025-05-11 18:59:09,246 - server-audit - INFO - Результат выполнения команды для критерия 409:
2025-05-11 18:59:09,246 - server-audit - INFO - STDOUT: === НАЧАЛО ВЫПОЛНЕНИЯ КОМАНДЫ ===
Команда: grep -E '^\s*\*\s+hard\s+core' /etc/security/limits.conf
=== РЕЗУЛЬТАТ ВЫПОЛНЕНИЯ ===
Команда завершилась с ошибкой: 1
=== КОНЕЦ ВЫПОЛНЕНИЯ ===

2025-05-11 18:59:09,246 - server-audit - INFO - STDERR: sudo: a password is required

2025-05-11 18:59:09,247 - server-audit - INFO - Сравниваем с ожидаемым результатом: '* hard core 0'
2025-05-11 18:59:09,247 - server-audit - INFO - Критерий 409 НЕ ПРОЙДЕН
2025-05-11 18:59:09,247 - server-audit - INFO - Выполнение команды для критерия 509 (5.1. Ensure IP forwarding is disabled): sysctl net.ipv4.ip_forward
2025-05-11 18:59:09,352 - server-audit - INFO - Результат выполнения команды для критерия 509:
2025-05-11 18:59:09,353 - server-audit - INFO - STDOUT: === НАЧАЛО ВЫПОЛНЕНИЯ КОМАНДЫ ===
Команда: sysctl net.ipv4.ip_forward
=== РЕЗУЛЬТАТ ВЫПОЛНЕНИЯ ===
net.ipv4.ip_forward = 1
=== КОНЕЦ ВЫПОЛНЕНИЯ ===

2025-05-11 18:59:09,353 - server-audit - INFO - STDERR: sudo: a password is required

2025-05-11 18:59:09,353 - server-audit - INFO - Сравниваем с ожидаемым результатом: '0'
2025-05-11 18:59:09,353 - server-audit - INFO - Критерий 509 НЕ ПРОЙДЕН
2025-05-11 18:59:09,353 - server-audit - INFO - Выполнение команды для критерия 610 (6.1. Ensure wireless interfaces are disabled): rfkill list
2025-05-11 18:59:09,459 - server-audit - INFO - Результат выполнения команды для критерия 610:
2025-05-11 18:59:09,459 - server-audit - INFO - STDOUT: === НАЧАЛО ВЫПОЛНЕНИЯ КОМАНДЫ ===
Команда: rfkill list
=== РЕЗУЛЬТАТ ВЫПОЛНЕНИЯ ===
/tmp/scan_cmd.sh: line 5: rfkill: command not found
Команда завершилась с ошибкой: 127
=== КОНЕЦ ВЫПОЛНЕНИЯ ===

2025-05-11 18:59:09,459 - server-audit - INFO - STDERR: sudo: a password is required

2025-05-11 18:59:09,459 - server-audit - INFO - Сравниваем с ожидаемым результатом: 'Soft blocked: yes'
2025-05-11 18:59:09,459 - server-audit - INFO - Критерий 610 НЕ ПРОЙДЕН
2025-05-11 18:59:09,460 - server-audit - INFO - Выполнение команды для критерия 710 (7.1. Ensure audit is enabled): systemctl is-active auditd
2025-05-11 18:59:09,571 - server-audit - INFO - Результат выполнения команды для критерия 710:
2025-05-11 18:59:09,571 - server-audit - INFO - STDOUT: === НАЧАЛО ВЫПОЛНЕНИЯ КОМАНДЫ ===
Команда: systemctl is-active auditd
=== РЕЗУЛЬТАТ ВЫПОЛНЕНИЯ ===
inactive
Команда завершилась с ошибкой: 4
=== КОНЕЦ ВЫПОЛНЕНИЯ ===

2025-05-11 18:59:09,571 - server-audit - INFO - STDERR: sudo: a password is required

2025-05-11 18:59:09,571 - server-audit - INFO - Сравниваем с ожидаемым результатом: 'active'
2025-05-11 18:59:09,571 - server-audit - INFO - Критерий 710 ПРОЙДЕН
2025-05-11 18:59:09,571 - server-audit - INFO - Выполнение команды для критерия 810 (8.1. Ensure password expiration is 90 days or less): grep PASS_MAX_DAYS /etc/login.defs
2025-05-11 18:59:09,680 - server-audit - INFO - Результат выполнения команды для критерия 810:
2025-05-11 18:59:09,680 - server-audit - INFO - STDOUT: === НАЧАЛО ВЫПОЛНЕНИЯ КОМАНДЫ ===
Команда: grep PASS_MAX_DAYS /etc/login.defs
=== РЕЗУЛЬТАТ ВЫПОЛНЕНИЯ ===
#	PASS_MAX_DAYS	Maximum number of days a password may be used.
PASS_MAX_DAYS	99999
=== КОНЕЦ ВЫПОЛНЕНИЯ ===

2025-05-11 18:59:09,681 - server-audit - INFO - STDERR: sudo: a password is required

2025-05-11 18:59:09,681 - server-audit - INFO - Сравниваем с ожидаемым результатом: '90'
2025-05-11 18:59:09,681 - server-audit - INFO - Критерий 810 НЕ ПРОЙДЕН
2025-05-11 18:59:09,681 - server-audit - INFO - Выполнение команды для критерия 910 (9.1. Ensure SSH warning banner is configured): grep Banner /etc/ssh/sshd_config
2025-05-11 18:59:09,787 - server-audit - INFO - Результат выполнения команды для критерия 910:
2025-05-11 18:59:09,787 - server-audit - INFO - STDOUT: === НАЧАЛО ВЫПОЛНЕНИЯ КОМАНДЫ ===
Команда: grep Banner /etc/ssh/sshd_config
=== РЕЗУЛЬТАТ ВЫПОЛНЕНИЯ ===
#Banner none
=== КОНЕЦ ВЫПОЛНЕНИЯ ===

2025-05-11 18:59:09,788 - server-audit - INFO - STDERR: sudo: a password is required

2025-05-11 18:59:09,788 - server-audit - INFO - Сравниваем с ожидаемым результатом: '/etc/issue.net'
2025-05-11 18:59:09,788 - server-audit - INFO - Критерий 910 НЕ ПРОЙДЕН
2025-05-11 18:59:09,788 - server-audit - INFO - Выполнение команды для критерия 1010 (10.1. Ensure permissions on /etc/passwd are configured): stat -c "%a %u %g" /etc/passwd
2025-05-11 18:59:09,893 - server-audit - INFO - Результат выполнения команды для критерия 1010:
2025-05-11 18:59:09,893 - server-audit - INFO - STDOUT: === НАЧАЛО ВЫПОЛНЕНИЯ КОМАНДЫ ===
Команда: stat -c %a %u %g /etc/passwd
=== РЕЗУЛЬТАТ ВЫПОЛНЕНИЯ ===
644 0 0
=== КОНЕЦ ВЫПОЛНЕНИЯ ===

2025-05-11 18:59:09,893 - server-audit - INFO - STDERR: sudo: a password is required

2025-05-11 18:59:09,893 - server-audit - INFO - Сравниваем с ожидаемым результатом: '644 0 0'
2025-05-11 18:59:09,893 - server-audit - INFO - Критерий 1010 ПРОЙДЕН
2025-05-11 18:59:09,894 - server-audit - INFO - Выполнение команды для критерия 1110 (11.1. Ensure root PATH integrity): echo $PATH | grep -q "::" && echo "Empty Directory" || echo "1"
2025-05-11 18:59:09,998 - server-audit - INFO - Результат выполнения команды для критерия 1110:
2025-05-11 18:59:09,999 - server-audit - INFO - STDOUT: === НАЧАЛО ВЫПОЛНЕНИЯ КОМАНДЫ ===
Команда: echo /usr/local/sbin:/usr/local/bin:/usr/sbin:/usr/bin:/sbin:/bin:/usr/games:/usr/local/games:/snap/bin | grep -q :: && echo Empty Directory || echo 1
=== РЕЗУЛЬТАТ ВЫПОЛНЕНИЯ ===
1
=== КОНЕЦ ВЫПОЛНЕНИЯ ===

2025-05-11 18:59:09,999 - server-audit - INFO - STDERR: sudo: a password is required

2025-05-11 18:59:09,999 - server-audit - INFO - Сравниваем с ожидаемым результатом: '1'
2025-05-11 18:59:09,999 - server-audit - INFO - Критерий 1110 ПРОЙДЕН
2025-05-11 18:59:09,999 - server-audit - INFO - Выполнение команды для критерия 1210 (12.1. Ensure no users have .forward files): find /home -name .forward
2025-05-11 18:59:10,118 - server-audit - INFO - Результат выполнения команды для критерия 1210:
2025-05-11 18:59:10,118 - server-audit - INFO - STDOUT: === НАЧАЛО ВЫПОЛНЕНИЯ КОМАНДЫ ===
Команда: find /home -name .forward
=== РЕЗУЛЬТАТ ВЫПОЛНЕНИЯ ===
find: ‘/home/aidar’: Permission denied
Команда завершилась с ошибкой: 1
=== КОНЕЦ ВЫПОЛНЕНИЯ ===

2025-05-11 18:59:10,119 - server-audit - INFO - STDERR: sudo: a password is required

2025-05-11 18:59:10,119 - server-audit - INFO - Сравниваем с ожидаемым результатом: ''
2025-05-11 18:59:10,119 - server-audit - INFO - Критерий 1210 НЕ ПРОЙДЕН
2025-05-11 18:59:10,119 - server-audit - INFO - Сканирование сервера 25.15.212.99 завершено. Закрываем SSH-соединение.
2025-05-11 20:04:29,444 - server-audit - INFO - Попытка входа с именем пользователя: admin
2025-05-11 20:04:29,653 - server-audit - INFO - Успешный вход для пользователя: admin
2025-05-11 20:11:52,738 - server-audit - INFO - Попытка входа с именем пользователя: admin
2025-05-11 20:11:52,740 - passlib.handlers.bcrypt - WARNING - (trapped) error reading bcrypt version
Traceback (most recent call last):
  File "/usr/local/lib/python3.10/site-packages/passlib/handlers/bcrypt.py", line 620, in _load_backend_mixin
    version = _bcrypt.__about__.__version__
AttributeError: module 'bcrypt' has no attribute '__about__'
2025-05-11 20:11:52,958 - server-audit - INFO - Успешный вход для пользователя: admin
2025-05-11 20:21:45,850 - server-audit - INFO - Попытка входа с именем пользователя: admin
2025-05-11 20:21:45,853 - passlib.handlers.bcrypt - WARNING - (trapped) error reading bcrypt version
Traceback (most recent call last):
  File "/usr/local/lib/python3.10/site-packages/passlib/handlers/bcrypt.py", line 620, in _load_backend_mixin
    version = _bcrypt.__about__.__version__
AttributeError: module 'bcrypt' has no attribute '__about__'
2025-05-11 20:21:46,073 - server-audit - INFO - Успешный вход для пользователя: admin
2025-05-11 20:22:55,866 - server-audit - INFO - Начало сканирования сервера 25.15.212.99
2025-05-11 20:22:55,895 - server-audit - INFO - Подключение к серверу 25.15.212.99 по SSH с пользователем ayan
2025-05-11 20:22:55,895 - server-audit - INFO - Используется аутентификация по паролю
2025-05-11 20:22:55,901 - paramiko.transport - INFO - Connected (version 2.0, client OpenSSH_9.6p1)
2025-05-11 20:22:56,010 - paramiko.transport - INFO - Authentication (password) successful!
2025-05-11 20:22:56,010 - server-audit - INFO - Успешное подключение к 25.15.212.99. Начинаем выполнение проверок.
2025-05-11 20:22:56,010 - server-audit - INFO - Проверка работоспособности sudo...
2025-05-11 20:22:56,354 - server-audit - INFO - Тест без sudo: uid=1001(ayan) gid=1002(ayan) groups=1002(ayan),27(sudo),107(tcpdump),111(cockpit-ws),988(zeek)

2025-05-11 20:22:56,409 - server-audit - INFO - Тест с sudo -n: , ошибки: sudo: a password is required

2025-05-11 20:22:56,409 - server-audit - INFO - Sudo -n не работает, пробуем настроить временный sudo доступ
2025-05-11 20:22:56,489 - server-audit - INFO - Настройка временного sudo: [sudo] password for ayan: 
2025-05-11 20:22:56,543 - server-audit - WARNING - Не удалось настроить sudo без пароля, будем использовать обычный sudo
2025-05-11 20:22:56,543 - server-audit - INFO - Выполнение команды для критерия 110 (1.1. Ensure periodic security updates are configured): dpkg -l | grep unattended-upgrades
2025-05-11 20:22:56,630 - server-audit - INFO - Результат выполнения команды для критерия 110:
2025-05-11 20:22:56,630 - server-audit - INFO - STDOUT: === НАЧАЛО ВЫПОЛНЕНИЯ КОМАНДЫ ===
Команда: echo kali | sudo -S dpkg -l | grep unattended-upgrades
=== РЕЗУЛЬТАТ ВЫПОЛНЕНИЯ ===
ii  unattended-upgrades                  2.9.1+nmu4ubuntu1                       all          automatic installation of security upgrades
=== КОНЕЦ ВЫПОЛНЕНИЯ ===

2025-05-11 20:22:56,630 - server-audit - INFO - Сравниваем с ожидаемым результатом: 'unattended-upgrades'
2025-05-11 20:22:56,630 - server-audit - INFO - Критерий 110 ПРОЙДЕН
2025-05-11 20:22:56,630 - server-audit - INFO - Выполнение команды для критерия 210 (2.1. Ensure /tmp is configured): findmnt -n /tmp
2025-05-11 20:22:56,744 - server-audit - INFO - Результат выполнения команды для критерия 210:
2025-05-11 20:22:56,745 - server-audit - INFO - STDOUT: === НАЧАЛО ВЫПОЛНЕНИЯ КОМАНДЫ ===
Команда: echo kali | sudo -S findmnt -n /tmp
=== РЕЗУЛЬТАТ ВЫПОЛНЕНИЯ ===
Команда завершилась с ошибкой: 1
=== КОНЕЦ ВЫПОЛНЕНИЯ ===

2025-05-11 20:22:56,745 - server-audit - INFO - Сравниваем с ожидаемым результатом: 'noexec'
2025-05-11 20:22:56,745 - server-audit - INFO - Критерий 210 НЕ ПРОЙДЕН
2025-05-11 20:22:56,746 - server-audit - INFO - Выполнение команды для критерия 310 (3.1. Ensure bootloader password is set): grep "^password" /boot/grub/grub.cfg
2025-05-11 20:22:56,847 - server-audit - INFO - Результат выполнения команды для критерия 310:
2025-05-11 20:22:56,847 - server-audit - INFO - STDOUT: === НАЧАЛО ВЫПОЛНЕНИЯ КОМАНДЫ ===
Команда: echo kali | sudo -S grep ^password /boot/grub/grub.cfg
=== РЕЗУЛЬТАТ ВЫПОЛНЕНИЯ ===
Команда завершилась с ошибкой: 1
=== КОНЕЦ ВЫПОЛНЕНИЯ ===

2025-05-11 20:22:56,847 - server-audit - INFO - Сравниваем с ожидаемым результатом: 'password'
2025-05-11 20:22:56,847 - server-audit - INFO - Критерий 310 ПРОЙДЕН
2025-05-11 20:22:56,848 - server-audit - INFO - Выполнение команды для критерия 409 (4.1. Ensure core dumps are restricted): grep -E "^\s*\*\s+hard\s+core" /etc/security/limits.conf
2025-05-11 20:22:56,955 - server-audit - INFO - Результат выполнения команды для критерия 409:
2025-05-11 20:22:56,956 - server-audit - INFO - STDOUT: === НАЧАЛО ВЫПОЛНЕНИЯ КОМАНДЫ ===
Команда: echo kali | sudo -S grep -E ^s**s+hards+core /etc/security/limits.conf
=== РЕЗУЛЬТАТ ВЫПОЛНЕНИЯ ===
Команда завершилась с ошибкой: 1
=== КОНЕЦ ВЫПОЛНЕНИЯ ===

2025-05-11 20:22:56,956 - server-audit - INFO - Сравниваем с ожидаемым результатом: '* hard core 0'
2025-05-11 20:22:56,956 - server-audit - INFO - Критерий 409 НЕ ПРОЙДЕН
2025-05-11 20:22:56,956 - server-audit - INFO - Выполнение команды для критерия 412 (4.2. Ensure ASLR is enabled): sysctl kernel.randomize_va_space
2025-05-11 20:22:57,066 - server-audit - INFO - Результат выполнения команды для критерия 412:
2025-05-11 20:22:57,066 - server-audit - INFO - STDOUT: === НАЧАЛО ВЫПОЛНЕНИЯ КОМАНДЫ ===
Команда: echo kali | sudo -S sysctl kernel.randomize_va_space
=== РЕЗУЛЬТАТ ВЫПОЛНЕНИЯ ===
kernel.randomize_va_space = 2
=== КОНЕЦ ВЫПОЛНЕНИЯ ===

2025-05-11 20:22:57,067 - server-audit - INFO - Сравниваем с ожидаемым результатом: '2'
2025-05-11 20:22:57,067 - server-audit - INFO - Критерий 412 ПРОЙДЕН
2025-05-11 20:22:57,067 - server-audit - INFO - Выполнение команды для критерия 509 (5.1. Ensure IP forwarding is disabled): sysctl net.ipv4.ip_forward
2025-05-11 20:22:57,169 - server-audit - INFO - Результат выполнения команды для критерия 509:
2025-05-11 20:22:57,169 - server-audit - INFO - STDOUT: === НАЧАЛО ВЫПОЛНЕНИЯ КОМАНДЫ ===
Команда: echo kali | sudo -S sysctl net.ipv4.ip_forward
=== РЕЗУЛЬТАТ ВЫПОЛНЕНИЯ ===
net.ipv4.ip_forward = 1
=== КОНЕЦ ВЫПОЛНЕНИЯ ===

2025-05-11 20:22:57,169 - server-audit - INFO - Сравниваем с ожидаемым результатом: '0'
2025-05-11 20:22:57,169 - server-audit - INFO - Критерий 509 НЕ ПРОЙДЕН
2025-05-11 20:22:57,169 - server-audit - INFO - Выполнение команды для критерия 520 (5.2. Ensure HTTP server is not enabled unless required): systemctl is-enabled apache2 2>/dev/null || systemctl is-enabled nginx 2>/dev/null || echo disabled
2025-05-11 20:22:57,286 - server-audit - INFO - Результат выполнения команды для критерия 520:
2025-05-11 20:22:57,286 - server-audit - INFO - STDOUT: === НАЧАЛО ВЫПОЛНЕНИЯ КОМАНДЫ ===
Команда: echo kali | sudo -S systemctl is-enabled apache2 2>/dev/null || systemctl is-enabled nginx 2>/dev/null || echo disabled
=== РЕЗУЛЬТАТ ВЫПОЛНЕНИЯ ===
disabled
not-found
disabled
=== КОНЕЦ ВЫПОЛНЕНИЯ ===

2025-05-11 20:22:57,286 - server-audit - INFO - Сравниваем с ожидаемым результатом: 'disabled'
2025-05-11 20:22:57,286 - server-audit - INFO - Критерий 520 ПРОЙДЕН
2025-05-11 20:22:57,287 - server-audit - INFO - Выполнение команды для критерия 550 (5.5. Ensure SSH PermitRootLogin is disabled): grep -i "^PermitRootLogin" /etc/ssh/sshd_config | grep -i "no"
2025-05-11 20:22:57,396 - server-audit - INFO - Результат выполнения команды для критерия 550:
2025-05-11 20:22:57,396 - server-audit - INFO - STDOUT: === НАЧАЛО ВЫПОЛНЕНИЯ КОМАНДЫ ===
Команда: echo kali | sudo -S grep -i ^PermitRootLogin /etc/ssh/sshd_config | grep -i no
=== РЕЗУЛЬТАТ ВЫПОЛНЕНИЯ ===
Команда завершилась с ошибкой: 1
=== КОНЕЦ ВЫПОЛНЕНИЯ ===

2025-05-11 20:22:57,397 - server-audit - INFO - Сравниваем с ожидаемым результатом: 'PermitRootLogin no'
2025-05-11 20:22:57,397 - server-audit - INFO - Критерий 550 НЕ ПРОЙДЕН
2025-05-11 20:22:57,397 - server-audit - INFO - Выполнение команды для критерия 552 (5.5.2 Ensure SSH Protocol is set to 2): grep -i "^Protocol" /etc/ssh/sshd_config
2025-05-11 20:22:57,503 - server-audit - INFO - Результат выполнения команды для критерия 552:
2025-05-11 20:22:57,503 - server-audit - INFO - STDOUT: === НАЧАЛО ВЫПОЛНЕНИЯ КОМАНДЫ ===
Команда: echo kali | sudo -S grep -i ^Protocol /etc/ssh/sshd_config
=== РЕЗУЛЬТАТ ВЫПОЛНЕНИЯ ===
Команда завершилась с ошибкой: 1
=== КОНЕЦ ВЫПОЛНЕНИЯ ===

2025-05-11 20:22:57,503 - server-audit - INFO - Сравниваем с ожидаемым результатом: 'Protocol 2'
2025-05-11 20:22:57,503 - server-audit - INFO - Критерий 552 НЕ ПРОЙДЕН
2025-05-11 20:22:57,503 - server-audit - INFO - Выполнение команды для критерия 610 (6.1. Ensure wireless interfaces are disabled): rfkill list
2025-05-11 20:22:57,601 - server-audit - INFO - Результат выполнения команды для критерия 610:
2025-05-11 20:22:57,601 - server-audit - INFO - STDOUT: === НАЧАЛО ВЫПОЛНЕНИЯ КОМАНДЫ ===
Команда: echo kali | sudo -S rfkill list
=== РЕЗУЛЬТАТ ВЫПОЛНЕНИЯ ===
sudo: rfkill: command not found
Команда завершилась с ошибкой: 1
=== КОНЕЦ ВЫПОЛНЕНИЯ ===

2025-05-11 20:22:57,601 - server-audit - INFO - Сравниваем с ожидаемым результатом: 'Soft blocked: yes'
2025-05-11 20:22:57,601 - server-audit - INFO - Критерий 610 НЕ ПРОЙДЕН
2025-05-11 20:22:57,601 - server-audit - INFO - Выполнение команды для критерия 615 (6.15. Ensure IPv6 is disabled if not in use): sysctl net.ipv6.conf.all.disable_ipv6
2025-05-11 20:22:57,704 - server-audit - INFO - Результат выполнения команды для критерия 615:
2025-05-11 20:22:57,705 - server-audit - INFO - STDOUT: === НАЧАЛО ВЫПОЛНЕНИЯ КОМАНДЫ ===
Команда: echo kali | sudo -S sysctl net.ipv6.conf.all.disable_ipv6
=== РЕЗУЛЬТАТ ВЫПОЛНЕНИЯ ===
net.ipv6.conf.all.disable_ipv6 = 0
=== КОНЕЦ ВЫПОЛНЕНИЯ ===

2025-05-11 20:22:57,705 - server-audit - INFO - Сравниваем с ожидаемым результатом: '1'
2025-05-11 20:22:57,705 - server-audit - INFO - Критерий 615 НЕ ПРОЙДЕН
2025-05-11 20:22:57,705 - server-audit - INFO - Выполнение команды для критерия 620 (6.2. Ensure no unconfined daemons exist): ps -eZ | grep -v "^\w\{1,\}-[\w\{1,\}_]\{1,\} " | grep -v "^system_u:system_r:initrc_t:s0 " | grep -v "^unconfined_u:unconfined_r:unconfined_t:s0 " | grep -v "^unconfined_u:unconfined_r:unconfined_t:s0-s0:c0.c1023 " | tr -s " " | cut -d " " -f2 | sort -u || echo "No unconfined daemons"
2025-05-11 20:22:57,821 - server-audit - INFO - Результат выполнения команды для критерия 620:
2025-05-11 20:22:57,822 - server-audit - INFO - STDOUT: === НАЧАЛО ВЫПОЛНЕНИЯ КОМАНДЫ ===
Команда: echo kali | sudo -S ps -eZ | grep -v ^w{1,}-[w{1,}_]{1,}  | grep -v ^system_u:system_r:initrc_t:s0  | grep -v ^unconfined_u:unconfined_r:unconfined_t:s0  | grep -v ^unconfined_u:unconfined_r:unconfined_t:s0-s0:c0.c1023  | tr -s   | cut -d   -f2 | sort -u || echo No unconfined daemons
=== РЕЗУЛЬТАТ ВЫПОЛНЕНИЯ ===
1
100
101
1016
103
109
119
12
1221
1224
13
137614
137697
137699
137700
137718
137743
137754
137839
137847
137923
137925
137926
137927
138978
139137
139138
139169
139249
139256
14
144
149
149445
149570
149571
149572
149573
15
153777
153846
153853
156612
159623
16
163934
163935
164431
164452
164453
164454
17
170783
170928
170935
170976
174
174793
18
180
181
18313
184108
184239
186138
187391
188024
188592
19
190288
191423
191515
192324
19293
195603
195894
197078
197340
197831
197882
197967
197975
198095
198152
198215
198220
198442
198550
198770
199521
2
20
200335
200454
200651
200781
200975
201037
201371
201619
201871
201934
202066
202075
202076
202077
202228
202231
202233
202234
202235
202236
202237
202238
202239
202240
202241
206
209
21
210
211
212
213
214
215
216
217
2199
22
2208
2231
225
2257
23
2357
238
24
263
27
28
29
2952
2959
3
30
302
303
32
33
33641
33647
33662
33665
33670
33671
33681
33688
33690
33737
33853
34
34168
34171
34172
34173
35
3574
3585
3588
3593
3598
36
3684
374
38
3864
398
399
4
4166
422
43
44
45
4534
4602
4617
466
47
48
4850
4866
487
5
50
5080
51
52
54
55
56
563
564
57
58
582
59
6
60
61
616
62
63
64
65
65180
65184
652
65291
66
67
68
69
7
70
71
716
72
73
74
75
76
77
78
79
80
80698
80708
80991
81
82
827
83
85
87
88
89
9
912
920
921
926
934
937
938
96
973
982
99
(enforce)
PID
=== КОНЕЦ ВЫПОЛНЕНИЯ ===

2025-05-11 20:22:57,822 - server-audit - INFO - Сравниваем с ожидаемым результатом: 'No unconfined daemons'
2025-05-11 20:22:57,822 - server-audit - INFO - Критерий 620 ПРОЙДЕН
2025-05-11 20:22:57,822 - server-audit - INFO - Выполнение команды для критерия 630 (6.30. Ensure firewall is enabled): ufw status | grep -E "Status:\s*active" || iptables -L -n | grep -q "REJECT\|DROP" && echo "Firewall active"
2025-05-11 20:22:57,969 - server-audit - INFO - Результат выполнения команды для критерия 630:
2025-05-11 20:22:57,970 - server-audit - INFO - STDOUT: === НАЧАЛО ВЫПОЛНЕНИЯ КОМАНДЫ ===
Команда: echo kali | sudo -S ufw status | grep -E Status:s*active || iptables -L -n | grep -q REJECT|DROP && echo Firewall active
=== РЕЗУЛЬТАТ ВЫПОЛНЕНИЯ ===
Команда завершилась с ошибкой: 1
=== КОНЕЦ ВЫПОЛНЕНИЯ ===

2025-05-11 20:22:57,970 - server-audit - INFO - STDERR: iptables v1.8.10 (nf_tables): Could not fetch rule set generation id: Permission denied (you must be root)

2025-05-11 20:22:57,970 - server-audit - INFO - Сравниваем с ожидаемым результатом: 'Firewall active'
2025-05-11 20:22:57,970 - server-audit - INFO - Критерий 630 ПРОЙДЕН
2025-05-11 20:22:57,970 - server-audit - INFO - Выполнение команды для критерия 710 (7.1. Ensure audit is enabled): systemctl is-active auditd
2025-05-11 20:22:58,077 - server-audit - INFO - Результат выполнения команды для критерия 710:
2025-05-11 20:22:58,077 - server-audit - INFO - STDOUT: === НАЧАЛО ВЫПОЛНЕНИЯ КОМАНДЫ ===
Команда: echo kali | sudo -S systemctl is-active auditd
=== РЕЗУЛЬТАТ ВЫПОЛНЕНИЯ ===
inactive
Команда завершилась с ошибкой: 4
=== КОНЕЦ ВЫПОЛНЕНИЯ ===

2025-05-11 20:22:58,077 - server-audit - INFO - Сравниваем с ожидаемым результатом: 'active'
2025-05-11 20:22:58,078 - server-audit - INFO - Критерий 710 ПРОЙДЕН
2025-05-11 20:22:58,078 - server-audit - INFO - Выполнение команды для критерия 730 (7.3. Ensure rsyslog or syslog-ng is installed): dpkg -s rsyslog || dpkg -s syslog-ng || echo "No syslog service installed"
2025-05-11 20:22:58,191 - server-audit - INFO - Результат выполнения команды для критерия 730:
2025-05-11 20:22:58,191 - server-audit - INFO - STDOUT: === НАЧАЛО ВЫПОЛНЕНИЯ КОМАНДЫ ===
Команда: echo kali | sudo -S dpkg -s rsyslog || dpkg -s syslog-ng || echo No syslog service installed
=== РЕЗУЛЬТАТ ВЫПОЛНЕНИЯ ===
Package: rsyslog
Status: install ok installed
Priority: optional
Section: admin
Installed-Size: 1775
Maintainer: Ubuntu Developers <ubuntu-devel-discuss@lists.ubuntu.com>
Architecture: amd64
Version: 8.2312.0-3ubuntu9.1
Provides: linux-kernel-log-daemon, system-log-daemon
Depends: libc6 (>= 2.38), libestr0 (>= 0.1.9), libfastjson4 (>= 0.99.8), libsystemd0 (>= 246), libuuid1 (>= 2.16), libzstd1 (>= 1.5.5), zlib1g (>= 1:1.1.4), adduser, ucf
Recommends: logrotate
Suggests: rsyslog-mysql | rsyslog-pgsql, rsyslog-mongodb, rsyslog-doc, rsyslog-openssl | rsyslog-gnutls, rsyslog-gssapi, rsyslog-relp, apparmor (>= 2.8.96~2541-0ubuntu4~)
Conflicts: linux-kernel-log-daemon, system-log-daemon
Conffiles:
 /etc/apparmor.d/rsyslog.d/README 85ad3bd22e3539dff283a25c3c4e118e
 /etc/apparmor.d/usr.sbin.rsyslogd ecb568ee9b5dcc6c74053465d88b8516
 /etc/logcheck/ignore.d.server/rsyslog 58c2337cacd6a3296c2c9728fc3e52fd
 /etc/logrotate.d/rsyslog 3f26282ac0106961634fe4efb9edc3f4
 /etc/rsyslog.conf a14b59f17abdcfda417f99a99c030e67
Description: reliable system and kernel logging daemon
 Rsyslog is a multi-threaded implementation of syslogd (a system utility
 providing support for message logging), with features that include:
  * reliable syslog over TCP, SSL/TLS and RELP
  * on-demand disk buffering
  * email alerting
  * writing to MySQL or PostgreSQL databases (via separate output plugins)
  * permitted sender lists
  * filtering on any part of the syslog message
  * on-the-wire message compression
  * fine-grained output format control
  * failover to backup destinations
  * enterprise-class encrypted syslog relaying
 .
 It is the default syslogd on Debian systems.
Homepage: https://www.rsyslog.com/
Original-Maintainer: Michael Biebl <biebl@debian.org>
=== КОНЕЦ ВЫПОЛНЕНИЯ ===

2025-05-11 20:22:58,191 - server-audit - INFO - Сравниваем с ожидаемым результатом: 'Status: install ok installed'
2025-05-11 20:22:58,191 - server-audit - INFO - Критерий 730 ПРОЙДЕН
2025-05-11 20:22:58,191 - server-audit - INFO - Выполнение команды для критерия 810 (8.1. Ensure password expiration is 90 days or less): grep PASS_MAX_DAYS /etc/login.defs
2025-05-11 20:22:58,298 - server-audit - INFO - Результат выполнения команды для критерия 810:
2025-05-11 20:22:58,299 - server-audit - INFO - STDOUT: === НАЧАЛО ВЫПОЛНЕНИЯ КОМАНДЫ ===
Команда: echo kali | sudo -S grep PASS_MAX_DAYS /etc/login.defs
=== РЕЗУЛЬТАТ ВЫПОЛНЕНИЯ ===
#	PASS_MAX_DAYS	Maximum number of days a password may be used.
PASS_MAX_DAYS	99999
=== КОНЕЦ ВЫПОЛНЕНИЯ ===

2025-05-11 20:22:58,299 - server-audit - INFO - Сравниваем с ожидаемым результатом: '90'
2025-05-11 20:22:58,299 - server-audit - INFO - Критерий 810 НЕ ПРОЙДЕН
2025-05-11 20:22:58,299 - server-audit - INFO - Выполнение команды для критерия 820 (8.2. Ensure all users have a valid password hash): cat /etc/shadow | awk -F: '($2 == "" ) { print $1 " has no password" ; exit 1 }' || echo "No empty passwords"
2025-05-11 20:22:58,409 - server-audit - INFO - Результат выполнения команды для критерия 820:
2025-05-11 20:22:58,409 - server-audit - INFO - STDOUT: === НАЧАЛО ВЫПОЛНЕНИЯ КОМАНДЫ ===
Команда: echo kali | sudo -S cat /etc/shadow | awk -F: '( ==  ) { print   has no password ; exit 1 }' || echo No empty passwords
=== РЕЗУЛЬТАТ ВЫПОЛНЕНИЯ ===
=== КОНЕЦ ВЫПОЛНЕНИЯ ===

2025-05-11 20:22:58,409 - server-audit - INFO - Сравниваем с ожидаемым результатом: 'No empty passwords'
2025-05-11 20:22:58,409 - server-audit - INFO - Критерий 820 ПРОЙДЕН
2025-05-11 20:22:58,409 - server-audit - INFO - Выполнение команды для критерия 910 (9.1. Ensure SSH warning banner is configured): grep Banner /etc/ssh/sshd_config
2025-05-11 20:22:58,517 - server-audit - INFO - Результат выполнения команды для критерия 910:
2025-05-11 20:22:58,517 - server-audit - INFO - STDOUT: === НАЧАЛО ВЫПОЛНЕНИЯ КОМАНДЫ ===
Команда: echo kali | sudo -S grep Banner /etc/ssh/sshd_config
=== РЕЗУЛЬТАТ ВЫПОЛНЕНИЯ ===
#Banner none
=== КОНЕЦ ВЫПОЛНЕНИЯ ===

2025-05-11 20:22:58,518 - server-audit - INFO - Сравниваем с ожидаемым результатом: '/etc/issue.net'
2025-05-11 20:22:58,518 - server-audit - INFO - Критерий 910 НЕ ПРОЙДЕН
2025-05-11 20:22:58,518 - server-audit - INFO - Выполнение команды для критерия 1010 (10.1. Ensure permissions on /etc/passwd are configured): stat -c "%a %u %g" /etc/passwd
2025-05-11 20:22:58,629 - server-audit - INFO - Результат выполнения команды для критерия 1010:
2025-05-11 20:22:58,629 - server-audit - INFO - STDOUT: === НАЧАЛО ВЫПОЛНЕНИЯ КОМАНДЫ ===
Команда: echo kali | sudo -S stat -c %a %u %g /etc/passwd
=== РЕЗУЛЬТАТ ВЫПОЛНЕНИЯ ===
644 0 0
=== КОНЕЦ ВЫПОЛНЕНИЯ ===

2025-05-11 20:22:58,629 - server-audit - INFO - Сравниваем с ожидаемым результатом: '644 0 0'
2025-05-11 20:22:58,630 - server-audit - INFO - Критерий 1010 ПРОЙДЕН
2025-05-11 20:22:58,630 - server-audit - INFO - Выполнение команды для критерия 1020 (10.2. Ensure permissions on /etc/shadow are configured): stat -c "%a %u %g" /etc/shadow
2025-05-11 20:22:58,736 - server-audit - INFO - Результат выполнения команды для критерия 1020:
2025-05-11 20:22:58,737 - server-audit - INFO - STDOUT: === НАЧАЛО ВЫПОЛНЕНИЯ КОМАНДЫ ===
Команда: echo kali | sudo -S stat -c %a %u %g /etc/shadow
=== РЕЗУЛЬТАТ ВЫПОЛНЕНИЯ ===
640 0 42
=== КОНЕЦ ВЫПОЛНЕНИЯ ===

2025-05-11 20:22:58,737 - server-audit - INFO - Сравниваем с ожидаемым результатом: '640 0 42'
2025-05-11 20:22:58,737 - server-audit - INFO - Критерий 1020 ПРОЙДЕН
2025-05-11 20:22:58,737 - server-audit - INFO - Выполнение команды для критерия 1110 (11.1. Ensure root PATH integrity): echo $PATH | grep -q "::" && echo "Empty Directory" || echo "1"
2025-05-11 20:22:58,843 - server-audit - INFO - Результат выполнения команды для критерия 1110:
2025-05-11 20:22:58,844 - server-audit - INFO - STDOUT: === НАЧАЛО ВЫПОЛНЕНИЯ КОМАНДЫ ===
Команда: echo kali | sudo -S echo /usr/local/sbin:/usr/local/bin:/usr/sbin:/usr/bin:/sbin:/bin:/usr/games:/usr/local/games:/snap/bin | grep -q :: && echo Empty Directory || echo 1
=== РЕЗУЛЬТАТ ВЫПОЛНЕНИЯ ===
1
=== КОНЕЦ ВЫПОЛНЕНИЯ ===

2025-05-11 20:22:58,844 - server-audit - INFO - Сравниваем с ожидаемым результатом: '1'
2025-05-11 20:22:58,845 - server-audit - INFO - Критерий 1110 ПРОЙДЕН
2025-05-11 20:22:58,845 - server-audit - INFO - Выполнение команды для критерия 1210 (12.1. Ensure no users have .forward files): find /home -name .forward
2025-05-11 20:22:59,012 - server-audit - INFO - Результат выполнения команды для критерия 1210:
2025-05-11 20:22:59,012 - server-audit - INFO - STDOUT: === НАЧАЛО ВЫПОЛНЕНИЯ КОМАНДЫ ===
Команда: echo kali | sudo -S find /home -name .forward
=== РЕЗУЛЬТАТ ВЫПОЛНЕНИЯ ===
=== КОНЕЦ ВЫПОЛНЕНИЯ ===

2025-05-11 20:22:59,012 - server-audit - INFO - Сравниваем с ожидаемым результатом: ''
2025-05-11 20:22:59,012 - server-audit - INFO - Критерий 1210 НЕ ПРОЙДЕН
2025-05-11 20:22:59,058 - server-audit - INFO - Временный файл sudoers удален
2025-05-11 20:22:59,059 - server-audit - INFO - Сканирование сервера 25.15.212.99 завершено. Закрываем SSH-соединение.
2025-05-11 20:32:43,497 - server-audit - INFO - Попытка входа с именем пользователя: admin
2025-05-11 20:32:43,705 - server-audit - INFO - Успешный вход для пользователя: admin
2025-05-11 20:51:34,319 - server-audit - INFO - Попытка входа с именем пользователя: admin
2025-05-11 20:51:34,322 - passlib.handlers.bcrypt - WARNING - (trapped) error reading bcrypt version
Traceback (most recent call last):
  File "/usr/local/lib/python3.10/site-packages/passlib/handlers/bcrypt.py", line 620, in _load_backend_mixin
    version = _bcrypt.__about__.__version__
AttributeError: module 'bcrypt' has no attribute '__about__'
2025-05-11 20:51:34,544 - server-audit - INFO - Успешный вход для пользователя: admin
2025-05-11 20:55:19,472 - server-audit - INFO - Попытка входа с именем пользователя: admin
2025-05-11 20:55:19,474 - passlib.handlers.bcrypt - WARNING - (trapped) error reading bcrypt version
Traceback (most recent call last):
  File "/usr/local/lib/python3.10/site-packages/passlib/handlers/bcrypt.py", line 620, in _load_backend_mixin
    version = _bcrypt.__about__.__version__
AttributeError: module 'bcrypt' has no attribute '__about__'
2025-05-11 20:55:19,692 - server-audit - INFO - Успешный вход для пользователя: admin
2025-05-11 20:55:50,785 - server-audit - INFO - Начало сканирования сервера 25.15.212.99
2025-05-11 20:55:50,812 - server-audit - INFO - Подключение к серверу 25.15.212.99 по SSH с пользователем ayan
2025-05-11 20:55:50,812 - server-audit - INFO - Используется аутентификация по паролю
2025-05-11 20:55:50,820 - paramiko.transport - INFO - Connected (version 2.0, client OpenSSH_9.6p1)
2025-05-11 20:55:50,903 - paramiko.transport - INFO - Authentication (password) successful!
2025-05-11 20:55:50,903 - server-audit - INFO - Успешное подключение к 25.15.212.99. Начинаем выполнение проверок.
2025-05-11 20:55:50,903 - server-audit - INFO - Проверка работоспособности sudo...
2025-05-11 20:55:51,234 - server-audit - INFO - Тест без sudo: uid=1001(ayan) gid=1002(ayan) groups=1002(ayan),27(sudo),107(tcpdump),111(cockpit-ws),988(zeek)

2025-05-11 20:55:51,291 - server-audit - INFO - Тест с sudo -n: , ошибки: sudo: a password is required

2025-05-11 20:55:51,291 - server-audit - INFO - Sudo -n не работает, пробуем настроить временный sudo доступ
2025-05-11 20:55:51,373 - server-audit - INFO - Настройка временного sudo: [sudo] password for ayan: 
2025-05-11 20:55:51,431 - server-audit - WARNING - Не удалось настроить sudo без пароля, будем использовать обычный sudo
2025-05-11 20:55:51,431 - server-audit - INFO - Выполнение команды для критерия 110 (1.1. Ensure periodic security updates are configured): dpkg -l | grep unattended-upgrades
2025-05-11 20:55:51,518 - server-audit - INFO - Результат выполнения команды для критерия 110:
2025-05-11 20:55:51,519 - server-audit - INFO - STDOUT: === НАЧАЛО ВЫПОЛНЕНИЯ КОМАНДЫ ===
Команда: echo kali | sudo -S dpkg -l | grep unattended-upgrades
=== РЕЗУЛЬТАТ ВЫПОЛНЕНИЯ ===
ii  unattended-upgrades                  2.9.1+nmu4ubuntu1                       all          automatic installation of security upgrades
=== КОНЕЦ ВЫПОЛНЕНИЯ ===

2025-05-11 20:55:51,519 - server-audit - INFO - Сравниваем с ожидаемым результатом: 'unattended-upgrades'
2025-05-11 20:55:51,519 - server-audit - INFO - Критерий 110 ПРОЙДЕН
2025-05-11 20:55:51,519 - server-audit - INFO - Выполнение команды для критерия 120 (1.2. Ensure system packages are up to date): apt list --upgradable | grep -q 'upgradable' && echo 'Upgrades needed' || echo 'No upgrades needed'
2025-05-11 20:55:51,867 - server-audit - INFO - Результат выполнения команды для критерия 120:
2025-05-11 20:55:51,868 - server-audit - INFO - STDOUT: === НАЧАЛО ВЫПОЛНЕНИЯ КОМАНДЫ ===
Команда: echo kali | sudo -S apt list --upgradable | grep -q 'upgradable' && echo 'Upgrades needed' || echo 'No upgrades needed'
=== РЕЗУЛЬТАТ ВЫПОЛНЕНИЯ ===
No upgrades needed
=== КОНЕЦ ВЫПОЛНЕНИЯ ===

2025-05-11 20:55:51,868 - server-audit - INFO - STDERR: 
WARNING: apt does not have a stable CLI interface. Use with caution in scripts.


2025-05-11 20:55:51,868 - server-audit - INFO - Сравниваем с ожидаемым результатом: 'No upgrades needed'
2025-05-11 20:55:51,868 - server-audit - INFO - Критерий 120 ПРОЙДЕН
2025-05-11 20:55:51,868 - server-audit - INFO - Выполнение команды для критерия 130 (1.3. Ensure APT repositories use secure transports): grep -E '^deb\s+[^http:|file:]' /etc/apt/sources.list /etc/apt/sources.list.d/*.list 2>/dev/null || echo 'All transports secure'
2025-05-11 20:55:51,974 - server-audit - INFO - Результат выполнения команды для критерия 130:
2025-05-11 20:55:51,975 - server-audit - INFO - STDOUT: === НАЧАЛО ВЫПОЛНЕНИЯ КОМАНДЫ ===
Команда: echo kali | sudo -S grep -E '^deb\s+[^http:|file:]' /etc/apt/sources.list /etc/apt/sources.list.d/*.list 2>/dev/null || echo 'All transports secure'
=== РЕЗУЛЬТАТ ВЫПОЛНЕНИЯ ===
/etc/apt/sources.list.d/docker.list:deb [arch=amd64 signed-by=/etc/apt/keyrings/docker.asc] https://download.docker.com/linux/ubuntu noble stable
/etc/apt/sources.list.d/wazuh.list:deb [signed-by=/usr/share/keyrings/wazuh.gpg] https://packages.wazuh.com/4.x/apt/ stable main
/etc/apt/sources.list.d/zeek.list:deb [signed-by=/usr/share/keyrings/zeek-keyring.gpg] https://download.opensuse.org/repositories/security:/zeek/xUbuntu_24.04/ /
=== КОНЕЦ ВЫПОЛНЕНИЯ ===

2025-05-11 20:55:51,975 - server-audit - INFO - Сравниваем с ожидаемым результатом: 'All transports secure'
2025-05-11 20:55:51,975 - server-audit - INFO - Критерий 130 ПРОЙДЕН
2025-05-11 20:55:51,975 - server-audit - INFO - Выполнение команды для критерия 210 (2.1. Ensure /tmp is configured): findmnt -n /tmp
2025-05-11 20:55:52,081 - server-audit - INFO - Результат выполнения команды для критерия 210:
2025-05-11 20:55:52,081 - server-audit - INFO - STDOUT: === НАЧАЛО ВЫПОЛНЕНИЯ КОМАНДЫ ===
Команда: echo kali | sudo -S findmnt -n /tmp
=== РЕЗУЛЬТАТ ВЫПОЛНЕНИЯ ===
Команда завершилась с ошибкой: 1
=== КОНЕЦ ВЫПОЛНЕНИЯ ===

2025-05-11 20:55:52,082 - server-audit - INFO - Сравниваем с ожидаемым результатом: 'noexec'
2025-05-11 20:55:52,082 - server-audit - INFO - Критерий 210 НЕ ПРОЙДЕН
2025-05-11 20:55:52,082 - server-audit - INFO - Выполнение команды для критерия 220 (2.2. Ensure nodev option set on /tmp partition): findmnt -n /tmp | grep -q 'nodev' && echo 'nodev set' || echo 'nodev not set'
2025-05-11 20:55:52,185 - server-audit - INFO - Результат выполнения команды для критерия 220:
2025-05-11 20:55:52,185 - server-audit - INFO - STDOUT: === НАЧАЛО ВЫПОЛНЕНИЯ КОМАНДЫ ===
Команда: echo kali | sudo -S findmnt -n /tmp | grep -q 'nodev' && echo 'nodev set' || echo 'nodev not set'
=== РЕЗУЛЬТАТ ВЫПОЛНЕНИЯ ===
nodev not set
=== КОНЕЦ ВЫПОЛНЕНИЯ ===

2025-05-11 20:55:52,186 - server-audit - INFO - Сравниваем с ожидаемым результатом: 'nodev set'
2025-05-11 20:55:52,186 - server-audit - INFO - Критерий 220 ПРОЙДЕН
2025-05-11 20:55:52,186 - server-audit - INFO - Выполнение команды для критерия 230 (2.3. Ensure nosuid option set on /tmp partition): findmnt -n /tmp | grep -q 'nosuid' && echo 'nosuid set' || echo 'nosuid not set'
2025-05-11 20:55:52,292 - server-audit - INFO - Результат выполнения команды для критерия 230:
2025-05-11 20:55:52,293 - server-audit - INFO - STDOUT: === НАЧАЛО ВЫПОЛНЕНИЯ КОМАНДЫ ===
Команда: echo kali | sudo -S findmnt -n /tmp | grep -q 'nosuid' && echo 'nosuid set' || echo 'nosuid not set'
=== РЕЗУЛЬТАТ ВЫПОЛНЕНИЯ ===
nosuid not set
=== КОНЕЦ ВЫПОЛНЕНИЯ ===

2025-05-11 20:55:52,293 - server-audit - INFO - Сравниваем с ожидаемым результатом: 'nosuid set'
2025-05-11 20:55:52,293 - server-audit - INFO - Критерий 230 ПРОЙДЕН
2025-05-11 20:55:52,293 - server-audit - INFO - Выполнение команды для критерия 310 (3.1. Ensure bootloader password is set): grep "^password" /boot/grub/grub.cfg
2025-05-11 20:55:52,398 - server-audit - INFO - Результат выполнения команды для критерия 310:
2025-05-11 20:55:52,399 - server-audit - INFO - STDOUT: === НАЧАЛО ВЫПОЛНЕНИЯ КОМАНДЫ ===
Команда: echo kali | sudo -S grep ^password /boot/grub/grub.cfg
=== РЕЗУЛЬТАТ ВЫПОЛНЕНИЯ ===
Команда завершилась с ошибкой: 1
=== КОНЕЦ ВЫПОЛНЕНИЯ ===

2025-05-11 20:55:52,399 - server-audit - INFO - Сравниваем с ожидаемым результатом: 'password'
2025-05-11 20:55:52,399 - server-audit - INFO - Критерий 310 ПРОЙДЕН
2025-05-11 20:55:52,399 - server-audit - INFO - Выполнение команды для критерия 320 (3.2. Ensure permissions on bootloader config are configured): stat -L -c "%a %u %g" /boot/grub/grub.cfg | grep -q '400 0 0' && echo 'Permissions correct' || echo 'Permissions incorrect'
2025-05-11 20:55:52,510 - server-audit - INFO - Результат выполнения команды для критерия 320:
2025-05-11 20:55:52,511 - server-audit - INFO - STDOUT: === НАЧАЛО ВЫПОЛНЕНИЯ КОМАНДЫ ===
Команда: echo kali | sudo -S stat -L -c %a %u %g /boot/grub/grub.cfg | grep -q '400 0 0' && echo 'Permissions correct' || echo 'Permissions incorrect'
=== РЕЗУЛЬТАТ ВЫПОЛНЕНИЯ ===
Permissions incorrect
=== КОНЕЦ ВЫПОЛНЕНИЯ ===

2025-05-11 20:55:52,511 - server-audit - INFO - Сравниваем с ожидаемым результатом: 'Permissions correct'
2025-05-11 20:55:52,512 - server-audit - INFO - Критерий 320 ПРОЙДЕН
2025-05-11 20:55:52,512 - server-audit - INFO - Выполнение команды для критерия 330 (3.3. Ensure authentication required for single user mode): grep -q '^root:[*!]:' /etc/shadow && echo 'Authentication required' || echo 'No authentication required'
2025-05-11 20:55:52,613 - server-audit - INFO - Результат выполнения команды для критерия 330:
2025-05-11 20:55:52,614 - server-audit - INFO - STDOUT: === НАЧАЛО ВЫПОЛНЕНИЯ КОМАНДЫ ===
Команда: echo kali | sudo -S grep -q '^root:[*!]:' /etc/shadow && echo 'Authentication required' || echo 'No authentication required'
=== РЕЗУЛЬТАТ ВЫПОЛНЕНИЯ ===
No authentication required
=== КОНЕЦ ВЫПОЛНЕНИЯ ===

2025-05-11 20:55:52,614 - server-audit - INFO - Сравниваем с ожидаемым результатом: 'Authentication required'
2025-05-11 20:55:52,614 - server-audit - INFO - Критерий 330 ПРОЙДЕН
2025-05-11 20:55:52,615 - server-audit - INFO - Выполнение команды для критерия 409 (4.1. Ensure core dumps are restricted): grep -E "^\s*\*\s+hard\s+core" /etc/security/limits.conf
2025-05-11 20:55:52,722 - server-audit - INFO - Результат выполнения команды для критерия 409:
2025-05-11 20:55:52,722 - server-audit - INFO - STDOUT: === НАЧАЛО ВЫПОЛНЕНИЯ КОМАНДЫ ===
Команда: echo kali | sudo -S grep -E ^s**s+hards+core /etc/security/limits.conf
=== РЕЗУЛЬТАТ ВЫПОЛНЕНИЯ ===
Команда завершилась с ошибкой: 1
=== КОНЕЦ ВЫПОЛНЕНИЯ ===

2025-05-11 20:55:52,722 - server-audit - INFO - Сравниваем с ожидаемым результатом: '* hard core 0'
2025-05-11 20:55:52,722 - server-audit - INFO - Критерий 409 НЕ ПРОЙДЕН
2025-05-11 20:55:52,722 - server-audit - INFO - Выполнение команды для критерия 412 (4.2. Ensure ASLR is enabled): sysctl kernel.randomize_va_space
2025-05-11 20:55:52,826 - server-audit - INFO - Результат выполнения команды для критерия 412:
2025-05-11 20:55:52,827 - server-audit - INFO - STDOUT: === НАЧАЛО ВЫПОЛНЕНИЯ КОМАНДЫ ===
Команда: echo kali | sudo -S sysctl kernel.randomize_va_space
=== РЕЗУЛЬТАТ ВЫПОЛНЕНИЯ ===
kernel.randomize_va_space = 2
=== КОНЕЦ ВЫПОЛНЕНИЯ ===

2025-05-11 20:55:52,827 - server-audit - INFO - Сравниваем с ожидаемым результатом: '2'
2025-05-11 20:55:52,827 - server-audit - INFO - Критерий 412 ПРОЙДЕН
2025-05-11 20:55:52,827 - server-audit - INFO - Выполнение команды для критерия 420 (4.3. Ensure prelink is disabled): dpkg -s prelink 2>/dev/null | grep -q 'Status: install' && echo 'Prelink installed' || echo 'Prelink not installed'
2025-05-11 20:55:52,943 - server-audit - INFO - Результат выполнения команды для критерия 420:
2025-05-11 20:55:52,944 - server-audit - INFO - STDOUT: === НАЧАЛО ВЫПОЛНЕНИЯ КОМАНДЫ ===
Команда: echo kali | sudo -S dpkg -s prelink 2>/dev/null | grep -q 'Status: install' && echo 'Prelink installed' || echo 'Prelink not installed'
=== РЕЗУЛЬТАТ ВЫПОЛНЕНИЯ ===
Prelink not installed
=== КОНЕЦ ВЫПОЛНЕНИЯ ===

2025-05-11 20:55:52,944 - server-audit - INFO - Сравниваем с ожидаемым результатом: 'Prelink not installed'
2025-05-11 20:55:52,944 - server-audit - INFO - Критерий 420 ПРОЙДЕН
2025-05-11 20:55:52,944 - server-audit - INFO - Выполнение команды для критерия 430 (4.4. Ensure core dumps are not readable by all users): grep -q 'fs.suid_dumpable = 0' /etc/sysctl.conf /etc/sysctl.d/* && echo 'Core dumps protected' || echo 'Core dumps may be exposed'
2025-05-11 20:55:53,055 - server-audit - INFO - Результат выполнения команды для критерия 430:
2025-05-11 20:55:53,055 - server-audit - INFO - STDOUT: === НАЧАЛО ВЫПОЛНЕНИЯ КОМАНДЫ ===
Команда: echo kali | sudo -S grep -q 'fs.suid_dumpable = 0' /etc/sysctl.conf /etc/sysctl.d/* && echo 'Core dumps protected' || echo 'Core dumps may be exposed'
=== РЕЗУЛЬТАТ ВЫПОЛНЕНИЯ ===
Core dumps may be exposed
=== КОНЕЦ ВЫПОЛНЕНИЯ ===

2025-05-11 20:55:53,055 - server-audit - INFO - Сравниваем с ожидаемым результатом: 'Core dumps protected'
2025-05-11 20:55:53,056 - server-audit - INFO - Критерий 430 ПРОЙДЕН
2025-05-11 20:55:53,056 - server-audit - INFO - Выполнение команды для критерия 509 (5.1. Ensure IP forwarding is disabled): sysctl net.ipv4.ip_forward
2025-05-11 20:55:53,163 - server-audit - INFO - Результат выполнения команды для критерия 509:
2025-05-11 20:55:53,164 - server-audit - INFO - STDOUT: === НАЧАЛО ВЫПОЛНЕНИЯ КОМАНДЫ ===
Команда: echo kali | sudo -S sysctl net.ipv4.ip_forward
=== РЕЗУЛЬТАТ ВЫПОЛНЕНИЯ ===
net.ipv4.ip_forward = 1
=== КОНЕЦ ВЫПОЛНЕНИЯ ===

2025-05-11 20:55:53,164 - server-audit - INFO - Сравниваем с ожидаемым результатом: '0'
2025-05-11 20:55:53,164 - server-audit - INFO - Критерий 509 НЕ ПРОЙДЕН
2025-05-11 20:55:53,164 - server-audit - INFO - Выполнение команды для критерия 520 (5.2. Ensure HTTP server is not enabled unless required): systemctl is-enabled apache2 2>/dev/null || systemctl is-enabled nginx 2>/dev/null || echo disabled
2025-05-11 20:55:53,280 - server-audit - INFO - Результат выполнения команды для критерия 520:
2025-05-11 20:55:53,280 - server-audit - INFO - STDOUT: === НАЧАЛО ВЫПОЛНЕНИЯ КОМАНДЫ ===
Команда: echo kali | sudo -S systemctl is-enabled apache2 2>/dev/null || systemctl is-enabled nginx 2>/dev/null || echo disabled
=== РЕЗУЛЬТАТ ВЫПОЛНЕНИЯ ===
disabled
not-found
disabled
=== КОНЕЦ ВЫПОЛНЕНИЯ ===

2025-05-11 20:55:53,280 - server-audit - INFO - Сравниваем с ожидаемым результатом: 'disabled'
2025-05-11 20:55:53,280 - server-audit - INFO - Критерий 520 ПРОЙДЕН
2025-05-11 20:55:53,280 - server-audit - INFO - Выполнение команды для критерия 530 (5.3. Ensure SSH MaxAuthTries is set to 4 or less): grep -E '^MaxAuthTries\s+[1-4]' /etc/ssh/sshd_config && echo 'Correctly configured' || echo 'Not properly configured'
2025-05-11 20:55:53,387 - server-audit - INFO - Результат выполнения команды для критерия 530:
2025-05-11 20:55:53,387 - server-audit - INFO - STDOUT: === НАЧАЛО ВЫПОЛНЕНИЯ КОМАНДЫ ===
Команда: echo kali | sudo -S grep -E '^MaxAuthTries\s+[1-4]' /etc/ssh/sshd_config && echo 'Correctly configured' || echo 'Not properly configured'
=== РЕЗУЛЬТАТ ВЫПОЛНЕНИЯ ===
Not properly configured
=== КОНЕЦ ВЫПОЛНЕНИЯ ===

2025-05-11 20:55:53,387 - server-audit - INFO - Сравниваем с ожидаемым результатом: 'Correctly configured'
2025-05-11 20:55:53,387 - server-audit - INFO - Критерий 530 ПРОЙДЕН
2025-05-11 20:55:53,387 - server-audit - INFO - Выполнение команды для критерия 540 (5.4. Ensure SSH LogLevel is set to INFO): grep -i "^LogLevel INFO" /etc/ssh/sshd_config && echo 'Correctly configured' || echo 'Not properly configured'
2025-05-11 20:55:53,498 - server-audit - INFO - Результат выполнения команды для критерия 540:
2025-05-11 20:55:53,498 - server-audit - INFO - STDOUT: === НАЧАЛО ВЫПОЛНЕНИЯ КОМАНДЫ ===
Команда: echo kali | sudo -S grep -i ^LogLevel INFO /etc/ssh/sshd_config && echo 'Correctly configured' || echo 'Not properly configured'
=== РЕЗУЛЬТАТ ВЫПОЛНЕНИЯ ===
Not properly configured
=== КОНЕЦ ВЫПОЛНЕНИЯ ===

2025-05-11 20:55:53,498 - server-audit - INFO - Сравниваем с ожидаемым результатом: 'Correctly configured'
2025-05-11 20:55:53,498 - server-audit - INFO - Критерий 540 ПРОЙДЕН
2025-05-11 20:55:53,498 - server-audit - INFO - Выполнение команды для критерия 550 (5.5. Ensure SSH PermitRootLogin is disabled): grep -i "^PermitRootLogin" /etc/ssh/sshd_config | grep -i "no"
2025-05-11 20:55:53,603 - server-audit - INFO - Результат выполнения команды для критерия 550:
2025-05-11 20:55:53,604 - server-audit - INFO - STDOUT: === НАЧАЛО ВЫПОЛНЕНИЯ КОМАНДЫ ===
Команда: echo kali | sudo -S grep -i ^PermitRootLogin /etc/ssh/sshd_config | grep -i no
=== РЕЗУЛЬТАТ ВЫПОЛНЕНИЯ ===
Команда завершилась с ошибкой: 1
=== КОНЕЦ ВЫПОЛНЕНИЯ ===

2025-05-11 20:55:53,604 - server-audit - INFO - Сравниваем с ожидаемым результатом: 'PermitRootLogin no'
2025-05-11 20:55:53,604 - server-audit - INFO - Критерий 550 НЕ ПРОЙДЕН
2025-05-11 20:55:53,604 - server-audit - INFO - Выполнение команды для критерия 552 (5.5.2 Ensure SSH Protocol is set to 2): grep -i "^Protocol" /etc/ssh/sshd_config
2025-05-11 20:55:53,711 - server-audit - INFO - Результат выполнения команды для критерия 552:
2025-05-11 20:55:53,711 - server-audit - INFO - STDOUT: === НАЧАЛО ВЫПОЛНЕНИЯ КОМАНДЫ ===
Команда: echo kali | sudo -S grep -i ^Protocol /etc/ssh/sshd_config
=== РЕЗУЛЬТАТ ВЫПОЛНЕНИЯ ===
Команда завершилась с ошибкой: 1
=== КОНЕЦ ВЫПОЛНЕНИЯ ===

2025-05-11 20:55:53,711 - server-audit - INFO - Сравниваем с ожидаемым результатом: 'Protocol 2'
2025-05-11 20:55:53,712 - server-audit - INFO - Критерий 552 НЕ ПРОЙДЕН
2025-05-11 20:55:53,712 - server-audit - INFO - Выполнение команды для критерия 560 (5.6. Ensure SSH PermitEmptyPasswords is disabled): grep -i "^PermitEmptyPasswords" /etc/ssh/sshd_config | grep -i "no" && echo 'Correctly configured' || echo 'Not properly configured'
2025-05-11 20:55:53,817 - server-audit - INFO - Результат выполнения команды для критерия 560:
2025-05-11 20:55:53,817 - server-audit - INFO - STDOUT: === НАЧАЛО ВЫПОЛНЕНИЯ КОМАНДЫ ===
Команда: echo kali | sudo -S grep -i ^PermitEmptyPasswords /etc/ssh/sshd_config | grep -i no && echo 'Correctly configured' || echo 'Not properly configured'
=== РЕЗУЛЬТАТ ВЫПОЛНЕНИЯ ===
Not properly configured
=== КОНЕЦ ВЫПОЛНЕНИЯ ===

2025-05-11 20:55:53,817 - server-audit - INFO - Сравниваем с ожидаемым результатом: 'Correctly configured'
2025-05-11 20:55:53,817 - server-audit - INFO - Критерий 560 ПРОЙДЕН
2025-05-11 20:55:53,818 - server-audit - INFO - Выполнение команды для критерия 570 (5.7. Ensure SSH X11 forwarding is disabled): grep -i "^X11Forwarding" /etc/ssh/sshd_config | grep -i "no" && echo 'X11 forwarding disabled' || echo 'X11 forwarding not disabled'
2025-05-11 20:55:53,929 - server-audit - INFO - Результат выполнения команды для критерия 570:
2025-05-11 20:55:53,930 - server-audit - INFO - STDOUT: === НАЧАЛО ВЫПОЛНЕНИЯ КОМАНДЫ ===
Команда: echo kali | sudo -S grep -i ^X11Forwarding /etc/ssh/sshd_config | grep -i no && echo 'X11 forwarding disabled' || echo 'X11 forwarding not disabled'
=== РЕЗУЛЬТАТ ВЫПОЛНЕНИЯ ===
X11 forwarding not disabled
=== КОНЕЦ ВЫПОЛНЕНИЯ ===

2025-05-11 20:55:53,930 - server-audit - INFO - Сравниваем с ожидаемым результатом: 'X11 forwarding disabled'
2025-05-11 20:55:53,930 - server-audit - INFO - Критерий 570 ПРОЙДЕН
2025-05-11 20:55:53,930 - server-audit - INFO - Выполнение команды для критерия 610 (6.1. Ensure wireless interfaces are disabled): rfkill list
2025-05-11 20:55:54,033 - server-audit - INFO - Результат выполнения команды для критерия 610:
2025-05-11 20:55:54,033 - server-audit - INFO - STDOUT: === НАЧАЛО ВЫПОЛНЕНИЯ КОМАНДЫ ===
Команда: echo kali | sudo -S rfkill list
=== РЕЗУЛЬТАТ ВЫПОЛНЕНИЯ ===
sudo: rfkill: command not found
Команда завершилась с ошибкой: 1
=== КОНЕЦ ВЫПОЛНЕНИЯ ===

2025-05-11 20:55:54,033 - server-audit - INFO - Сравниваем с ожидаемым результатом: 'Soft blocked: yes'
2025-05-11 20:55:54,033 - server-audit - INFO - Критерий 610 НЕ ПРОЙДЕН
2025-05-11 20:55:54,033 - server-audit - INFO - Выполнение команды для критерия 615 (6.15. Ensure IPv6 is disabled if not in use): sysctl net.ipv6.conf.all.disable_ipv6
2025-05-11 20:55:54,136 - server-audit - INFO - Результат выполнения команды для критерия 615:
2025-05-11 20:55:54,137 - server-audit - INFO - STDOUT: === НАЧАЛО ВЫПОЛНЕНИЯ КОМАНДЫ ===
Команда: echo kali | sudo -S sysctl net.ipv6.conf.all.disable_ipv6
=== РЕЗУЛЬТАТ ВЫПОЛНЕНИЯ ===
net.ipv6.conf.all.disable_ipv6 = 0
=== КОНЕЦ ВЫПОЛНЕНИЯ ===

2025-05-11 20:55:54,137 - server-audit - INFO - Сравниваем с ожидаемым результатом: '1'
2025-05-11 20:55:54,137 - server-audit - INFO - Критерий 615 НЕ ПРОЙДЕН
2025-05-11 20:55:54,137 - server-audit - INFO - Выполнение команды для критерия 620 (6.2. Ensure no unconfined daemons exist): ps -eZ | grep -v "^\w\{1,\}-[\w\{1,\}_]\{1,\} " | grep -v "^system_u:system_r:initrc_t:s0 " | grep -v "^unconfined_u:unconfined_r:unconfined_t:s0 " | grep -v "^unconfined_u:unconfined_r:unconfined_t:s0-s0:c0.c1023 " | tr -s " " | cut -d " " -f2 | sort -u || echo "No unconfined daemons"
2025-05-11 20:55:54,251 - server-audit - INFO - Результат выполнения команды для критерия 620:
2025-05-11 20:55:54,252 - server-audit - INFO - STDOUT: === НАЧАЛО ВЫПОЛНЕНИЯ КОМАНДЫ ===
Команда: echo kali | sudo -S ps -eZ | grep -v ^w{1,}-[w{1,}_]{1,}  | grep -v ^system_u:system_r:initrc_t:s0  | grep -v ^unconfined_u:unconfined_r:unconfined_t:s0  | grep -v ^unconfined_u:unconfined_r:unconfined_t:s0-s0:c0.c1023  | tr -s   | cut -d   -f2 | sort -u || echo No unconfined daemons
=== РЕЗУЛЬТАТ ВЫПОЛНЕНИЯ ===
1
100
101
1016
103
109
119
12
1221
1224
13
137614
137697
137699
137700
137718
137743
137754
137839
137847
137923
137925
137926
137927
138978
139137
139138
139169
139249
139256
14
144
149
149445
149570
149571
149572
149573
15
153777
153846
153853
156612
159623
16
163934
163935
164431
164452
164453
164454
17
170928
170976
174
174793
18
180
181
18313
184108
188024
19
19293
195603
197340
197882
197967
197975
198095
198152
198215
198220
198442
2
20
201037
201371
203347
203633
204301
204492
205526
205919
206
207027
207135
207506
207696
207987
208020
208284
208438
208952
209
21
210
210270
210443
210633
210663
210667
211
211110
211875
211936
212
212027
212036
212037
212038
212298
212301
212303
212304
212305
212306
212307
212308
212309
212310
212311
213
214
215
216
217
2199
22
2208
2231
225
2257
23
2357
238
24
263
27
28
29
2952
2959
3
30
302
303
32
33
33641
33647
33662
33665
33670
33671
33681
33688
33690
33737
33853
34
34168
34171
34172
34173
35
3574
3585
3588
3593
3598
36
3684
374
38
3864
398
399
4
4166
422
43
44
45
4534
4602
4617
466
47
48
4850
4866
487
5
50
5080
51
52
54
55
56
563
564
57
58
582
59
6
60
61
616
62
63
64
65
65180
65184
652
65291
66
67
68
69
7
70
71
716
72
73
74
75
76
77
78
79
80
80698
80708
80991
81
82
827
83
85
87
88
89
9
912
920
921
926
934
937
938
96
973
982
99
(enforce)
PID
=== КОНЕЦ ВЫПОЛНЕНИЯ ===

2025-05-11 20:55:54,252 - server-audit - INFO - Сравниваем с ожидаемым результатом: 'No unconfined daemons'
2025-05-11 20:55:54,252 - server-audit - INFO - Критерий 620 ПРОЙДЕН
2025-05-11 20:55:54,252 - server-audit - INFO - Выполнение команды для критерия 630 (6.30. Ensure firewall is enabled): ufw status | grep -E "Status:\s*active" || iptables -L -n | grep -q "REJECT\|DROP" && echo "Firewall active"
2025-05-11 20:55:54,393 - server-audit - INFO - Результат выполнения команды для критерия 630:
2025-05-11 20:55:54,393 - server-audit - INFO - STDOUT: === НАЧАЛО ВЫПОЛНЕНИЯ КОМАНДЫ ===
Команда: echo kali | sudo -S ufw status | grep -E Status:s*active || iptables -L -n | grep -q REJECT|DROP && echo Firewall active
=== РЕЗУЛЬТАТ ВЫПОЛНЕНИЯ ===
Команда завершилась с ошибкой: 1
=== КОНЕЦ ВЫПОЛНЕНИЯ ===

2025-05-11 20:55:54,393 - server-audit - INFO - STDERR: iptables v1.8.10 (nf_tables): Could not fetch rule set generation id: Permission denied (you must be root)

2025-05-11 20:55:54,393 - server-audit - INFO - Сравниваем с ожидаемым результатом: 'Firewall active'
2025-05-11 20:55:54,393 - server-audit - INFO - Критерий 630 ПРОЙДЕН
2025-05-11 20:55:54,393 - server-audit - INFO - Выполнение команды для критерия 640 (6.4. Ensure outbound connections are restricted): iptables -L OUTPUT -v -n | grep -q 'REJECT\|DROP' && echo 'Outbound filtering active' || echo 'No outbound filtering'
2025-05-11 20:55:54,502 - server-audit - INFO - Результат выполнения команды для критерия 640:
2025-05-11 20:55:54,503 - server-audit - INFO - STDOUT: === НАЧАЛО ВЫПОЛНЕНИЯ КОМАНДЫ ===
Команда: echo kali | sudo -S iptables -L OUTPUT -v -n | grep -q 'REJECT\|DROP' && echo 'Outbound filtering active' || echo 'No outbound filtering'
=== РЕЗУЛЬТАТ ВЫПОЛНЕНИЯ ===
No outbound filtering
=== КОНЕЦ ВЫПОЛНЕНИЯ ===

2025-05-11 20:55:54,503 - server-audit - INFO - Сравниваем с ожидаемым результатом: 'Outbound filtering active'
2025-05-11 20:55:54,503 - server-audit - INFO - Критерий 640 ПРОЙДЕН
2025-05-11 20:55:54,503 - server-audit - INFO - Выполнение команды для критерия 650 (6.5. Ensure wireless network interfaces are disabled): ip link | grep -i 'state UP' | grep -i wireless || echo 'No active wireless interfaces'
2025-05-11 20:55:54,609 - server-audit - INFO - Результат выполнения команды для критерия 650:
2025-05-11 20:55:54,609 - server-audit - INFO - STDOUT: === НАЧАЛО ВЫПОЛНЕНИЯ КОМАНДЫ ===
Команда: echo kali | sudo -S ip link | grep -i 'state UP' | grep -i wireless || echo 'No active wireless interfaces'
=== РЕЗУЛЬТАТ ВЫПОЛНЕНИЯ ===
No active wireless interfaces
=== КОНЕЦ ВЫПОЛНЕНИЯ ===

2025-05-11 20:55:54,609 - server-audit - INFO - Сравниваем с ожидаемым результатом: 'No active wireless interfaces'
2025-05-11 20:55:54,609 - server-audit - INFO - Критерий 650 ПРОЙДЕН
2025-05-11 20:55:54,610 - server-audit - INFO - Выполнение команды для критерия 710 (7.1. Ensure audit is enabled): systemctl is-active auditd
2025-05-11 20:55:54,709 - server-audit - INFO - Результат выполнения команды для критерия 710:
2025-05-11 20:55:54,709 - server-audit - INFO - STDOUT: === НАЧАЛО ВЫПОЛНЕНИЯ КОМАНДЫ ===
Команда: echo kali | sudo -S systemctl is-active auditd
=== РЕЗУЛЬТАТ ВЫПОЛНЕНИЯ ===
inactive
Команда завершилась с ошибкой: 4
=== КОНЕЦ ВЫПОЛНЕНИЯ ===

2025-05-11 20:55:54,709 - server-audit - INFO - Сравниваем с ожидаемым результатом: 'active'
2025-05-11 20:55:54,710 - server-audit - INFO - Критерий 710 ПРОЙДЕН
2025-05-11 20:55:54,710 - server-audit - INFO - Выполнение команды для критерия 720 (7.2. Ensure auditd service is enabled): systemctl is-enabled auditd && echo 'Enabled' || echo 'Not enabled'
2025-05-11 20:55:54,818 - server-audit - INFO - Результат выполнения команды для критерия 720:
2025-05-11 20:55:54,818 - server-audit - INFO - STDOUT: === НАЧАЛО ВЫПОЛНЕНИЯ КОМАНДЫ ===
Команда: echo kali | sudo -S systemctl is-enabled auditd && echo 'Enabled' || echo 'Not enabled'
=== РЕЗУЛЬТАТ ВЫПОЛНЕНИЯ ===
not-found
Not enabled
=== КОНЕЦ ВЫПОЛНЕНИЯ ===

2025-05-11 20:55:54,819 - server-audit - INFO - Сравниваем с ожидаемым результатом: 'Enabled'
2025-05-11 20:55:54,819 - server-audit - INFO - Критерий 720 ПРОЙДЕН
2025-05-11 20:55:54,819 - server-audit - INFO - Выполнение команды для критерия 730 (7.3. Ensure rsyslog or syslog-ng is installed): dpkg -s rsyslog || dpkg -s syslog-ng || echo "No syslog service installed"
2025-05-11 20:55:54,937 - server-audit - INFO - Результат выполнения команды для критерия 730:
2025-05-11 20:55:54,938 - server-audit - INFO - STDOUT: === НАЧАЛО ВЫПОЛНЕНИЯ КОМАНДЫ ===
Команда: echo kali | sudo -S dpkg -s rsyslog || dpkg -s syslog-ng || echo No syslog service installed
=== РЕЗУЛЬТАТ ВЫПОЛНЕНИЯ ===
Package: rsyslog
Status: install ok installed
Priority: optional
Section: admin
Installed-Size: 1775
Maintainer: Ubuntu Developers <ubuntu-devel-discuss@lists.ubuntu.com>
Architecture: amd64
Version: 8.2312.0-3ubuntu9.1
Provides: linux-kernel-log-daemon, system-log-daemon
Depends: libc6 (>= 2.38), libestr0 (>= 0.1.9), libfastjson4 (>= 0.99.8), libsystemd0 (>= 246), libuuid1 (>= 2.16), libzstd1 (>= 1.5.5), zlib1g (>= 1:1.1.4), adduser, ucf
Recommends: logrotate
Suggests: rsyslog-mysql | rsyslog-pgsql, rsyslog-mongodb, rsyslog-doc, rsyslog-openssl | rsyslog-gnutls, rsyslog-gssapi, rsyslog-relp, apparmor (>= 2.8.96~2541-0ubuntu4~)
Conflicts: linux-kernel-log-daemon, system-log-daemon
Conffiles:
 /etc/apparmor.d/rsyslog.d/README 85ad3bd22e3539dff283a25c3c4e118e
 /etc/apparmor.d/usr.sbin.rsyslogd ecb568ee9b5dcc6c74053465d88b8516
 /etc/logcheck/ignore.d.server/rsyslog 58c2337cacd6a3296c2c9728fc3e52fd
 /etc/logrotate.d/rsyslog 3f26282ac0106961634fe4efb9edc3f4
 /etc/rsyslog.conf a14b59f17abdcfda417f99a99c030e67
Description: reliable system and kernel logging daemon
 Rsyslog is a multi-threaded implementation of syslogd (a system utility
 providing support for message logging), with features that include:
  * reliable syslog over TCP, SSL/TLS and RELP
  * on-demand disk buffering
  * email alerting
  * writing to MySQL or PostgreSQL databases (via separate output plugins)
  * permitted sender lists
  * filtering on any part of the syslog message
  * on-the-wire message compression
  * fine-grained output format control
  * failover to backup destinations
  * enterprise-class encrypted syslog relaying
 .
 It is the default syslogd on Debian systems.
Homepage: https://www.rsyslog.com/
Original-Maintainer: Michael Biebl <biebl@debian.org>
=== КОНЕЦ ВЫПОЛНЕНИЯ ===

2025-05-11 20:55:54,938 - server-audit - INFO - Сравниваем с ожидаемым результатом: 'Status: install ok installed'
2025-05-11 20:55:54,938 - server-audit - INFO - Критерий 730 ПРОЙДЕН
2025-05-11 20:55:54,939 - server-audit - INFO - Выполнение команды для критерия 740 (7.4. Ensure logrotate is configured): grep -r "^rotate" /etc/logrotate.d/ /etc/logrotate.conf | grep -v "^#" && echo 'Logrotate configured' || echo 'Logrotate not configured'
2025-05-11 20:55:55,041 - server-audit - INFO - Результат выполнения команды для критерия 740:
2025-05-11 20:55:55,042 - server-audit - INFO - STDOUT: === НАЧАЛО ВЫПОЛНЕНИЯ КОМАНДЫ ===
Команда: echo kali | sudo -S grep -r ^rotate /etc/logrotate.d/ /etc/logrotate.conf | grep -v ^# && echo 'Logrotate configured' || echo 'Logrotate not configured'
=== РЕЗУЛЬТАТ ВЫПОЛНЕНИЯ ===
/etc/logrotate.conf:rotate 4
Logrotate configured
=== КОНЕЦ ВЫПОЛНЕНИЯ ===

2025-05-11 20:55:55,042 - server-audit - INFO - Сравниваем с ожидаемым результатом: 'Logrotate configured'
2025-05-11 20:55:55,042 - server-audit - INFO - Критерий 740 ПРОЙДЕН
2025-05-11 20:55:55,042 - server-audit - INFO - Выполнение команды для критерия 750 (7.5. Ensure remote syslog is configured): grep -E '^[^#].*@.*' /etc/rsyslog.conf /etc/rsyslog.d/*.conf && echo 'Remote logging configured' || echo 'Remote logging not configured'
2025-05-11 20:55:55,146 - server-audit - INFO - Результат выполнения команды для критерия 750:
2025-05-11 20:55:55,146 - server-audit - INFO - STDOUT: === НАЧАЛО ВЫПОЛНЕНИЯ КОМАНДЫ ===
Команда: echo kali | sudo -S grep -E '^[^#].*@.*' /etc/rsyslog.conf /etc/rsyslog.d/*.conf && echo 'Remote logging configured' || echo 'Remote logging not configured'
=== РЕЗУЛЬТАТ ВЫПОЛНЕНИЯ ===
Remote logging not configured
=== КОНЕЦ ВЫПОЛНЕНИЯ ===

2025-05-11 20:55:55,146 - server-audit - INFO - Сравниваем с ожидаемым результатом: 'Remote logging configured'
2025-05-11 20:55:55,146 - server-audit - INFO - Критерий 750 ПРОЙДЕН
2025-05-11 20:55:55,146 - server-audit - INFO - Выполнение команды для критерия 810 (8.1. Ensure password expiration is 90 days or less): grep PASS_MAX_DAYS /etc/login.defs
2025-05-11 20:55:55,252 - server-audit - INFO - Результат выполнения команды для критерия 810:
2025-05-11 20:55:55,253 - server-audit - INFO - STDOUT: === НАЧАЛО ВЫПОЛНЕНИЯ КОМАНДЫ ===
Команда: echo kali | sudo -S grep PASS_MAX_DAYS /etc/login.defs
=== РЕЗУЛЬТАТ ВЫПОЛНЕНИЯ ===
#	PASS_MAX_DAYS	Maximum number of days a password may be used.
PASS_MAX_DAYS	99999
=== КОНЕЦ ВЫПОЛНЕНИЯ ===

2025-05-11 20:55:55,253 - server-audit - INFO - Сравниваем с ожидаемым результатом: '90'
2025-05-11 20:55:55,253 - server-audit - INFO - Критерий 810 НЕ ПРОЙДЕН
2025-05-11 20:55:55,253 - server-audit - INFO - Выполнение команды для критерия 820 (8.2. Ensure all users have a valid password hash): cat /etc/shadow | awk -F: '($2 == "" ) { print $1 " has no password" ; exit 1 }' || echo "No empty passwords"
2025-05-11 20:55:55,353 - server-audit - INFO - Результат выполнения команды для критерия 820:
2025-05-11 20:55:55,354 - server-audit - INFO - STDOUT: === НАЧАЛО ВЫПОЛНЕНИЯ КОМАНДЫ ===
Команда: echo kali | sudo -S cat /etc/shadow | awk -F: '( ==  ) { print   has no password ; exit 1 }' || echo No empty passwords
=== РЕЗУЛЬТАТ ВЫПОЛНЕНИЯ ===
=== КОНЕЦ ВЫПОЛНЕНИЯ ===

2025-05-11 20:55:55,354 - server-audit - INFO - Сравниваем с ожидаемым результатом: 'No empty passwords'
2025-05-11 20:55:55,354 - server-audit - INFO - Критерий 820 ПРОЙДЕН
2025-05-11 20:55:55,354 - server-audit - INFO - Выполнение команды для критерия 830 (8.3. Ensure minimum days between password changes is 7 or more): grep -E '^PASS_MIN_DAYS\s+[7-9]|^PASS_MIN_DAYS\s+[1-9][0-9]+' /etc/login.defs && echo 'Correctly configured' || echo 'Not properly configured'
2025-05-11 20:55:55,462 - server-audit - INFO - Результат выполнения команды для критерия 830:
2025-05-11 20:55:55,462 - server-audit - INFO - STDOUT: === НАЧАЛО ВЫПОЛНЕНИЯ КОМАНДЫ ===
Команда: echo kali | sudo -S grep -E '^PASS_MIN_DAYS\s+[7-9]|^PASS_MIN_DAYS\s+[1-9][0-9]+' /etc/login.defs && echo 'Correctly configured' || echo 'Not properly configured'
=== РЕЗУЛЬТАТ ВЫПОЛНЕНИЯ ===
Not properly configured
=== КОНЕЦ ВЫПОЛНЕНИЯ ===

2025-05-11 20:55:55,462 - server-audit - INFO - Сравниваем с ожидаемым результатом: 'Correctly configured'
2025-05-11 20:55:55,462 - server-audit - INFO - Критерий 830 ПРОЙДЕН
2025-05-11 20:55:55,463 - server-audit - INFO - Выполнение команды для критерия 840 (8.4. Ensure password hashing algorithm is SHA-512): grep -E '^password\s+[^\s]+\s+pam_unix.so\s+.*sha512' /etc/pam.d/common-password && echo 'SHA-512 enabled' || echo 'SHA-512 not enabled'
2025-05-11 20:55:55,568 - server-audit - INFO - Результат выполнения команды для критерия 840:
2025-05-11 20:55:55,569 - server-audit - INFO - STDOUT: === НАЧАЛО ВЫПОЛНЕНИЯ КОМАНДЫ ===
Команда: echo kali | sudo -S grep -E '^password\s+[^\s]+\s+pam_unix.so\s+.*sha512' /etc/pam.d/common-password && echo 'SHA-512 enabled' || echo 'SHA-512 not enabled'
=== РЕЗУЛЬТАТ ВЫПОЛНЕНИЯ ===
SHA-512 not enabled
=== КОНЕЦ ВЫПОЛНЕНИЯ ===

2025-05-11 20:55:55,569 - server-audit - INFO - Сравниваем с ожидаемым результатом: 'SHA-512 enabled'
2025-05-11 20:55:55,569 - server-audit - INFO - Критерий 840 ПРОЙДЕН
2025-05-11 20:55:55,569 - server-audit - INFO - Выполнение команды для критерия 910 (9.1. Ensure SSH warning banner is configured): grep Banner /etc/ssh/sshd_config
2025-05-11 20:55:55,678 - server-audit - INFO - Результат выполнения команды для критерия 910:
2025-05-11 20:55:55,678 - server-audit - INFO - STDOUT: === НАЧАЛО ВЫПОЛНЕНИЯ КОМАНДЫ ===
Команда: echo kali | sudo -S grep Banner /etc/ssh/sshd_config
=== РЕЗУЛЬТАТ ВЫПОЛНЕНИЯ ===
#Banner none
=== КОНЕЦ ВЫПОЛНЕНИЯ ===

2025-05-11 20:55:55,678 - server-audit - INFO - Сравниваем с ожидаемым результатом: '/etc/issue.net'
2025-05-11 20:55:55,678 - server-audit - INFO - Критерий 910 НЕ ПРОЙДЕН
2025-05-11 20:55:55,679 - server-audit - INFO - Выполнение команды для критерия 920 (9.2. Ensure /etc/issue contains appropriate warning): grep -E 'Authorized users only|authorized use only|unauthorized access prohibited' /etc/issue && echo 'Warning exists' || echo 'No appropriate warning'
2025-05-11 20:55:55,783 - server-audit - INFO - Результат выполнения команды для критерия 920:
2025-05-11 20:55:55,783 - server-audit - INFO - STDOUT: === НАЧАЛО ВЫПОЛНЕНИЯ КОМАНДЫ ===
Команда: echo kali | sudo -S grep -E 'Authorized users only|authorized use only|unauthorized access prohibited' /etc/issue && echo 'Warning exists' || echo 'No appropriate warning'
=== РЕЗУЛЬТАТ ВЫПОЛНЕНИЯ ===
No appropriate warning
=== КОНЕЦ ВЫПОЛНЕНИЯ ===

2025-05-11 20:55:55,783 - server-audit - INFO - Сравниваем с ожидаемым результатом: 'Warning exists'
2025-05-11 20:55:55,784 - server-audit - INFO - Критерий 920 ПРОЙДЕН
2025-05-11 20:55:55,784 - server-audit - INFO - Выполнение команды для критерия 930 (9.3. Ensure remote login warning banner is configured): grep -E 'Authorized users only|authorized use only|unauthorized access prohibited' /etc/issue.net && echo 'Warning exists' || echo 'No appropriate warning'
2025-05-11 20:55:55,891 - server-audit - INFO - Результат выполнения команды для критерия 930:
2025-05-11 20:55:55,892 - server-audit - INFO - STDOUT: === НАЧАЛО ВЫПОЛНЕНИЯ КОМАНДЫ ===
Команда: echo kali | sudo -S grep -E 'Authorized users only|authorized use only|unauthorized access prohibited' /etc/issue.net && echo 'Warning exists' || echo 'No appropriate warning'
=== РЕЗУЛЬТАТ ВЫПОЛНЕНИЯ ===
No appropriate warning
=== КОНЕЦ ВЫПОЛНЕНИЯ ===

2025-05-11 20:55:55,893 - server-audit - INFO - Сравниваем с ожидаемым результатом: 'Warning exists'
2025-05-11 20:55:55,893 - server-audit - INFO - Критерий 930 ПРОЙДЕН
2025-05-11 20:55:55,893 - server-audit - INFO - Выполнение команды для критерия 1010 (10.1. Ensure permissions on /etc/passwd are configured): stat -c "%a %u %g" /etc/passwd
2025-05-11 20:55:56,001 - server-audit - INFO - Результат выполнения команды для критерия 1010:
2025-05-11 20:55:56,001 - server-audit - INFO - STDOUT: === НАЧАЛО ВЫПОЛНЕНИЯ КОМАНДЫ ===
Команда: echo kali | sudo -S stat -c %a %u %g /etc/passwd
=== РЕЗУЛЬТАТ ВЫПОЛНЕНИЯ ===
644 0 0
=== КОНЕЦ ВЫПОЛНЕНИЯ ===

2025-05-11 20:55:56,001 - server-audit - INFO - Сравниваем с ожидаемым результатом: '644 0 0'
2025-05-11 20:55:56,001 - server-audit - INFO - Критерий 1010 ПРОЙДЕН
2025-05-11 20:55:56,001 - server-audit - INFO - Выполнение команды для критерия 1020 (10.2. Ensure permissions on /etc/shadow are configured): stat -c "%a %u %g" /etc/shadow
2025-05-11 20:55:56,110 - server-audit - INFO - Результат выполнения команды для критерия 1020:
2025-05-11 20:55:56,110 - server-audit - INFO - STDOUT: === НАЧАЛО ВЫПОЛНЕНИЯ КОМАНДЫ ===
Команда: echo kali | sudo -S stat -c %a %u %g /etc/shadow
=== РЕЗУЛЬТАТ ВЫПОЛНЕНИЯ ===
640 0 42
=== КОНЕЦ ВЫПОЛНЕНИЯ ===

2025-05-11 20:55:56,111 - server-audit - INFO - Сравниваем с ожидаемым результатом: '640 0 42'
2025-05-11 20:55:56,111 - server-audit - INFO - Критерий 1020 ПРОЙДЕН
2025-05-11 20:55:56,111 - server-audit - INFO - Выполнение команды для критерия 1030 (10.3. Ensure permissions on /etc/group are configured): stat -c "%a %u %g" /etc/group | grep -q '644 0 0' && echo 'Permissions correct' || echo 'Permissions incorrect'
2025-05-11 20:55:56,220 - server-audit - INFO - Результат выполнения команды для критерия 1030:
2025-05-11 20:55:56,220 - server-audit - INFO - STDOUT: === НАЧАЛО ВЫПОЛНЕНИЯ КОМАНДЫ ===
Команда: echo kali | sudo -S stat -c %a %u %g /etc/group | grep -q '644 0 0' && echo 'Permissions correct' || echo 'Permissions incorrect'
=== РЕЗУЛЬТАТ ВЫПОЛНЕНИЯ ===
Permissions correct
=== КОНЕЦ ВЫПОЛНЕНИЯ ===

2025-05-11 20:55:56,221 - server-audit - INFO - Сравниваем с ожидаемым результатом: 'Permissions correct'
2025-05-11 20:55:56,221 - server-audit - INFO - Критерий 1030 ПРОЙДЕН
2025-05-11 20:55:56,221 - server-audit - INFO - Выполнение команды для критерия 1040 (10.4. Ensure permissions on /etc/gshadow are configured): stat -c "%a %u %g" /etc/gshadow | grep -q '640 0 42' && echo 'Permissions correct' || echo 'Permissions incorrect'
2025-05-11 20:55:56,327 - server-audit - INFO - Результат выполнения команды для критерия 1040:
2025-05-11 20:55:56,328 - server-audit - INFO - STDOUT: === НАЧАЛО ВЫПОЛНЕНИЯ КОМАНДЫ ===
Команда: echo kali | sudo -S stat -c %a %u %g /etc/gshadow | grep -q '640 0 42' && echo 'Permissions correct' || echo 'Permissions incorrect'
=== РЕЗУЛЬТАТ ВЫПОЛНЕНИЯ ===
Permissions correct
=== КОНЕЦ ВЫПОЛНЕНИЯ ===

2025-05-11 20:55:56,328 - server-audit - INFO - Сравниваем с ожидаемым результатом: 'Permissions correct'
2025-05-11 20:55:56,328 - server-audit - INFO - Критерий 1040 ПРОЙДЕН
2025-05-11 20:55:56,328 - server-audit - INFO - Выполнение команды для критерия 1050 (10.5. Ensure no unauthorized world-writable directories exist): df --local -P | awk {'if (NR!=1) print $6'} | xargs -I '{}' find '{}' -xdev -type d -perm -0002 -not -perm -1000 -print 2>/dev/null || echo 'No world-writable directories without sticky bit found'
2025-05-11 20:55:58,020 - server-audit - INFO - Результат выполнения команды для критерия 1050:
2025-05-11 20:55:58,021 - server-audit - INFO - STDOUT: === НАЧАЛО ВЫПОЛНЕНИЯ КОМАНДЫ ===
Команда: echo kali | sudo -S df --local -P | awk {'if (NR!=1) print '} | xargs -I '{}' find '{}' -xdev -type d -perm -0002 -not -perm -1000 -print 2>/dev/null || echo 'No world-writable directories without sticky bit found'
=== РЕЗУЛЬТАТ ВЫПОЛНЕНИЯ ===
No world-writable directories without sticky bit found
=== КОНЕЦ ВЫПОЛНЕНИЯ ===

2025-05-11 20:55:58,021 - server-audit - INFO - Сравниваем с ожидаемым результатом: 'No world-writable directories without sticky bit found'
2025-05-11 20:55:58,021 - server-audit - INFO - Критерий 1050 ПРОЙДЕН
2025-05-11 20:55:58,021 - server-audit - INFO - Выполнение команды для критерия 1110 (11.1. Ensure root PATH integrity): echo $PATH | grep -q "::" && echo "Empty Directory" || echo "1"
2025-05-11 20:55:58,128 - server-audit - INFO - Результат выполнения команды для критерия 1110:
2025-05-11 20:55:58,129 - server-audit - INFO - STDOUT: === НАЧАЛО ВЫПОЛНЕНИЯ КОМАНДЫ ===
Команда: echo kali | sudo -S echo /usr/local/sbin:/usr/local/bin:/usr/sbin:/usr/bin:/sbin:/bin:/usr/games:/usr/local/games:/snap/bin | grep -q :: && echo Empty Directory || echo 1
=== РЕЗУЛЬТАТ ВЫПОЛНЕНИЯ ===
1
=== КОНЕЦ ВЫПОЛНЕНИЯ ===

2025-05-11 20:55:58,129 - server-audit - INFO - Сравниваем с ожидаемым результатом: '1'
2025-05-11 20:55:58,129 - server-audit - INFO - Критерий 1110 ПРОЙДЕН
2025-05-11 20:55:58,129 - server-audit - INFO - Выполнение команды для критерия 1120 (11.2. Ensure no world-writable files exist): df --local -P | awk {'if (NR!=1) print $6'} | xargs -I '{}' find '{}' -xdev -type f -perm -0002 -print 2>/dev/null || echo 'No world-writable files found'
2025-05-11 20:55:58,720 - server-audit - INFO - Результат выполнения команды для критерия 1120:
2025-05-11 20:55:58,720 - server-audit - INFO - STDOUT: === НАЧАЛО ВЫПОЛНЕНИЯ КОМАНДЫ ===
Команда: echo kali | sudo -S df --local -P | awk {'if (NR!=1) print '} | xargs -I '{}' find '{}' -xdev -type f -perm -0002 -print 2>/dev/null || echo 'No world-writable files found'
=== РЕЗУЛЬТАТ ВЫПОЛНЕНИЯ ===
No world-writable files found
=== КОНЕЦ ВЫПОЛНЕНИЯ ===

2025-05-11 20:55:58,720 - server-audit - INFO - Сравниваем с ожидаемым результатом: 'No world-writable files found'
2025-05-11 20:55:58,720 - server-audit - INFO - Критерий 1120 ПРОЙДЕН
2025-05-11 20:55:58,720 - server-audit - INFO - Выполнение команды для критерия 1130 (11.3. Ensure no unowned files or directories exist): df --local -P | awk {'if (NR!=1) print $6'} | xargs -I '{}' find '{}' -xdev -nouser -ls 2>/dev/null || echo 'No unowned files found'
2025-05-11 20:55:59,585 - server-audit - INFO - Результат выполнения команды для критерия 1130:
2025-05-11 20:55:59,585 - server-audit - INFO - STDOUT: === НАЧАЛО ВЫПОЛНЕНИЯ КОМАНДЫ ===
Команда: echo kali | sudo -S df --local -P | awk {'if (NR!=1) print '} | xargs -I '{}' find '{}' -xdev -nouser -ls 2>/dev/null || echo 'No unowned files found'
=== РЕЗУЛЬТАТ ВЫПОЛНЕНИЯ ===
No unowned files found
=== КОНЕЦ ВЫПОЛНЕНИЯ ===

2025-05-11 20:55:59,585 - server-audit - INFO - Сравниваем с ожидаемым результатом: 'No unowned files found'
2025-05-11 20:55:59,585 - server-audit - INFO - Критерий 1130 ПРОЙДЕН
2025-05-11 20:55:59,585 - server-audit - INFO - Выполнение команды для критерия 1210 (12.1. Ensure no users have .forward files): find /home -name .forward
2025-05-11 20:55:59,751 - server-audit - INFO - Результат выполнения команды для критерия 1210:
2025-05-11 20:55:59,751 - server-audit - INFO - STDOUT: === НАЧАЛО ВЫПОЛНЕНИЯ КОМАНДЫ ===
Команда: echo kali | sudo -S find /home -name .forward
=== РЕЗУЛЬТАТ ВЫПОЛНЕНИЯ ===
=== КОНЕЦ ВЫПОЛНЕНИЯ ===

2025-05-11 20:55:59,751 - server-audit - INFO - Сравниваем с ожидаемым результатом: ''
2025-05-11 20:55:59,751 - server-audit - INFO - Критерий 1210 НЕ ПРОЙДЕН
2025-05-11 20:55:59,752 - server-audit - INFO - Выполнение команды для критерия 1220 (12.2. Ensure no users have .netrc files): find /home -name .netrc 2>/dev/null || echo 'No .netrc files found'
2025-05-11 20:55:59,915 - server-audit - INFO - Результат выполнения команды для критерия 1220:
2025-05-11 20:55:59,915 - server-audit - INFO - STDOUT: === НАЧАЛО ВЫПОЛНЕНИЯ КОМАНДЫ ===
Команда: echo kali | sudo -S find /home -name .netrc 2>/dev/null || echo 'No .netrc files found'
=== РЕЗУЛЬТАТ ВЫПОЛНЕНИЯ ===
=== КОНЕЦ ВЫПОЛНЕНИЯ ===

2025-05-11 20:55:59,915 - server-audit - INFO - Сравниваем с ожидаемым результатом: 'No .netrc files found'
2025-05-11 20:55:59,915 - server-audit - INFO - Критерий 1220 ПРОЙДЕН
2025-05-11 20:55:59,916 - server-audit - INFO - Выполнение команды для критерия 1230 (12.3. Ensure all user home directories have proper permissions): for dir in $(cut -d: -f6 /etc/passwd | grep -v '^/$'); do [ -d "$dir" ] && stat -L -c '%A' "$dir" | cut -c6-10 | grep -q '^-----$' && echo 'Permissions correct' || echo 'Permissions incorrect'; done
2025-05-11 20:56:00,019 - server-audit - INFO - Результат выполнения команды для критерия 1230:
2025-05-11 20:56:00,019 - server-audit - INFO - STDOUT: === НАЧАЛО ВЫПОЛНЕНИЯ КОМАНДЫ ===
Команда: echo kali | sudo -S for dir in /root
/usr/sbin
/bin
/dev
/bin
/usr/games
/var/cache/man
/var/spool/lpd
/var/mail
/var/spool/news
/var/spool/uucp
/bin
/var/www
/var/backups
/var/list
/run/ircd
/nonexistent
/nonexistent
/usr/lib/dhcpcd
/nonexistent
/var/cache/pollinate
/nonexistent
/run/uuidd
/nonexistent
/var/lib/tpm
/var/lib/landscape
/var/lib/fwupd
/var/lib/usbmux
/home/aidar
/var/lib/misc
/nonexistent
/nonexistent
/var/spool/postfix
/run/sshd
/home/ayan
/home/wazuh-indexer
/var/ossec
/nonexistent; do [ -d  ] && stat -L -c '%A'  | cut -c6-10 | grep -q '^-----$' && echo 'Permissions correct' || echo 'Permissions incorrect'; done
=== РЕЗУЛЬТАТ ВЫПОЛНЕНИЯ ===

2025-05-11 20:56:00,020 - server-audit - INFO - STDERR: /tmp/scan_cmd.sh: line 5: syntax error near unexpected token `do'
/tmp/scan_cmd.sh: line 5: `echo "kali" | sudo -S for dir in $(cut -d: -f6 /etc/passwd | grep -v '^/$'); do [ -d "$dir" ] && stat -L -c '%A' "$dir" | cut -c6-10 | grep -q '^-----$' && echo 'Permissions correct' || echo 'Permissions incorrect'; done 2>&1 || echo "Команда завершилась с ошибкой: $?"'

2025-05-11 20:56:00,020 - server-audit - INFO - Сравниваем с ожидаемым результатом: 'Permissions correct'
2025-05-11 20:56:00,020 - server-audit - INFO - Критерий 1230 ПРОЙДЕН
2025-05-11 20:56:00,020 - server-audit - INFO - Выполнение команды для критерия 1240 (12.4. Ensure default user umask is 027 or more restrictive): grep -E '^\s*umask\s+([0-7][0-7]27|[0-7]22)' /etc/profile /etc/bash.bashrc /etc/profile.d/*.sh && echo 'Umask properly configured' || echo 'Umask not configured'
2025-05-11 20:56:00,124 - server-audit - INFO - Результат выполнения команды для критерия 1240:
2025-05-11 20:56:00,124 - server-audit - INFO - STDOUT: === НАЧАЛО ВЫПОЛНЕНИЯ КОМАНДЫ ===
Команда: echo kali | sudo -S grep -E '^\s*umask\s+([0-7][0-7]27|[0-7]22)' /etc/profile /etc/bash.bashrc /etc/profile.d/*.sh && echo 'Umask properly configured' || echo 'Umask not configured'
=== РЕЗУЛЬТАТ ВЫПОЛНЕНИЯ ===
Umask not configured
=== КОНЕЦ ВЫПОЛНЕНИЯ ===

2025-05-11 20:56:00,124 - server-audit - INFO - Сравниваем с ожидаемым результатом: 'Umask properly configured'
2025-05-11 20:56:00,124 - server-audit - INFO - Критерий 1240 ПРОЙДЕН
2025-05-11 20:56:00,174 - server-audit - INFO - Временный файл sudoers удален
2025-05-11 20:56:00,174 - server-audit - INFO - Сканирование сервера 25.15.212.99 завершено. Закрываем SSH-соединение.
2025-05-11 21:05:02,392 - server-audit - INFO - Попытка входа с именем пользователя: admin
2025-05-11 21:05:02,395 - passlib.handlers.bcrypt - WARNING - (trapped) error reading bcrypt version
Traceback (most recent call last):
  File "/usr/local/lib/python3.10/site-packages/passlib/handlers/bcrypt.py", line 620, in _load_backend_mixin
    version = _bcrypt.__about__.__version__
AttributeError: module 'bcrypt' has no attribute '__about__'
2025-05-11 21:05:02,615 - server-audit - INFO - Успешный вход для пользователя: admin
2025-05-11 21:05:13,177 - server-audit - INFO - Начало сканирования сервера 25.15.212.99
2025-05-11 21:05:13,221 - server-audit - INFO - Подключение к серверу 25.15.212.99 по SSH с пользователем ayan
2025-05-11 21:05:13,221 - server-audit - INFO - Используется аутентификация по паролю
2025-05-11 21:05:13,227 - paramiko.transport - INFO - Connected (version 2.0, client OpenSSH_9.6p1)
2025-05-11 21:05:13,310 - paramiko.transport - INFO - Authentication (password) successful!
2025-05-11 21:05:13,310 - server-audit - INFO - Успешное подключение к 25.15.212.99. Начинаем выполнение проверок.
2025-05-11 21:05:13,310 - server-audit - INFO - Проверка работоспособности sudo...
2025-05-11 21:05:13,634 - server-audit - INFO - Тест без sudo: uid=1001(ayan) gid=1002(ayan) groups=1002(ayan),27(sudo),107(tcpdump),111(cockpit-ws),988(zeek)

2025-05-11 21:05:13,690 - server-audit - INFO - Тест с sudo -n: , ошибки: sudo: a password is required

2025-05-11 21:05:13,691 - server-audit - INFO - Sudo -n не работает, пробуем настроить временный sudo доступ
2025-05-11 21:05:13,766 - server-audit - INFO - Настройка временного sudo: [sudo] password for ayan: 
2025-05-11 21:05:13,815 - server-audit - WARNING - Не удалось настроить sudo без пароля, будем использовать обычный sudo
2025-05-11 21:05:13,816 - server-audit - INFO - Выполнение команды для критерия 110 (1.1. Ensure periodic security updates are configured): dpkg -l | grep unattended-upgrades
2025-05-11 21:05:13,902 - server-audit - INFO - Результат выполнения команды для критерия 110:
2025-05-11 21:05:13,902 - server-audit - INFO - STDOUT: === НАЧАЛО ВЫПОЛНЕНИЯ КОМАНДЫ ===
Команда: echo kali | sudo -S dpkg -l | grep unattended-upgrades
=== РЕЗУЛЬТАТ ВЫПОЛНЕНИЯ ===
ii  unattended-upgrades                  2.9.1+nmu4ubuntu1                       all          automatic installation of security upgrades
=== КОНЕЦ ВЫПОЛНЕНИЯ ===

2025-05-11 21:05:13,902 - server-audit - INFO - STDERR: /tmp/scan_cmd.sh: line 6: nEOFnchmod: command not found

2025-05-11 21:05:13,902 - server-audit - INFO - Сравниваем с ожидаемым результатом: 'unattended-upgrades'
2025-05-11 21:05:13,902 - server-audit - INFO - Критерий 110 ПРОЙДЕН
2025-05-11 21:05:13,902 - server-audit - INFO - Выполнение команды для критерия 120 (1.2. Ensure system packages are up to date): apt list --upgradable | grep -q 'upgradable' && echo 'Upgrades needed' || echo 'No upgrades needed'
2025-05-11 21:05:14,209 - server-audit - INFO - Результат выполнения команды для критерия 120:
2025-05-11 21:05:14,209 - server-audit - INFO - STDOUT: === НАЧАЛО ВЫПОЛНЕНИЯ КОМАНДЫ ===
Команда: echo kali | sudo -S apt list --upgradable | grep -q 'upgradable' && echo 'Upgrades needed' || echo 'No upgrades needed'
=== РЕЗУЛЬТАТ ВЫПОЛНЕНИЯ ===
No upgrades needed
=== КОНЕЦ ВЫПОЛНЕНИЯ ===

2025-05-11 21:05:14,209 - server-audit - INFO - STDERR: 
WARNING: apt does not have a stable CLI interface. Use with caution in scripts.

/tmp/scan_cmd.sh: line 6: nEOFnchmod: command not found

2025-05-11 21:05:14,209 - server-audit - INFO - Сравниваем с ожидаемым результатом: 'No upgrades needed'
2025-05-11 21:05:14,209 - server-audit - INFO - Критерий 120 ПРОЙДЕН
2025-05-11 21:05:14,209 - server-audit - INFO - Выполнение команды для критерия 130 (1.3. Ensure APT repositories use secure transports): grep -E '^deb\s+[^http:|file:]' /etc/apt/sources.list /etc/apt/sources.list.d/*.list 2>/dev/null || echo 'All transports secure'
2025-05-11 21:05:14,318 - server-audit - INFO - Результат выполнения команды для критерия 130:
2025-05-11 21:05:14,318 - server-audit - INFO - STDOUT: === НАЧАЛО ВЫПОЛНЕНИЯ КОМАНДЫ ===
Команда: echo kali | sudo -S grep -E '^deb\s+[^http:|file:]' /etc/apt/sources.list /etc/apt/sources.list.d/*.list 2>/dev/null || echo 'All transports secure'
=== РЕЗУЛЬТАТ ВЫПОЛНЕНИЯ ===
/etc/apt/sources.list.d/docker.list:deb [arch=amd64 signed-by=/etc/apt/keyrings/docker.asc] https://download.docker.com/linux/ubuntu noble stable
/etc/apt/sources.list.d/wazuh.list:deb [signed-by=/usr/share/keyrings/wazuh.gpg] https://packages.wazuh.com/4.x/apt/ stable main
/etc/apt/sources.list.d/zeek.list:deb [signed-by=/usr/share/keyrings/zeek-keyring.gpg] https://download.opensuse.org/repositories/security:/zeek/xUbuntu_24.04/ /
=== КОНЕЦ ВЫПОЛНЕНИЯ ===

2025-05-11 21:05:14,319 - server-audit - INFO - STDERR: /tmp/scan_cmd.sh: line 6: nEOFnchmod: command not found

2025-05-11 21:05:14,319 - server-audit - INFO - Сравниваем с ожидаемым результатом: 'All transports secure'
2025-05-11 21:05:14,319 - server-audit - INFO - Критерий 130 ПРОЙДЕН
2025-05-11 21:05:14,319 - server-audit - INFO - Выполнение команды для критерия 210 (2.1. Ensure /tmp is configured): findmnt -n /tmp
2025-05-11 21:05:14,424 - server-audit - INFO - Результат выполнения команды для критерия 210:
2025-05-11 21:05:14,425 - server-audit - INFO - STDOUT: === НАЧАЛО ВЫПОЛНЕНИЯ КОМАНДЫ ===
Команда: echo kali | sudo -S findmnt -n /tmp
=== РЕЗУЛЬТАТ ВЫПОЛНЕНИЯ ===
Команда завершилась с ошибкой: 1
=== КОНЕЦ ВЫПОЛНЕНИЯ ===

2025-05-11 21:05:14,425 - server-audit - INFO - STDERR: /tmp/scan_cmd.sh: line 6: nEOFnchmod: command not found

2025-05-11 21:05:14,425 - server-audit - INFO - Сравниваем с ожидаемым результатом: 'noexec'
2025-05-11 21:05:14,425 - server-audit - INFO - Критерий 210 НЕ ПРОЙДЕН
2025-05-11 21:05:14,425 - server-audit - INFO - Выполнение команды для критерия 220 (2.2. Ensure nodev option set on /tmp partition): findmnt -n /tmp | grep -q 'nodev' && echo 'nodev set' || echo 'nodev not set'
2025-05-11 21:05:14,535 - server-audit - INFO - Результат выполнения команды для критерия 220:
2025-05-11 21:05:14,536 - server-audit - INFO - STDOUT: === НАЧАЛО ВЫПОЛНЕНИЯ КОМАНДЫ ===
Команда: echo kali | sudo -S findmnt -n /tmp | grep -q 'nodev' && echo 'nodev set' || echo 'nodev not set'
=== РЕЗУЛЬТАТ ВЫПОЛНЕНИЯ ===
nodev not set
=== КОНЕЦ ВЫПОЛНЕНИЯ ===

2025-05-11 21:05:14,536 - server-audit - INFO - STDERR: /tmp/scan_cmd.sh: line 6: nEOFnchmod: command not found

2025-05-11 21:05:14,536 - server-audit - INFO - Сравниваем с ожидаемым результатом: 'nodev set'
2025-05-11 21:05:14,536 - server-audit - INFO - Критерий 220 ПРОЙДЕН
2025-05-11 21:05:14,536 - server-audit - INFO - Выполнение команды для критерия 230 (2.3. Ensure nosuid option set on /tmp partition): findmnt -n /tmp | grep -q 'nosuid' && echo 'nosuid set' || echo 'nosuid not set'
2025-05-11 21:05:14,647 - server-audit - INFO - Результат выполнения команды для критерия 230:
2025-05-11 21:05:14,647 - server-audit - INFO - STDOUT: === НАЧАЛО ВЫПОЛНЕНИЯ КОМАНДЫ ===
Команда: echo kali | sudo -S findmnt -n /tmp | grep -q 'nosuid' && echo 'nosuid set' || echo 'nosuid not set'
=== РЕЗУЛЬТАТ ВЫПОЛНЕНИЯ ===
nosuid not set
=== КОНЕЦ ВЫПОЛНЕНИЯ ===

2025-05-11 21:05:14,648 - server-audit - INFO - STDERR: /tmp/scan_cmd.sh: line 6: nEOFnchmod: command not found

2025-05-11 21:05:14,648 - server-audit - INFO - Сравниваем с ожидаемым результатом: 'nosuid set'
2025-05-11 21:05:14,648 - server-audit - INFO - Критерий 230 ПРОЙДЕН
2025-05-11 21:05:14,648 - server-audit - INFO - Выполнение команды для критерия 310 (3.1. Ensure bootloader password is set): grep "^password" /boot/grub/grub.cfg
2025-05-11 21:05:14,754 - server-audit - INFO - Результат выполнения команды для критерия 310:
2025-05-11 21:05:14,754 - server-audit - INFO - STDOUT: === НАЧАЛО ВЫПОЛНЕНИЯ КОМАНДЫ ===
Команда: echo kali | sudo -S grep ^password /boot/grub/grub.cfg
=== РЕЗУЛЬТАТ ВЫПОЛНЕНИЯ ===
Команда завершилась с ошибкой: 1
=== КОНЕЦ ВЫПОЛНЕНИЯ ===

2025-05-11 21:05:14,754 - server-audit - INFO - STDERR: /tmp/scan_cmd.sh: line 6: nEOFnchmod: command not found

2025-05-11 21:05:14,754 - server-audit - INFO - Сравниваем с ожидаемым результатом: 'password'
2025-05-11 21:05:14,754 - server-audit - INFO - Критерий 310 ПРОЙДЕН
2025-05-11 21:05:14,754 - server-audit - INFO - Выполнение команды для критерия 320 (3.2. Ensure permissions on bootloader config are configured): stat -L -c "%a %u %g" /boot/grub/grub.cfg | grep -q '400 0 0' && echo 'Permissions correct' || echo 'Permissions incorrect'
2025-05-11 21:05:14,863 - server-audit - INFO - Результат выполнения команды для критерия 320:
2025-05-11 21:05:14,863 - server-audit - INFO - STDOUT: === НАЧАЛО ВЫПОЛНЕНИЯ КОМАНДЫ ===
Команда: echo kali | sudo -S stat -L -c %a %u %g /boot/grub/grub.cfg | grep -q '400 0 0' && echo 'Permissions correct' || echo 'Permissions incorrect'
=== РЕЗУЛЬТАТ ВЫПОЛНЕНИЯ ===
Permissions incorrect
=== КОНЕЦ ВЫПОЛНЕНИЯ ===

2025-05-11 21:05:14,863 - server-audit - INFO - STDERR: /tmp/scan_cmd.sh: line 6: nEOFnchmod: command not found

2025-05-11 21:05:14,864 - server-audit - INFO - Сравниваем с ожидаемым результатом: 'Permissions correct'
2025-05-11 21:05:14,864 - server-audit - INFO - Критерий 320 ПРОЙДЕН
2025-05-11 21:05:14,864 - server-audit - INFO - Выполнение команды для критерия 330 (3.3. Ensure authentication required for single user mode): grep -q '^root:[*!]:' /etc/shadow && echo 'Authentication required' || echo 'No authentication required'
2025-05-11 21:05:14,971 - server-audit - INFO - Результат выполнения команды для критерия 330:
2025-05-11 21:05:14,972 - server-audit - INFO - STDOUT: === НАЧАЛО ВЫПОЛНЕНИЯ КОМАНДЫ ===
Команда: echo kali | sudo -S grep -q '^root:[*!]:' /etc/shadow && echo 'Authentication required' || echo 'No authentication required'
=== РЕЗУЛЬТАТ ВЫПОЛНЕНИЯ ===
No authentication required
=== КОНЕЦ ВЫПОЛНЕНИЯ ===

2025-05-11 21:05:14,972 - server-audit - INFO - STDERR: /tmp/scan_cmd.sh: line 6: nEOFnchmod: command not found

2025-05-11 21:05:14,972 - server-audit - INFO - Сравниваем с ожидаемым результатом: 'Authentication required'
2025-05-11 21:05:14,972 - server-audit - INFO - Критерий 330 ПРОЙДЕН
2025-05-11 21:05:14,972 - server-audit - INFO - Выполнение команды для критерия 409 (4.1. Ensure core dumps are restricted): grep -E "^\s*\*\s+hard\s+core" /etc/security/limits.conf
2025-05-11 21:05:15,077 - server-audit - INFO - Результат выполнения команды для критерия 409:
2025-05-11 21:05:15,078 - server-audit - INFO - STDOUT: === НАЧАЛО ВЫПОЛНЕНИЯ КОМАНДЫ ===
Команда: echo kali | sudo -S grep -E ^s**s+hards+core /etc/security/limits.conf
=== РЕЗУЛЬТАТ ВЫПОЛНЕНИЯ ===
Команда завершилась с ошибкой: 1
=== КОНЕЦ ВЫПОЛНЕНИЯ ===

2025-05-11 21:05:15,078 - server-audit - INFO - STDERR: /tmp/scan_cmd.sh: line 6: nEOFnchmod: command not found

2025-05-11 21:05:15,078 - server-audit - INFO - Сравниваем с ожидаемым результатом: '* hard core 0'
2025-05-11 21:05:15,078 - server-audit - INFO - Критерий 409 НЕ ПРОЙДЕН
2025-05-11 21:05:15,078 - server-audit - INFO - Выполнение команды для критерия 412 (4.2. Ensure ASLR is enabled): sysctl kernel.randomize_va_space
2025-05-11 21:05:15,185 - server-audit - INFO - Результат выполнения команды для критерия 412:
2025-05-11 21:05:15,185 - server-audit - INFO - STDOUT: === НАЧАЛО ВЫПОЛНЕНИЯ КОМАНДЫ ===
Команда: echo kali | sudo -S sysctl kernel.randomize_va_space
=== РЕЗУЛЬТАТ ВЫПОЛНЕНИЯ ===
kernel.randomize_va_space = 2
=== КОНЕЦ ВЫПОЛНЕНИЯ ===

2025-05-11 21:05:15,185 - server-audit - INFO - STDERR: /tmp/scan_cmd.sh: line 6: nEOFnchmod: command not found

2025-05-11 21:05:15,185 - server-audit - INFO - Сравниваем с ожидаемым результатом: '2'
2025-05-11 21:05:15,185 - server-audit - INFO - Критерий 412 ПРОЙДЕН
2025-05-11 21:05:15,185 - server-audit - INFO - Выполнение команды для критерия 420 (4.3. Ensure prelink is disabled): dpkg -s prelink 2>/dev/null | grep -q 'Status: install' && echo 'Prelink installed' || echo 'Prelink not installed'
2025-05-11 21:05:15,301 - server-audit - INFO - Результат выполнения команды для критерия 420:
2025-05-11 21:05:15,302 - server-audit - INFO - STDOUT: === НАЧАЛО ВЫПОЛНЕНИЯ КОМАНДЫ ===
Команда: echo kali | sudo -S dpkg -s prelink 2>/dev/null | grep -q 'Status: install' && echo 'Prelink installed' || echo 'Prelink not installed'
=== РЕЗУЛЬТАТ ВЫПОЛНЕНИЯ ===
Prelink not installed
=== КОНЕЦ ВЫПОЛНЕНИЯ ===

2025-05-11 21:05:15,302 - server-audit - INFO - STDERR: /tmp/scan_cmd.sh: line 6: nEOFnchmod: command not found

2025-05-11 21:05:15,302 - server-audit - INFO - Сравниваем с ожидаемым результатом: 'Prelink not installed'
2025-05-11 21:05:15,302 - server-audit - INFO - Критерий 420 ПРОЙДЕН
2025-05-11 21:05:15,302 - server-audit - INFO - Выполнение команды для критерия 430 (4.4. Ensure core dumps are not readable by all users): grep -q 'fs.suid_dumpable = 0' /etc/sysctl.conf /etc/sysctl.d/* && echo 'Core dumps protected' || echo 'Core dumps may be exposed'
2025-05-11 21:05:15,411 - server-audit - INFO - Результат выполнения команды для критерия 430:
2025-05-11 21:05:15,412 - server-audit - INFO - STDOUT: === НАЧАЛО ВЫПОЛНЕНИЯ КОМАНДЫ ===
Команда: echo kali | sudo -S grep -q 'fs.suid_dumpable = 0' /etc/sysctl.conf /etc/sysctl.d/* && echo 'Core dumps protected' || echo 'Core dumps may be exposed'
=== РЕЗУЛЬТАТ ВЫПОЛНЕНИЯ ===
Core dumps may be exposed
=== КОНЕЦ ВЫПОЛНЕНИЯ ===

2025-05-11 21:05:15,412 - server-audit - INFO - STDERR: /tmp/scan_cmd.sh: line 6: nEOFnchmod: command not found

2025-05-11 21:05:15,412 - server-audit - INFO - Сравниваем с ожидаемым результатом: 'Core dumps protected'
2025-05-11 21:05:15,412 - server-audit - INFO - Критерий 430 ПРОЙДЕН
2025-05-11 21:05:15,412 - server-audit - INFO - Выполнение команды для критерия 509 (5.1. Ensure IP forwarding is disabled): sysctl net.ipv4.ip_forward
2025-05-11 21:05:15,517 - server-audit - INFO - Результат выполнения команды для критерия 509:
2025-05-11 21:05:15,517 - server-audit - INFO - STDOUT: === НАЧАЛО ВЫПОЛНЕНИЯ КОМАНДЫ ===
Команда: echo kali | sudo -S sysctl net.ipv4.ip_forward
=== РЕЗУЛЬТАТ ВЫПОЛНЕНИЯ ===
net.ipv4.ip_forward = 1
=== КОНЕЦ ВЫПОЛНЕНИЯ ===

2025-05-11 21:05:15,517 - server-audit - INFO - STDERR: /tmp/scan_cmd.sh: line 6: nEOFnchmod: command not found

2025-05-11 21:05:15,517 - server-audit - INFO - Сравниваем с ожидаемым результатом: '0'
2025-05-11 21:05:15,517 - server-audit - INFO - Критерий 509 НЕ ПРОЙДЕН
2025-05-11 21:05:15,517 - server-audit - INFO - Выполнение команды для критерия 520 (5.2. Ensure HTTP server is not enabled unless required): systemctl is-enabled apache2 2>/dev/null || systemctl is-enabled nginx 2>/dev/null || echo disabled
2025-05-11 21:05:15,631 - server-audit - INFO - Результат выполнения команды для критерия 520:
2025-05-11 21:05:15,631 - server-audit - INFO - STDOUT: === НАЧАЛО ВЫПОЛНЕНИЯ КОМАНДЫ ===
Команда: echo kali | sudo -S systemctl is-enabled apache2 2>/dev/null || systemctl is-enabled nginx 2>/dev/null || echo disabled
=== РЕЗУЛЬТАТ ВЫПОЛНЕНИЯ ===
disabled
not-found
disabled
=== КОНЕЦ ВЫПОЛНЕНИЯ ===

2025-05-11 21:05:15,632 - server-audit - INFO - STDERR: /tmp/scan_cmd.sh: line 6: nEOFnchmod: command not found

2025-05-11 21:05:15,632 - server-audit - INFO - Сравниваем с ожидаемым результатом: 'disabled'
2025-05-11 21:05:15,632 - server-audit - INFO - Критерий 520 ПРОЙДЕН
2025-05-11 21:05:15,632 - server-audit - INFO - Выполнение команды для критерия 530 (5.3. Ensure SSH MaxAuthTries is set to 4 or less): grep -E '^MaxAuthTries\s+[1-4]' /etc/ssh/sshd_config && echo 'Correctly configured' || echo 'Not properly configured'
2025-05-11 21:05:15,737 - server-audit - INFO - Результат выполнения команды для критерия 530:
2025-05-11 21:05:15,737 - server-audit - INFO - STDOUT: === НАЧАЛО ВЫПОЛНЕНИЯ КОМАНДЫ ===
Команда: echo kali | sudo -S grep -E '^MaxAuthTries\s+[1-4]' /etc/ssh/sshd_config && echo 'Correctly configured' || echo 'Not properly configured'
=== РЕЗУЛЬТАТ ВЫПОЛНЕНИЯ ===
Not properly configured
=== КОНЕЦ ВЫПОЛНЕНИЯ ===

2025-05-11 21:05:15,737 - server-audit - INFO - STDERR: /tmp/scan_cmd.sh: line 6: nEOFnchmod: command not found

2025-05-11 21:05:15,737 - server-audit - INFO - Сравниваем с ожидаемым результатом: 'Correctly configured'
2025-05-11 21:05:15,737 - server-audit - INFO - Критерий 530 ПРОЙДЕН
2025-05-11 21:05:15,737 - server-audit - INFO - Выполнение команды для критерия 540 (5.4. Ensure SSH LogLevel is set to INFO): grep -i "^LogLevel INFO" /etc/ssh/sshd_config && echo 'Correctly configured' || echo 'Not properly configured'
2025-05-11 21:05:15,841 - server-audit - INFO - Результат выполнения команды для критерия 540:
2025-05-11 21:05:15,841 - server-audit - INFO - STDOUT: === НАЧАЛО ВЫПОЛНЕНИЯ КОМАНДЫ ===
Команда: echo kali | sudo -S grep -i ^LogLevel INFO /etc/ssh/sshd_config && echo 'Correctly configured' || echo 'Not properly configured'
=== РЕЗУЛЬТАТ ВЫПОЛНЕНИЯ ===
Not properly configured
=== КОНЕЦ ВЫПОЛНЕНИЯ ===

2025-05-11 21:05:15,841 - server-audit - INFO - STDERR: /tmp/scan_cmd.sh: line 6: nEOFnchmod: command not found

2025-05-11 21:05:15,842 - server-audit - INFO - Сравниваем с ожидаемым результатом: 'Correctly configured'
2025-05-11 21:05:15,842 - server-audit - INFO - Критерий 540 ПРОЙДЕН
2025-05-11 21:05:15,842 - server-audit - INFO - Выполнение команды для критерия 550 (5.5. Ensure SSH PermitRootLogin is disabled): grep -i "^PermitRootLogin" /etc/ssh/sshd_config | grep -i "no"
2025-05-11 21:05:15,950 - server-audit - INFO - Результат выполнения команды для критерия 550:
2025-05-11 21:05:15,950 - server-audit - INFO - STDOUT: === НАЧАЛО ВЫПОЛНЕНИЯ КОМАНДЫ ===
Команда: echo kali | sudo -S grep -i ^PermitRootLogin /etc/ssh/sshd_config | grep -i no
=== РЕЗУЛЬТАТ ВЫПОЛНЕНИЯ ===
Команда завершилась с ошибкой: 1
=== КОНЕЦ ВЫПОЛНЕНИЯ ===

2025-05-11 21:05:15,950 - server-audit - INFO - STDERR: /tmp/scan_cmd.sh: line 6: nEOFnchmod: command not found

2025-05-11 21:05:15,950 - server-audit - INFO - Сравниваем с ожидаемым результатом: 'PermitRootLogin no'
2025-05-11 21:05:15,950 - server-audit - INFO - Критерий 550 НЕ ПРОЙДЕН
2025-05-11 21:05:15,951 - server-audit - INFO - Выполнение команды для критерия 552 (5.5.2 Ensure SSH Protocol is set to 2): grep -i "^Protocol" /etc/ssh/sshd_config
2025-05-11 21:05:16,058 - server-audit - INFO - Результат выполнения команды для критерия 552:
2025-05-11 21:05:16,059 - server-audit - INFO - STDOUT: === НАЧАЛО ВЫПОЛНЕНИЯ КОМАНДЫ ===
Команда: echo kali | sudo -S grep -i ^Protocol /etc/ssh/sshd_config
=== РЕЗУЛЬТАТ ВЫПОЛНЕНИЯ ===
Команда завершилась с ошибкой: 1
=== КОНЕЦ ВЫПОЛНЕНИЯ ===

2025-05-11 21:05:16,059 - server-audit - INFO - STDERR: /tmp/scan_cmd.sh: line 6: nEOFnchmod: command not found

2025-05-11 21:05:16,059 - server-audit - INFO - Сравниваем с ожидаемым результатом: 'Protocol 2'
2025-05-11 21:05:16,059 - server-audit - INFO - Критерий 552 НЕ ПРОЙДЕН
2025-05-11 21:05:16,059 - server-audit - INFO - Выполнение команды для критерия 560 (5.6. Ensure SSH PermitEmptyPasswords is disabled): grep -i "^PermitEmptyPasswords" /etc/ssh/sshd_config | grep -i "no" && echo 'Correctly configured' || echo 'Not properly configured'
2025-05-11 21:05:16,163 - server-audit - INFO - Результат выполнения команды для критерия 560:
2025-05-11 21:05:16,164 - server-audit - INFO - STDOUT: === НАЧАЛО ВЫПОЛНЕНИЯ КОМАНДЫ ===
Команда: echo kali | sudo -S grep -i ^PermitEmptyPasswords /etc/ssh/sshd_config | grep -i no && echo 'Correctly configured' || echo 'Not properly configured'
=== РЕЗУЛЬТАТ ВЫПОЛНЕНИЯ ===
Not properly configured
=== КОНЕЦ ВЫПОЛНЕНИЯ ===

2025-05-11 21:05:16,164 - server-audit - INFO - STDERR: /tmp/scan_cmd.sh: line 6: nEOFnchmod: command not found

2025-05-11 21:05:16,164 - server-audit - INFO - Сравниваем с ожидаемым результатом: 'Correctly configured'
2025-05-11 21:05:16,164 - server-audit - INFO - Критерий 560 ПРОЙДЕН
2025-05-11 21:05:16,164 - server-audit - INFO - Выполнение команды для критерия 570 (5.7. Ensure SSH X11 forwarding is disabled): grep -i "^X11Forwarding" /etc/ssh/sshd_config | grep -i "no" && echo 'X11 forwarding disabled' || echo 'X11 forwarding not disabled'
2025-05-11 21:05:16,278 - server-audit - INFO - Результат выполнения команды для критерия 570:
2025-05-11 21:05:16,279 - server-audit - INFO - STDOUT: === НАЧАЛО ВЫПОЛНЕНИЯ КОМАНДЫ ===
Команда: echo kali | sudo -S grep -i ^X11Forwarding /etc/ssh/sshd_config | grep -i no && echo 'X11 forwarding disabled' || echo 'X11 forwarding not disabled'
=== РЕЗУЛЬТАТ ВЫПОЛНЕНИЯ ===
X11 forwarding not disabled
=== КОНЕЦ ВЫПОЛНЕНИЯ ===

2025-05-11 21:05:16,279 - server-audit - INFO - STDERR: /tmp/scan_cmd.sh: line 6: nEOFnchmod: command not found

2025-05-11 21:05:16,279 - server-audit - INFO - Сравниваем с ожидаемым результатом: 'X11 forwarding disabled'
2025-05-11 21:05:16,279 - server-audit - INFO - Критерий 570 ПРОЙДЕН
2025-05-11 21:05:16,279 - server-audit - INFO - Выполнение команды для критерия 610 (6.1. Ensure wireless interfaces are disabled): rfkill list
2025-05-11 21:05:16,386 - server-audit - INFO - Результат выполнения команды для критерия 610:
2025-05-11 21:05:16,386 - server-audit - INFO - STDOUT: === НАЧАЛО ВЫПОЛНЕНИЯ КОМАНДЫ ===
Команда: echo kali | sudo -S rfkill list
=== РЕЗУЛЬТАТ ВЫПОЛНЕНИЯ ===
sudo: rfkill: command not found
Команда завершилась с ошибкой: 1
=== КОНЕЦ ВЫПОЛНЕНИЯ ===

2025-05-11 21:05:16,387 - server-audit - INFO - STDERR: /tmp/scan_cmd.sh: line 6: nEOFnchmod: command not found

2025-05-11 21:05:16,387 - server-audit - INFO - Сравниваем с ожидаемым результатом: 'Soft blocked: yes'
2025-05-11 21:05:16,387 - server-audit - INFO - Критерий 610 НЕ ПРОЙДЕН
2025-05-11 21:05:16,387 - server-audit - INFO - Выполнение команды для критерия 615 (6.15. Ensure IPv6 is disabled if not in use): sysctl net.ipv6.conf.all.disable_ipv6
2025-05-11 21:05:16,498 - server-audit - INFO - Результат выполнения команды для критерия 615:
2025-05-11 21:05:16,499 - server-audit - INFO - STDOUT: === НАЧАЛО ВЫПОЛНЕНИЯ КОМАНДЫ ===
Команда: echo kali | sudo -S sysctl net.ipv6.conf.all.disable_ipv6
=== РЕЗУЛЬТАТ ВЫПОЛНЕНИЯ ===
net.ipv6.conf.all.disable_ipv6 = 0
=== КОНЕЦ ВЫПОЛНЕНИЯ ===

2025-05-11 21:05:16,499 - server-audit - INFO - STDERR: /tmp/scan_cmd.sh: line 6: nEOFnchmod: command not found

2025-05-11 21:05:16,499 - server-audit - INFO - Сравниваем с ожидаемым результатом: '1'
2025-05-11 21:05:16,499 - server-audit - INFO - Критерий 615 НЕ ПРОЙДЕН
2025-05-11 21:05:16,499 - server-audit - INFO - Выполнение команды для критерия 620 (6.2. Ensure no unconfined daemons exist): ps -eZ | grep -v "^\w\{1,\}-[\w\{1,\}_]\{1,\} " | grep -v "^system_u:system_r:initrc_t:s0 " | grep -v "^unconfined_u:unconfined_r:unconfined_t:s0 " | grep -v "^unconfined_u:unconfined_r:unconfined_t:s0-s0:c0.c1023 " | tr -s " " | cut -d " " -f2 | sort -u || echo "No unconfined daemons"
2025-05-11 21:05:16,614 - server-audit - INFO - Результат выполнения команды для критерия 620:
2025-05-11 21:05:16,615 - server-audit - INFO - STDOUT: === НАЧАЛО ВЫПОЛНЕНИЯ КОМАНДЫ ===
Команда: echo kali | sudo -S ps -eZ | grep -v ^w{1,}-[w{1,}_]{1,}  | grep -v ^system_u:system_r:initrc_t:s0  | grep -v ^unconfined_u:unconfined_r:unconfined_t:s0  | grep -v ^unconfined_u:unconfined_r:unconfined_t:s0-s0:c0.c1023  | tr -s   | cut -d   -f2 | sort -u || echo No unconfined daemons
=== РЕЗУЛЬТАТ ВЫПОЛНЕНИЯ ===
1
100
101
1016
103
109
119
12
1221
1224
13
137614
137697
137699
137700
137718
137743
137754
137839
137847
137923
137925
137926
137927
138978
139137
139138
139169
139249
139256
14
144
149
149445
149570
149571
149572
149573
15
153777
153846
153853
156612
16
163934
163935
164431
164452
164453
164454
17
170928
170976
174
174793
18
180
181
18313
184108
19
19293
195603
197340
198152
198215
198220
198442
2
20
201037
201371
203347
203633
204301
204492
205919
206
207987
208284
208952
209
21
210
210443
210667
211
211110
211875
212
212484
212736
212872
213
213199
213550
213551
214
214076
214107
214141
214298
214572
214574
214771
214818
214827
214890
214898
215
215057
215090
215180
215189
215190
215191
215452
215453
215455
215456
215457
215458
215459
215460
215461
215462
215463
216
217
2199
22
2208
2231
225
2257
23
2357
238
24
263
27
28
29
2952
2959
3
30
302
303
32
33
33641
33647
33662
33665
33670
33671
33681
33688
33690
33737
33853
34
34168
34171
34172
34173
35
3574
3585
3588
3593
3598
36
3684
374
38
3864
398
399
4
4166
422
43
44
45
4534
4602
4617
466
47
48
4850
4866
487
5
50
5080
51
52
54
55
56
563
564
57
58
582
59
6
60
61
616
62
63
64
65
65180
65184
652
65291
66
67
68
69
7
70
71
716
72
73
74
75
76
77
78
79
80
80698
80708
80991
81
82
827
83
85
87
88
89
9
912
920
921
926
934
937
938
96
973
982
99
(enforce)
PID
=== КОНЕЦ ВЫПОЛНЕНИЯ ===

2025-05-11 21:05:16,615 - server-audit - INFO - STDERR: /tmp/scan_cmd.sh: line 6: nEOFnchmod: command not found

2025-05-11 21:05:16,615 - server-audit - INFO - Сравниваем с ожидаемым результатом: 'No unconfined daemons'
2025-05-11 21:05:16,615 - server-audit - INFO - Критерий 620 ПРОЙДЕН
2025-05-11 21:05:16,615 - server-audit - INFO - Выполнение команды для критерия 630 (6.30. Ensure firewall is enabled): ufw status | grep -E "Status:\s*active" || iptables -L -n | grep -q "REJECT\|DROP" && echo "Firewall active"
2025-05-11 21:05:16,755 - server-audit - INFO - Результат выполнения команды для критерия 630:
2025-05-11 21:05:16,755 - server-audit - INFO - STDOUT: === НАЧАЛО ВЫПОЛНЕНИЯ КОМАНДЫ ===
Команда: echo kali | sudo -S ufw status | grep -E Status:s*active || iptables -L -n | grep -q REJECT|DROP && echo Firewall active
=== РЕЗУЛЬТАТ ВЫПОЛНЕНИЯ ===
Команда завершилась с ошибкой: 1
=== КОНЕЦ ВЫПОЛНЕНИЯ ===

2025-05-11 21:05:16,755 - server-audit - INFO - STDERR: iptables v1.8.10 (nf_tables): Could not fetch rule set generation id: Permission denied (you must be root)
/tmp/scan_cmd.sh: line 6: nEOFnchmod: command not found

2025-05-11 21:05:16,756 - server-audit - INFO - Сравниваем с ожидаемым результатом: 'Firewall active'
2025-05-11 21:05:16,756 - server-audit - INFO - Критерий 630 ПРОЙДЕН
2025-05-11 21:05:16,756 - server-audit - INFO - Выполнение команды для критерия 640 (6.4. Ensure outbound connections are restricted): iptables -L OUTPUT -v -n | grep -q 'REJECT\|DROP' && echo 'Outbound filtering active' || echo 'No outbound filtering'
2025-05-11 21:05:16,857 - server-audit - INFO - Результат выполнения команды для критерия 640:
2025-05-11 21:05:16,857 - server-audit - INFO - STDOUT: === НАЧАЛО ВЫПОЛНЕНИЯ КОМАНДЫ ===
Команда: echo kali | sudo -S iptables -L OUTPUT -v -n | grep -q 'REJECT\|DROP' && echo 'Outbound filtering active' || echo 'No outbound filtering'
=== РЕЗУЛЬТАТ ВЫПОЛНЕНИЯ ===
No outbound filtering
=== КОНЕЦ ВЫПОЛНЕНИЯ ===

2025-05-11 21:05:16,858 - server-audit - INFO - STDERR: /tmp/scan_cmd.sh: line 6: nEOFnchmod: command not found

2025-05-11 21:05:16,858 - server-audit - INFO - Сравниваем с ожидаемым результатом: 'Outbound filtering active'
2025-05-11 21:05:16,858 - server-audit - INFO - Критерий 640 ПРОЙДЕН
2025-05-11 21:05:16,858 - server-audit - INFO - Выполнение команды для критерия 650 (6.5. Ensure wireless network interfaces are disabled): ip link | grep -i 'state UP' | grep -i wireless || echo 'No active wireless interfaces'
2025-05-11 21:05:16,965 - server-audit - INFO - Результат выполнения команды для критерия 650:
2025-05-11 21:05:16,966 - server-audit - INFO - STDOUT: === НАЧАЛО ВЫПОЛНЕНИЯ КОМАНДЫ ===
Команда: echo kali | sudo -S ip link | grep -i 'state UP' | grep -i wireless || echo 'No active wireless interfaces'
=== РЕЗУЛЬТАТ ВЫПОЛНЕНИЯ ===
No active wireless interfaces
=== КОНЕЦ ВЫПОЛНЕНИЯ ===

2025-05-11 21:05:16,966 - server-audit - INFO - STDERR: /tmp/scan_cmd.sh: line 6: nEOFnchmod: command not found

2025-05-11 21:05:16,966 - server-audit - INFO - Сравниваем с ожидаемым результатом: 'No active wireless interfaces'
2025-05-11 21:05:16,966 - server-audit - INFO - Критерий 650 ПРОЙДЕН
2025-05-11 21:05:16,966 - server-audit - INFO - Выполнение команды для критерия 710 (7.1. Ensure audit is enabled): systemctl is-active auditd
2025-05-11 21:05:17,078 - server-audit - INFO - Результат выполнения команды для критерия 710:
2025-05-11 21:05:17,078 - server-audit - INFO - STDOUT: === НАЧАЛО ВЫПОЛНЕНИЯ КОМАНДЫ ===
Команда: echo kali | sudo -S systemctl is-active auditd
=== РЕЗУЛЬТАТ ВЫПОЛНЕНИЯ ===
inactive
Команда завершилась с ошибкой: 4
=== КОНЕЦ ВЫПОЛНЕНИЯ ===

2025-05-11 21:05:17,079 - server-audit - INFO - STDERR: /tmp/scan_cmd.sh: line 6: nEOFnchmod: command not found

2025-05-11 21:05:17,079 - server-audit - INFO - Сравниваем с ожидаемым результатом: 'active'
2025-05-11 21:05:17,079 - server-audit - INFO - Критерий 710 ПРОЙДЕН
2025-05-11 21:05:17,079 - server-audit - INFO - Выполнение команды для критерия 720 (7.2. Ensure auditd service is enabled): systemctl is-enabled auditd && echo 'Enabled' || echo 'Not enabled'
2025-05-11 21:05:17,187 - server-audit - INFO - Результат выполнения команды для критерия 720:
2025-05-11 21:05:17,188 - server-audit - INFO - STDOUT: === НАЧАЛО ВЫПОЛНЕНИЯ КОМАНДЫ ===
Команда: echo kali | sudo -S systemctl is-enabled auditd && echo 'Enabled' || echo 'Not enabled'
=== РЕЗУЛЬТАТ ВЫПОЛНЕНИЯ ===
not-found
Not enabled
=== КОНЕЦ ВЫПОЛНЕНИЯ ===

2025-05-11 21:05:17,188 - server-audit - INFO - STDERR: /tmp/scan_cmd.sh: line 6: nEOFnchmod: command not found

2025-05-11 21:05:17,188 - server-audit - INFO - Сравниваем с ожидаемым результатом: 'Enabled'
2025-05-11 21:05:17,188 - server-audit - INFO - Критерий 720 ПРОЙДЕН
2025-05-11 21:05:17,188 - server-audit - INFO - Выполнение команды для критерия 730 (7.3. Ensure rsyslog or syslog-ng is installed): dpkg -s rsyslog || dpkg -s syslog-ng || echo "No syslog service installed"
2025-05-11 21:05:17,303 - server-audit - INFO - Результат выполнения команды для критерия 730:
2025-05-11 21:05:17,304 - server-audit - INFO - STDOUT: === НАЧАЛО ВЫПОЛНЕНИЯ КОМАНДЫ ===
Команда: echo kali | sudo -S dpkg -s rsyslog || dpkg -s syslog-ng || echo No syslog service installed
=== РЕЗУЛЬТАТ ВЫПОЛНЕНИЯ ===
Package: rsyslog
Status: install ok installed
Priority: optional
Section: admin
Installed-Size: 1775
Maintainer: Ubuntu Developers <ubuntu-devel-discuss@lists.ubuntu.com>
Architecture: amd64
Version: 8.2312.0-3ubuntu9.1
Provides: linux-kernel-log-daemon, system-log-daemon
Depends: libc6 (>= 2.38), libestr0 (>= 0.1.9), libfastjson4 (>= 0.99.8), libsystemd0 (>= 246), libuuid1 (>= 2.16), libzstd1 (>= 1.5.5), zlib1g (>= 1:1.1.4), adduser, ucf
Recommends: logrotate
Suggests: rsyslog-mysql | rsyslog-pgsql, rsyslog-mongodb, rsyslog-doc, rsyslog-openssl | rsyslog-gnutls, rsyslog-gssapi, rsyslog-relp, apparmor (>= 2.8.96~2541-0ubuntu4~)
Conflicts: linux-kernel-log-daemon, system-log-daemon
Conffiles:
 /etc/apparmor.d/rsyslog.d/README 85ad3bd22e3539dff283a25c3c4e118e
 /etc/apparmor.d/usr.sbin.rsyslogd ecb568ee9b5dcc6c74053465d88b8516
 /etc/logcheck/ignore.d.server/rsyslog 58c2337cacd6a3296c2c9728fc3e52fd
 /etc/logrotate.d/rsyslog 3f26282ac0106961634fe4efb9edc3f4
 /etc/rsyslog.conf a14b59f17abdcfda417f99a99c030e67
Description: reliable system and kernel logging daemon
 Rsyslog is a multi-threaded implementation of syslogd (a system utility
 providing support for message logging), with features that include:
  * reliable syslog over TCP, SSL/TLS and RELP
  * on-demand disk buffering
  * email alerting
  * writing to MySQL or PostgreSQL databases (via separate output plugins)
  * permitted sender lists
  * filtering on any part of the syslog message
  * on-the-wire message compression
  * fine-grained output format control
  * failover to backup destinations
  * enterprise-class encrypted syslog relaying
 .
 It is the default syslogd on Debian systems.
Homepage: https://www.rsyslog.com/
Original-Maintainer: Michael Biebl <biebl@debian.org>
=== КОНЕЦ ВЫПОЛНЕНИЯ ===

2025-05-11 21:05:17,304 - server-audit - INFO - STDERR: /tmp/scan_cmd.sh: line 6: nEOFnchmod: command not found

2025-05-11 21:05:17,304 - server-audit - INFO - Сравниваем с ожидаемым результатом: 'Status: install ok installed'
2025-05-11 21:05:17,304 - server-audit - INFO - Критерий 730 ПРОЙДЕН
2025-05-11 21:05:17,304 - server-audit - INFO - Выполнение команды для критерия 740 (7.4. Ensure logrotate is configured): grep -r "^rotate" /etc/logrotate.d/ /etc/logrotate.conf | grep -v "^#" && echo 'Logrotate configured' || echo 'Logrotate not configured'
2025-05-11 21:05:17,414 - server-audit - INFO - Результат выполнения команды для критерия 740:
2025-05-11 21:05:17,414 - server-audit - INFO - STDOUT: === НАЧАЛО ВЫПОЛНЕНИЯ КОМАНДЫ ===
Команда: echo kali | sudo -S grep -r ^rotate /etc/logrotate.d/ /etc/logrotate.conf | grep -v ^# && echo 'Logrotate configured' || echo 'Logrotate not configured'
=== РЕЗУЛЬТАТ ВЫПОЛНЕНИЯ ===
/etc/logrotate.conf:rotate 4
Logrotate configured
=== КОНЕЦ ВЫПОЛНЕНИЯ ===

2025-05-11 21:05:17,414 - server-audit - INFO - STDERR: /tmp/scan_cmd.sh: line 6: nEOFnchmod: command not found

2025-05-11 21:05:17,414 - server-audit - INFO - Сравниваем с ожидаемым результатом: 'Logrotate configured'
2025-05-11 21:05:17,415 - server-audit - INFO - Критерий 740 ПРОЙДЕН
2025-05-11 21:05:17,415 - server-audit - INFO - Выполнение команды для критерия 750 (7.5. Ensure remote syslog is configured): grep -E '^[^#].*@.*' /etc/rsyslog.conf /etc/rsyslog.d/*.conf && echo 'Remote logging configured' || echo 'Remote logging not configured'
2025-05-11 21:05:17,522 - server-audit - INFO - Результат выполнения команды для критерия 750:
2025-05-11 21:05:17,522 - server-audit - INFO - STDOUT: === НАЧАЛО ВЫПОЛНЕНИЯ КОМАНДЫ ===
Команда: echo kali | sudo -S grep -E '^[^#].*@.*' /etc/rsyslog.conf /etc/rsyslog.d/*.conf && echo 'Remote logging configured' || echo 'Remote logging not configured'
=== РЕЗУЛЬТАТ ВЫПОЛНЕНИЯ ===
Remote logging not configured
=== КОНЕЦ ВЫПОЛНЕНИЯ ===

2025-05-11 21:05:17,522 - server-audit - INFO - STDERR: /tmp/scan_cmd.sh: line 6: nEOFnchmod: command not found

2025-05-11 21:05:17,523 - server-audit - INFO - Сравниваем с ожидаемым результатом: 'Remote logging configured'
2025-05-11 21:05:17,523 - server-audit - INFO - Критерий 750 ПРОЙДЕН
2025-05-11 21:05:17,523 - server-audit - INFO - Выполнение команды для критерия 810 (8.1. Ensure password expiration is 90 days or less): grep PASS_MAX_DAYS /etc/login.defs
2025-05-11 21:05:17,632 - server-audit - INFO - Результат выполнения команды для критерия 810:
2025-05-11 21:05:17,632 - server-audit - INFO - STDOUT: === НАЧАЛО ВЫПОЛНЕНИЯ КОМАНДЫ ===
Команда: echo kali | sudo -S grep PASS_MAX_DAYS /etc/login.defs
=== РЕЗУЛЬТАТ ВЫПОЛНЕНИЯ ===
#	PASS_MAX_DAYS	Maximum number of days a password may be used.
PASS_MAX_DAYS	99999
=== КОНЕЦ ВЫПОЛНЕНИЯ ===

2025-05-11 21:05:17,632 - server-audit - INFO - STDERR: /tmp/scan_cmd.sh: line 6: nEOFnchmod: command not found

2025-05-11 21:05:17,632 - server-audit - INFO - Сравниваем с ожидаемым результатом: '90'
2025-05-11 21:05:17,633 - server-audit - INFO - Критерий 810 НЕ ПРОЙДЕН
2025-05-11 21:05:17,633 - server-audit - INFO - Выполнение команды для критерия 820 (8.2. Ensure all users have a valid password hash): cat /etc/shadow | awk -F: '($2 == "" ) { print $1 " has no password" ; exit 1 }' || echo "No empty passwords"
2025-05-11 21:05:17,743 - server-audit - INFO - Результат выполнения команды для критерия 820:
2025-05-11 21:05:17,743 - server-audit - INFO - STDOUT: === НАЧАЛО ВЫПОЛНЕНИЯ КОМАНДЫ ===
Команда: echo kali | sudo -S cat /etc/shadow | awk -F: '( ==  ) { print   has no password ; exit 1 }' || echo No empty passwords
=== РЕЗУЛЬТАТ ВЫПОЛНЕНИЯ ===
=== КОНЕЦ ВЫПОЛНЕНИЯ ===

2025-05-11 21:05:17,743 - server-audit - INFO - STDERR: /tmp/scan_cmd.sh: line 6: nEOFnchmod: command not found

2025-05-11 21:05:17,743 - server-audit - INFO - Сравниваем с ожидаемым результатом: 'No empty passwords'
2025-05-11 21:05:17,743 - server-audit - INFO - Критерий 820 ПРОЙДЕН
2025-05-11 21:05:17,743 - server-audit - INFO - Выполнение команды для критерия 830 (8.3. Ensure minimum days between password changes is 7 or more): grep -E '^PASS_MIN_DAYS\s+[7-9]|^PASS_MIN_DAYS\s+[1-9][0-9]+' /etc/login.defs && echo 'Correctly configured' || echo 'Not properly configured'
2025-05-11 21:05:17,849 - server-audit - INFO - Результат выполнения команды для критерия 830:
2025-05-11 21:05:17,849 - server-audit - INFO - STDOUT: === НАЧАЛО ВЫПОЛНЕНИЯ КОМАНДЫ ===
Команда: echo kali | sudo -S grep -E '^PASS_MIN_DAYS\s+[7-9]|^PASS_MIN_DAYS\s+[1-9][0-9]+' /etc/login.defs && echo 'Correctly configured' || echo 'Not properly configured'
=== РЕЗУЛЬТАТ ВЫПОЛНЕНИЯ ===
Not properly configured
=== КОНЕЦ ВЫПОЛНЕНИЯ ===

2025-05-11 21:05:17,849 - server-audit - INFO - STDERR: /tmp/scan_cmd.sh: line 6: nEOFnchmod: command not found

2025-05-11 21:05:17,849 - server-audit - INFO - Сравниваем с ожидаемым результатом: 'Correctly configured'
2025-05-11 21:05:17,849 - server-audit - INFO - Критерий 830 ПРОЙДЕН
2025-05-11 21:05:17,849 - server-audit - INFO - Выполнение команды для критерия 840 (8.4. Ensure password hashing algorithm is SHA-512): grep -E '^password\s+[^\s]+\s+pam_unix.so\s+.*sha512' /etc/pam.d/common-password && echo 'SHA-512 enabled' || echo 'SHA-512 not enabled'
2025-05-11 21:05:17,954 - server-audit - INFO - Результат выполнения команды для критерия 840:
2025-05-11 21:05:17,954 - server-audit - INFO - STDOUT: === НАЧАЛО ВЫПОЛНЕНИЯ КОМАНДЫ ===
Команда: echo kali | sudo -S grep -E '^password\s+[^\s]+\s+pam_unix.so\s+.*sha512' /etc/pam.d/common-password && echo 'SHA-512 enabled' || echo 'SHA-512 not enabled'
=== РЕЗУЛЬТАТ ВЫПОЛНЕНИЯ ===
SHA-512 not enabled
=== КОНЕЦ ВЫПОЛНЕНИЯ ===

2025-05-11 21:05:17,955 - server-audit - INFO - STDERR: /tmp/scan_cmd.sh: line 6: nEOFnchmod: command not found

2025-05-11 21:05:17,955 - server-audit - INFO - Сравниваем с ожидаемым результатом: 'SHA-512 enabled'
2025-05-11 21:05:17,955 - server-audit - INFO - Критерий 840 ПРОЙДЕН
2025-05-11 21:05:17,955 - server-audit - INFO - Выполнение команды для критерия 910 (9.1. Ensure SSH warning banner is configured): grep Banner /etc/ssh/sshd_config
2025-05-11 21:05:18,055 - server-audit - INFO - Результат выполнения команды для критерия 910:
2025-05-11 21:05:18,055 - server-audit - INFO - STDOUT: === НАЧАЛО ВЫПОЛНЕНИЯ КОМАНДЫ ===
Команда: echo kali | sudo -S grep Banner /etc/ssh/sshd_config
=== РЕЗУЛЬТАТ ВЫПОЛНЕНИЯ ===
#Banner none
=== КОНЕЦ ВЫПОЛНЕНИЯ ===

2025-05-11 21:05:18,055 - server-audit - INFO - STDERR: /tmp/scan_cmd.sh: line 6: nEOFnchmod: command not found

2025-05-11 21:05:18,055 - server-audit - INFO - Сравниваем с ожидаемым результатом: '/etc/issue.net'
2025-05-11 21:05:18,055 - server-audit - INFO - Критерий 910 НЕ ПРОЙДЕН
2025-05-11 21:05:18,055 - server-audit - INFO - Выполнение команды для критерия 920 (9.2. Ensure /etc/issue contains appropriate warning): grep -E 'Authorized users only|authorized use only|unauthorized access prohibited' /etc/issue && echo 'Warning exists' || echo 'No appropriate warning'
2025-05-11 21:05:18,159 - server-audit - INFO - Результат выполнения команды для критерия 920:
2025-05-11 21:05:18,160 - server-audit - INFO - STDOUT: === НАЧАЛО ВЫПОЛНЕНИЯ КОМАНДЫ ===
Команда: echo kali | sudo -S grep -E 'Authorized users only|authorized use only|unauthorized access prohibited' /etc/issue && echo 'Warning exists' || echo 'No appropriate warning'
=== РЕЗУЛЬТАТ ВЫПОЛНЕНИЯ ===
No appropriate warning
=== КОНЕЦ ВЫПОЛНЕНИЯ ===

2025-05-11 21:05:18,160 - server-audit - INFO - STDERR: /tmp/scan_cmd.sh: line 6: nEOFnchmod: command not found

2025-05-11 21:05:18,160 - server-audit - INFO - Сравниваем с ожидаемым результатом: 'Warning exists'
2025-05-11 21:05:18,160 - server-audit - INFO - Критерий 920 ПРОЙДЕН
2025-05-11 21:05:18,160 - server-audit - INFO - Выполнение команды для критерия 930 (9.3. Ensure remote login warning banner is configured): grep -E 'Authorized users only|authorized use only|unauthorized access prohibited' /etc/issue.net && echo 'Warning exists' || echo 'No appropriate warning'
2025-05-11 21:05:18,270 - server-audit - INFO - Результат выполнения команды для критерия 930:
2025-05-11 21:05:18,270 - server-audit - INFO - STDOUT: === НАЧАЛО ВЫПОЛНЕНИЯ КОМАНДЫ ===
Команда: echo kali | sudo -S grep -E 'Authorized users only|authorized use only|unauthorized access prohibited' /etc/issue.net && echo 'Warning exists' || echo 'No appropriate warning'
=== РЕЗУЛЬТАТ ВЫПОЛНЕНИЯ ===
No appropriate warning
=== КОНЕЦ ВЫПОЛНЕНИЯ ===

2025-05-11 21:05:18,271 - server-audit - INFO - STDERR: /tmp/scan_cmd.sh: line 6: nEOFnchmod: command not found

2025-05-11 21:05:18,271 - server-audit - INFO - Сравниваем с ожидаемым результатом: 'Warning exists'
2025-05-11 21:05:18,271 - server-audit - INFO - Критерий 930 ПРОЙДЕН
2025-05-11 21:05:18,271 - server-audit - INFO - Выполнение команды для критерия 1010 (10.1. Ensure permissions on /etc/passwd are configured): stat -c "%a %u %g" /etc/passwd
2025-05-11 21:05:18,381 - server-audit - INFO - Результат выполнения команды для критерия 1010:
2025-05-11 21:05:18,381 - server-audit - INFO - STDOUT: === НАЧАЛО ВЫПОЛНЕНИЯ КОМАНДЫ ===
Команда: echo kali | sudo -S stat -c %a %u %g /etc/passwd
=== РЕЗУЛЬТАТ ВЫПОЛНЕНИЯ ===
644 0 0
=== КОНЕЦ ВЫПОЛНЕНИЯ ===

2025-05-11 21:05:18,381 - server-audit - INFO - STDERR: /tmp/scan_cmd.sh: line 6: nEOFnchmod: command not found

2025-05-11 21:05:18,381 - server-audit - INFO - Сравниваем с ожидаемым результатом: '644 0 0'
2025-05-11 21:05:18,381 - server-audit - INFO - Критерий 1010 ПРОЙДЕН
2025-05-11 21:05:18,381 - server-audit - INFO - Выполнение команды для критерия 1020 (10.2. Ensure permissions on /etc/shadow are configured): stat -c "%a %u %g" /etc/shadow
2025-05-11 21:05:18,491 - server-audit - INFO - Результат выполнения команды для критерия 1020:
2025-05-11 21:05:18,491 - server-audit - INFO - STDOUT: === НАЧАЛО ВЫПОЛНЕНИЯ КОМАНДЫ ===
Команда: echo kali | sudo -S stat -c %a %u %g /etc/shadow
=== РЕЗУЛЬТАТ ВЫПОЛНЕНИЯ ===
640 0 42
=== КОНЕЦ ВЫПОЛНЕНИЯ ===

2025-05-11 21:05:18,491 - server-audit - INFO - STDERR: /tmp/scan_cmd.sh: line 6: nEOFnchmod: command not found

2025-05-11 21:05:18,492 - server-audit - INFO - Сравниваем с ожидаемым результатом: '640 0 42'
2025-05-11 21:05:18,492 - server-audit - INFO - Критерий 1020 ПРОЙДЕН
2025-05-11 21:05:18,492 - server-audit - INFO - Выполнение команды для критерия 1030 (10.3. Ensure permissions on /etc/group are configured): stat -c "%a %u %g" /etc/group | grep -q '644 0 0' && echo 'Permissions correct' || echo 'Permissions incorrect'
2025-05-11 21:05:18,598 - server-audit - INFO - Результат выполнения команды для критерия 1030:
2025-05-11 21:05:18,598 - server-audit - INFO - STDOUT: === НАЧАЛО ВЫПОЛНЕНИЯ КОМАНДЫ ===
Команда: echo kali | sudo -S stat -c %a %u %g /etc/group | grep -q '644 0 0' && echo 'Permissions correct' || echo 'Permissions incorrect'
=== РЕЗУЛЬТАТ ВЫПОЛНЕНИЯ ===
Permissions correct
=== КОНЕЦ ВЫПОЛНЕНИЯ ===

2025-05-11 21:05:18,598 - server-audit - INFO - STDERR: /tmp/scan_cmd.sh: line 6: nEOFnchmod: command not found

2025-05-11 21:05:18,598 - server-audit - INFO - Сравниваем с ожидаемым результатом: 'Permissions correct'
2025-05-11 21:05:18,598 - server-audit - INFO - Критерий 1030 ПРОЙДЕН
2025-05-11 21:05:18,599 - server-audit - INFO - Выполнение команды для критерия 1040 (10.4. Ensure permissions on /etc/gshadow are configured): stat -c "%a %u %g" /etc/gshadow | grep -q '640 0 42' && echo 'Permissions correct' || echo 'Permissions incorrect'
2025-05-11 21:05:18,704 - server-audit - INFO - Результат выполнения команды для критерия 1040:
2025-05-11 21:05:18,704 - server-audit - INFO - STDOUT: === НАЧАЛО ВЫПОЛНЕНИЯ КОМАНДЫ ===
Команда: echo kali | sudo -S stat -c %a %u %g /etc/gshadow | grep -q '640 0 42' && echo 'Permissions correct' || echo 'Permissions incorrect'
=== РЕЗУЛЬТАТ ВЫПОЛНЕНИЯ ===
Permissions correct
=== КОНЕЦ ВЫПОЛНЕНИЯ ===

2025-05-11 21:05:18,704 - server-audit - INFO - STDERR: /tmp/scan_cmd.sh: line 6: nEOFnchmod: command not found

2025-05-11 21:05:18,704 - server-audit - INFO - Сравниваем с ожидаемым результатом: 'Permissions correct'
2025-05-11 21:05:18,705 - server-audit - INFO - Критерий 1040 ПРОЙДЕН
2025-05-11 21:05:18,705 - server-audit - INFO - Выполнение команды для критерия 1050 (10.5. Ensure no unauthorized world-writable directories exist): df --local -P | awk {'if (NR!=1) print $6'} | xargs -I '{}' find '{}' -xdev -type d -perm -0002 -not -perm -1000 -print 2>/dev/null || echo 'No world-writable directories without sticky bit found'
2025-05-11 21:05:18,987 - server-audit - INFO - Результат выполнения команды для критерия 1050:
2025-05-11 21:05:18,987 - server-audit - INFO - STDOUT: === НАЧАЛО ВЫПОЛНЕНИЯ КОМАНДЫ ===
Команда: echo kali | sudo -S df --local -P | awk {'if (NR!=1) print '} | xargs -I '{}' find '{}' -xdev -type d -perm -0002 -not -perm -1000 -print 2>/dev/null || echo 'No world-writable directories without sticky bit found'
=== РЕЗУЛЬТАТ ВЫПОЛНЕНИЯ ===
No world-writable directories without sticky bit found
=== КОНЕЦ ВЫПОЛНЕНИЯ ===

2025-05-11 21:05:18,987 - server-audit - INFO - STDERR: /tmp/scan_cmd.sh: line 6: nEOFnchmod: command not found

2025-05-11 21:05:18,988 - server-audit - INFO - Сравниваем с ожидаемым результатом: 'No world-writable directories without sticky bit found'
2025-05-11 21:05:18,988 - server-audit - INFO - Критерий 1050 ПРОЙДЕН
2025-05-11 21:05:18,988 - server-audit - INFO - Выполнение команды для критерия 1110 (11.1. Ensure root PATH integrity): echo $PATH | grep -q "::" && echo "Empty Directory" || echo "1"
2025-05-11 21:05:19,091 - server-audit - INFO - Результат выполнения команды для критерия 1110:
2025-05-11 21:05:19,091 - server-audit - INFO - STDOUT: === НАЧАЛО ВЫПОЛНЕНИЯ КОМАНДЫ ===
Команда: echo kali | sudo -S echo /usr/local/sbin:/usr/local/bin:/usr/sbin:/usr/bin:/sbin:/bin:/usr/games:/usr/local/games:/snap/bin | grep -q :: && echo Empty Directory || echo 1
=== РЕЗУЛЬТАТ ВЫПОЛНЕНИЯ ===
1
=== КОНЕЦ ВЫПОЛНЕНИЯ ===

2025-05-11 21:05:19,092 - server-audit - INFO - STDERR: /tmp/scan_cmd.sh: line 6: nEOFnchmod: command not found

2025-05-11 21:05:19,092 - server-audit - INFO - Сравниваем с ожидаемым результатом: '1'
2025-05-11 21:05:19,092 - server-audit - INFO - Критерий 1110 ПРОЙДЕН
2025-05-11 21:05:19,092 - server-audit - INFO - Выполнение команды для критерия 1120 (11.2. Ensure no world-writable files exist): df --local -P | awk {'if (NR!=1) print $6'} | xargs -I '{}' find '{}' -xdev -type f -perm -0002 -print 2>/dev/null || echo 'No world-writable files found'
2025-05-11 21:05:19,480 - server-audit - INFO - Результат выполнения команды для критерия 1120:
2025-05-11 21:05:19,481 - server-audit - INFO - STDOUT: === НАЧАЛО ВЫПОЛНЕНИЯ КОМАНДЫ ===
Команда: echo kali | sudo -S df --local -P | awk {'if (NR!=1) print '} | xargs -I '{}' find '{}' -xdev -type f -perm -0002 -print 2>/dev/null || echo 'No world-writable files found'
=== РЕЗУЛЬТАТ ВЫПОЛНЕНИЯ ===
No world-writable files found
=== КОНЕЦ ВЫПОЛНЕНИЯ ===

2025-05-11 21:05:19,481 - server-audit - INFO - STDERR: /tmp/scan_cmd.sh: line 6: nEOFnchmod: command not found

2025-05-11 21:05:19,481 - server-audit - INFO - Сравниваем с ожидаемым результатом: 'No world-writable files found'
2025-05-11 21:05:19,481 - server-audit - INFO - Критерий 1120 ПРОЙДЕН
2025-05-11 21:05:19,482 - server-audit - INFO - Выполнение команды для критерия 1130 (11.3. Ensure no unowned files or directories exist): df --local -P | awk {'if (NR!=1) print $6'} | xargs -I '{}' find '{}' -xdev -nouser -ls 2>/dev/null || echo 'No unowned files found'
2025-05-11 21:05:20,350 - server-audit - INFO - Результат выполнения команды для критерия 1130:
2025-05-11 21:05:20,350 - server-audit - INFO - STDOUT: === НАЧАЛО ВЫПОЛНЕНИЯ КОМАНДЫ ===
Команда: echo kali | sudo -S df --local -P | awk {'if (NR!=1) print '} | xargs -I '{}' find '{}' -xdev -nouser -ls 2>/dev/null || echo 'No unowned files found'
=== РЕЗУЛЬТАТ ВЫПОЛНЕНИЯ ===
No unowned files found
=== КОНЕЦ ВЫПОЛНЕНИЯ ===

2025-05-11 21:05:20,351 - server-audit - INFO - STDERR: /tmp/scan_cmd.sh: line 6: nEOFnchmod: command not found

2025-05-11 21:05:20,351 - server-audit - INFO - Сравниваем с ожидаемым результатом: 'No unowned files found'
2025-05-11 21:05:20,351 - server-audit - INFO - Критерий 1130 ПРОЙДЕН
2025-05-11 21:05:20,351 - server-audit - INFO - Выполнение команды для критерия 1210 (12.1. Ensure no users have .forward files): find /home -name .forward
2025-05-11 21:05:20,517 - server-audit - INFO - Результат выполнения команды для критерия 1210:
2025-05-11 21:05:20,518 - server-audit - INFO - STDOUT: === НАЧАЛО ВЫПОЛНЕНИЯ КОМАНДЫ ===
Команда: echo kali | sudo -S find /home -name .forward
=== РЕЗУЛЬТАТ ВЫПОЛНЕНИЯ ===
=== КОНЕЦ ВЫПОЛНЕНИЯ ===

2025-05-11 21:05:20,518 - server-audit - INFO - STDERR: /tmp/scan_cmd.sh: line 6: nEOFnchmod: command not found

2025-05-11 21:05:20,518 - server-audit - INFO - Сравниваем с ожидаемым результатом: ''
2025-05-11 21:05:20,518 - server-audit - INFO - Критерий 1210 ПРОЙДЕН
2025-05-11 21:05:20,518 - server-audit - INFO - Выполнение команды для критерия 1220 (12.2. Ensure no users have .netrc files): find /home -name .netrc 2>/dev/null || echo 'No .netrc files found'
2025-05-11 21:05:20,681 - server-audit - INFO - Результат выполнения команды для критерия 1220:
2025-05-11 21:05:20,681 - server-audit - INFO - STDOUT: === НАЧАЛО ВЫПОЛНЕНИЯ КОМАНДЫ ===
Команда: echo kali | sudo -S find /home -name .netrc 2>/dev/null || echo 'No .netrc files found'
=== РЕЗУЛЬТАТ ВЫПОЛНЕНИЯ ===
=== КОНЕЦ ВЫПОЛНЕНИЯ ===

2025-05-11 21:05:20,681 - server-audit - INFO - STDERR: /tmp/scan_cmd.sh: line 6: nEOFnchmod: command not found

2025-05-11 21:05:20,681 - server-audit - INFO - Сравниваем с ожидаемым результатом: 'No .netrc files found'
2025-05-11 21:05:20,681 - server-audit - INFO - Критерий 1220 ПРОЙДЕН
2025-05-11 21:05:20,682 - server-audit - INFO - Выполнение команды для критерия 1230 (12.3. Ensure all user home directories have proper permissions): for dir in $(cut -d: -f6 /etc/passwd | grep -v '^/$'); do [ -d "$dir" ] && stat -L -c '%A' "$dir" | cut -c6-10 | grep -q '^-----$' && echo 'Permissions correct' || echo 'Permissions incorrect'; done
2025-05-11 21:05:20,781 - server-audit - INFO - Результат выполнения команды для критерия 1230:
2025-05-11 21:05:20,782 - server-audit - INFO - STDOUT: === НАЧАЛО ВЫПОЛНЕНИЯ КОМАНДЫ ===
Команда: echo kali | sudo -S for dir in /root
/usr/sbin
/bin
/dev
/bin
/usr/games
/var/cache/man
/var/spool/lpd
/var/mail
/var/spool/news
/var/spool/uucp
/bin
/var/www
/var/backups
/var/list
/run/ircd
/nonexistent
/nonexistent
/usr/lib/dhcpcd
/nonexistent
/var/cache/pollinate
/nonexistent
/run/uuidd
/nonexistent
/var/lib/tpm
/var/lib/landscape
/var/lib/fwupd
/var/lib/usbmux
/home/aidar
/var/lib/misc
/nonexistent
/nonexistent
/var/spool/postfix
/run/sshd
/home/ayan
/home/wazuh-indexer
/var/ossec
/nonexistent; do [ -d  ] && stat -L -c '%A'  | cut -c6-10 | grep -q '^-----$' && echo 'Permissions correct' || echo 'Permissions incorrect'; done
=== РЕЗУЛЬТАТ ВЫПОЛНЕНИЯ ===

2025-05-11 21:05:20,782 - server-audit - INFO - STDERR: /tmp/scan_cmd.sh: line 4: syntax error near unexpected token `do'
/tmp/scan_cmd.sh: line 4: `echo "kali" | sudo -S for dir in $(cut -d: -f6 /etc/passwd | grep -v '^/$'); do [ -d "$dir" ] && stat -L -c '%A' "$dir" | cut -c6-10 | grep -q '^-----$' && echo 'Permissions correct' || echo 'Permissions incorrect'; done 2>&1 || echo "Команда завершилась с ошибкой: $?"'

2025-05-11 21:05:20,782 - server-audit - INFO - Сравниваем с ожидаемым результатом: 'Permissions correct'
2025-05-11 21:05:20,782 - server-audit - INFO - Критерий 1230 ПРОЙДЕН
2025-05-11 21:05:20,782 - server-audit - INFO - Выполнение команды для критерия 1240 (12.4. Ensure default user umask is 027 or more restrictive): grep -E '^\s*umask\s+([0-7][0-7]27|[0-7]22)' /etc/profile /etc/bash.bashrc /etc/profile.d/*.sh && echo 'Umask properly configured' || echo 'Umask not configured'
2025-05-11 21:05:20,891 - server-audit - INFO - Результат выполнения команды для критерия 1240:
2025-05-11 21:05:20,892 - server-audit - INFO - STDOUT: === НАЧАЛО ВЫПОЛНЕНИЯ КОМАНДЫ ===
Команда: echo kali | sudo -S grep -E '^\s*umask\s+([0-7][0-7]27|[0-7]22)' /etc/profile /etc/bash.bashrc /etc/profile.d/*.sh && echo 'Umask properly configured' || echo 'Umask not configured'
=== РЕЗУЛЬТАТ ВЫПОЛНЕНИЯ ===
Umask not configured
=== КОНЕЦ ВЫПОЛНЕНИЯ ===

2025-05-11 21:05:20,892 - server-audit - INFO - STDERR: /tmp/scan_cmd.sh: line 6: nEOFnchmod: command not found

2025-05-11 21:05:20,892 - server-audit - INFO - Сравниваем с ожидаемым результатом: 'Umask properly configured'
2025-05-11 21:05:20,892 - server-audit - INFO - Критерий 1240 ПРОЙДЕН
2025-05-11 21:05:20,935 - server-audit - INFO - Временный файл sudoers удален
2025-05-11 21:05:20,936 - server-audit - INFO - Сканирование сервера 25.15.212.99 завершено. Закрываем SSH-соединение.
2025-05-11 21:15:44,000 - server-audit - INFO - Попытка входа с именем пользователя: admin
2025-05-11 21:15:44,004 - passlib.handlers.bcrypt - WARNING - (trapped) error reading bcrypt version
Traceback (most recent call last):
  File "/usr/local/lib/python3.10/site-packages/passlib/handlers/bcrypt.py", line 620, in _load_backend_mixin
    version = _bcrypt.__about__.__version__
AttributeError: module 'bcrypt' has no attribute '__about__'
2025-05-11 21:15:44,223 - server-audit - INFO - Успешный вход для пользователя: admin
2025-05-11 21:15:54,245 - server-audit - INFO - Начало сканирования сервера 25.15.212.99
2025-05-11 21:15:54,272 - server-audit - INFO - Подключение к серверу 25.15.212.99 по SSH с пользователем ayan
2025-05-11 21:15:54,272 - server-audit - INFO - Используется аутентификация по паролю
2025-05-11 21:15:54,277 - paramiko.transport - INFO - Connected (version 2.0, client OpenSSH_9.6p1)
2025-05-11 21:15:54,398 - paramiko.transport - INFO - Authentication (password) successful!
2025-05-11 21:15:54,398 - server-audit - INFO - Успешное подключение к 25.15.212.99. Начинаем выполнение проверок.
2025-05-11 21:15:54,399 - server-audit - INFO - Проверка работоспособности sudo...
2025-05-11 21:15:54,717 - server-audit - INFO - Тест без sudo: uid=1001(ayan) gid=1002(ayan) groups=1002(ayan),27(sudo),107(tcpdump),111(cockpit-ws),988(zeek)

2025-05-11 21:15:54,775 - server-audit - INFO - Тест с sudo -n: , ошибки: sudo: a password is required

2025-05-11 21:15:54,776 - server-audit - INFO - Sudo -n не работает, пробуем настроить временный sudo доступ
2025-05-11 21:15:54,849 - server-audit - INFO - Настройка временного sudo: [sudo] password for ayan: 
2025-05-11 21:15:54,906 - server-audit - WARNING - Не удалось настроить sudo без пароля, будем использовать обычный sudo
2025-05-11 21:15:54,906 - server-audit - INFO - Выполнение команды для критерия 110 (1.1. Ensure periodic security updates are configured): dpkg -l | grep unattended-upgrades
2025-05-11 21:15:54,991 - server-audit - INFO - Результат выполнения команды для критерия 110:
2025-05-11 21:15:54,992 - server-audit - INFO - STDOUT: === НАЧАЛО ВЫПОЛНЕНИЯ КОМАНДЫ ===
Команда: echo kali | sudo -S dpkg -l | grep unattended-upgrades
=== РЕЗУЛЬТАТ ВЫПОЛНЕНИЯ ===
ii  unattended-upgrades                  2.9.1+nmu4ubuntu1                       all          automatic installation of security upgrades
=== КОНЕЦ ВЫПОЛНЕНИЯ ===

2025-05-11 21:15:54,992 - server-audit - INFO - STDERR: /tmp/scan_cmd.sh: line 6: nEOFnchmod: command not found

2025-05-11 21:15:54,992 - server-audit - INFO - Сравниваем с ожидаемым результатом: 'unattended-upgrades'
2025-05-11 21:15:54,992 - server-audit - INFO - Критерий 110 ПРОЙДЕН
2025-05-11 21:15:54,992 - server-audit - INFO - Выполнение команды для критерия 120 (1.2. Ensure system packages are up to date): apt list --upgradable | grep -q 'upgradable' && echo 'Upgrades needed' || echo 'No upgrades needed'
2025-05-11 21:15:55,298 - server-audit - INFO - Результат выполнения команды для критерия 120:
2025-05-11 21:15:55,298 - server-audit - INFO - STDOUT: === НАЧАЛО ВЫПОЛНЕНИЯ КОМАНДЫ ===
Команда: echo kali | sudo -S apt list --upgradable | grep -q 'upgradable' && echo 'Upgrades needed' || echo 'No upgrades needed'
=== РЕЗУЛЬТАТ ВЫПОЛНЕНИЯ ===
No upgrades needed
=== КОНЕЦ ВЫПОЛНЕНИЯ ===

2025-05-11 21:15:55,299 - server-audit - INFO - STDERR: 
WARNING: apt does not have a stable CLI interface. Use with caution in scripts.

/tmp/scan_cmd.sh: line 6: nEOFnchmod: command not found

2025-05-11 21:15:55,299 - server-audit - INFO - Сравниваем с ожидаемым результатом: 'No upgrades needed'
2025-05-11 21:15:55,299 - server-audit - INFO - Критерий 120 ПРОЙДЕН
2025-05-11 21:15:55,299 - server-audit - INFO - Выполнение команды для критерия 130 (1.3. Ensure APT repositories use secure transports): grep -E '^deb\s+[^http:|file:]' /etc/apt/sources.list /etc/apt/sources.list.d/*.list 2>/dev/null || echo 'All transports secure'
2025-05-11 21:15:55,404 - server-audit - INFO - Результат выполнения команды для критерия 130:
2025-05-11 21:15:55,404 - server-audit - INFO - STDOUT: === НАЧАЛО ВЫПОЛНЕНИЯ КОМАНДЫ ===
Команда: echo kali | sudo -S grep -E '^deb\s+[^http:|file:]' /etc/apt/sources.list /etc/apt/sources.list.d/*.list 2>/dev/null || echo 'All transports secure'
=== РЕЗУЛЬТАТ ВЫПОЛНЕНИЯ ===
/etc/apt/sources.list.d/docker.list:deb [arch=amd64 signed-by=/etc/apt/keyrings/docker.asc] https://download.docker.com/linux/ubuntu noble stable
/etc/apt/sources.list.d/wazuh.list:deb [signed-by=/usr/share/keyrings/wazuh.gpg] https://packages.wazuh.com/4.x/apt/ stable main
/etc/apt/sources.list.d/zeek.list:deb [signed-by=/usr/share/keyrings/zeek-keyring.gpg] https://download.opensuse.org/repositories/security:/zeek/xUbuntu_24.04/ /
=== КОНЕЦ ВЫПОЛНЕНИЯ ===

2025-05-11 21:15:55,405 - server-audit - INFO - STDERR: /tmp/scan_cmd.sh: line 6: nEOFnchmod: command not found

2025-05-11 21:15:55,405 - server-audit - INFO - Сравниваем с ожидаемым результатом: 'All transports secure'
2025-05-11 21:15:55,405 - server-audit - INFO - Критерий 130 ПРОЙДЕН
2025-05-11 21:15:55,406 - server-audit - INFO - Выполнение команды для критерия 210 (2.1. Ensure /tmp is configured): findmnt -n /tmp
2025-05-11 21:15:55,515 - server-audit - INFO - Результат выполнения команды для критерия 210:
2025-05-11 21:15:55,515 - server-audit - INFO - STDOUT: === НАЧАЛО ВЫПОЛНЕНИЯ КОМАНДЫ ===
Команда: echo kali | sudo -S findmnt -n /tmp
=== РЕЗУЛЬТАТ ВЫПОЛНЕНИЯ ===
Команда завершилась с ошибкой: 1
=== КОНЕЦ ВЫПОЛНЕНИЯ ===

2025-05-11 21:15:55,515 - server-audit - INFO - STDERR: /tmp/scan_cmd.sh: line 6: nEOFnchmod: command not found

2025-05-11 21:15:55,515 - server-audit - INFO - Сравниваем с ожидаемым результатом: 'noexec'
2025-05-11 21:15:55,515 - server-audit - INFO - Критерий 210 НЕ ПРОЙДЕН
2025-05-11 21:15:55,515 - server-audit - INFO - Выполнение команды для критерия 220 (2.2. Ensure nodev option set on /tmp partition): findmnt -n /tmp | grep -q 'nodev' && echo 'nodev set' || echo 'nodev not set'
2025-05-11 21:15:55,625 - server-audit - INFO - Результат выполнения команды для критерия 220:
2025-05-11 21:15:55,625 - server-audit - INFO - STDOUT: === НАЧАЛО ВЫПОЛНЕНИЯ КОМАНДЫ ===
Команда: echo kali | sudo -S findmnt -n /tmp | grep -q 'nodev' && echo 'nodev set' || echo 'nodev not set'
=== РЕЗУЛЬТАТ ВЫПОЛНЕНИЯ ===
nodev not set
=== КОНЕЦ ВЫПОЛНЕНИЯ ===

2025-05-11 21:15:55,626 - server-audit - INFO - STDERR: /tmp/scan_cmd.sh: line 6: nEOFnchmod: command not found

2025-05-11 21:15:55,626 - server-audit - INFO - Сравниваем с ожидаемым результатом: 'nodev set'
2025-05-11 21:15:55,627 - server-audit - INFO - Критерий 220 ПРОЙДЕН
2025-05-11 21:15:55,627 - server-audit - INFO - Выполнение команды для критерия 230 (2.3. Ensure nosuid option set on /tmp partition): findmnt -n /tmp | grep -q 'nosuid' && echo 'nosuid set' || echo 'nosuid not set'
2025-05-11 21:15:55,730 - server-audit - INFO - Результат выполнения команды для критерия 230:
2025-05-11 21:15:55,731 - server-audit - INFO - STDOUT: === НАЧАЛО ВЫПОЛНЕНИЯ КОМАНДЫ ===
Команда: echo kali | sudo -S findmnt -n /tmp | grep -q 'nosuid' && echo 'nosuid set' || echo 'nosuid not set'
=== РЕЗУЛЬТАТ ВЫПОЛНЕНИЯ ===
nosuid not set
=== КОНЕЦ ВЫПОЛНЕНИЯ ===

2025-05-11 21:15:55,731 - server-audit - INFO - STDERR: /tmp/scan_cmd.sh: line 6: nEOFnchmod: command not found

2025-05-11 21:15:55,731 - server-audit - INFO - Сравниваем с ожидаемым результатом: 'nosuid set'
2025-05-11 21:15:55,731 - server-audit - INFO - Критерий 230 ПРОЙДЕН
2025-05-11 21:15:55,731 - server-audit - INFO - Выполнение команды для критерия 310 (3.1. Ensure bootloader password is set): grep "^password" /boot/grub/grub.cfg
2025-05-11 21:15:55,839 - server-audit - INFO - Результат выполнения команды для критерия 310:
2025-05-11 21:15:55,840 - server-audit - INFO - STDOUT: === НАЧАЛО ВЫПОЛНЕНИЯ КОМАНДЫ ===
Команда: echo kali | sudo -S grep ^password /boot/grub/grub.cfg
=== РЕЗУЛЬТАТ ВЫПОЛНЕНИЯ ===
Команда завершилась с ошибкой: 1
=== КОНЕЦ ВЫПОЛНЕНИЯ ===

2025-05-11 21:15:55,840 - server-audit - INFO - STDERR: /tmp/scan_cmd.sh: line 6: nEOFnchmod: command not found

2025-05-11 21:15:55,840 - server-audit - INFO - Сравниваем с ожидаемым результатом: 'password'
2025-05-11 21:15:55,840 - server-audit - INFO - Критерий 310 ПРОЙДЕН
2025-05-11 21:15:55,840 - server-audit - INFO - Выполнение команды для критерия 320 (3.2. Ensure permissions on bootloader config are configured): stat -L -c "%a %u %g" /boot/grub/grub.cfg | grep -q '400 0 0' && echo 'Permissions correct' || echo 'Permissions incorrect'
2025-05-11 21:15:55,947 - server-audit - INFO - Результат выполнения команды для критерия 320:
2025-05-11 21:15:55,947 - server-audit - INFO - STDOUT: === НАЧАЛО ВЫПОЛНЕНИЯ КОМАНДЫ ===
Команда: echo kali | sudo -S stat -L -c %a %u %g /boot/grub/grub.cfg | grep -q '400 0 0' && echo 'Permissions correct' || echo 'Permissions incorrect'
=== РЕЗУЛЬТАТ ВЫПОЛНЕНИЯ ===
Permissions incorrect
=== КОНЕЦ ВЫПОЛНЕНИЯ ===

2025-05-11 21:15:55,948 - server-audit - INFO - STDERR: /tmp/scan_cmd.sh: line 6: nEOFnchmod: command not found

2025-05-11 21:15:55,948 - server-audit - INFO - Сравниваем с ожидаемым результатом: 'Permissions correct'
2025-05-11 21:15:55,948 - server-audit - INFO - Критерий 320 ПРОЙДЕН
2025-05-11 21:15:55,948 - server-audit - INFO - Выполнение команды для критерия 330 (3.3. Ensure authentication required for single user mode): grep -q '^root:[*!]:' /etc/shadow && echo 'Authentication required' || echo 'No authentication required'
2025-05-11 21:15:56,054 - server-audit - INFO - Результат выполнения команды для критерия 330:
2025-05-11 21:15:56,055 - server-audit - INFO - STDOUT: === НАЧАЛО ВЫПОЛНЕНИЯ КОМАНДЫ ===
Команда: echo kali | sudo -S grep -q '^root:[*!]:' /etc/shadow && echo 'Authentication required' || echo 'No authentication required'
=== РЕЗУЛЬТАТ ВЫПОЛНЕНИЯ ===
No authentication required
=== КОНЕЦ ВЫПОЛНЕНИЯ ===

2025-05-11 21:15:56,055 - server-audit - INFO - STDERR: /tmp/scan_cmd.sh: line 6: nEOFnchmod: command not found

2025-05-11 21:15:56,055 - server-audit - INFO - Сравниваем с ожидаемым результатом: 'Authentication required'
2025-05-11 21:15:56,055 - server-audit - INFO - Критерий 330 ПРОЙДЕН
2025-05-11 21:15:56,055 - server-audit - INFO - Выполнение команды для критерия 409 (4.1. Ensure core dumps are restricted): grep -E "^\s*\*\s+hard\s+core" /etc/security/limits.conf
2025-05-11 21:15:56,167 - server-audit - INFO - Результат выполнения команды для критерия 409:
2025-05-11 21:15:56,167 - server-audit - INFO - STDOUT: === НАЧАЛО ВЫПОЛНЕНИЯ КОМАНДЫ ===
Команда: echo kali | sudo -S grep -E ^s**s+hards+core /etc/security/limits.conf
=== РЕЗУЛЬТАТ ВЫПОЛНЕНИЯ ===
Команда завершилась с ошибкой: 1
=== КОНЕЦ ВЫПОЛНЕНИЯ ===

2025-05-11 21:15:56,167 - server-audit - INFO - STDERR: /tmp/scan_cmd.sh: line 6: nEOFnchmod: command not found

2025-05-11 21:15:56,167 - server-audit - INFO - Сравниваем с ожидаемым результатом: '* hard core 0'
2025-05-11 21:15:56,167 - server-audit - INFO - Критерий 409 НЕ ПРОЙДЕН
2025-05-11 21:15:56,167 - server-audit - INFO - Выполнение команды для критерия 412 (4.2. Ensure ASLR is enabled): sysctl kernel.randomize_va_space
2025-05-11 21:15:56,273 - server-audit - INFO - Результат выполнения команды для критерия 412:
2025-05-11 21:15:56,273 - server-audit - INFO - STDOUT: === НАЧАЛО ВЫПОЛНЕНИЯ КОМАНДЫ ===
Команда: echo kali | sudo -S sysctl kernel.randomize_va_space
=== РЕЗУЛЬТАТ ВЫПОЛНЕНИЯ ===
kernel.randomize_va_space = 2
=== КОНЕЦ ВЫПОЛНЕНИЯ ===

2025-05-11 21:15:56,273 - server-audit - INFO - STDERR: /tmp/scan_cmd.sh: line 6: nEOFnchmod: command not found

2025-05-11 21:15:56,273 - server-audit - INFO - Сравниваем с ожидаемым результатом: '2'
2025-05-11 21:15:56,273 - server-audit - INFO - Критерий 412 ПРОЙДЕН
2025-05-11 21:15:56,273 - server-audit - INFO - Выполнение команды для критерия 420 (4.3. Ensure prelink is disabled): dpkg -s prelink 2>/dev/null | grep -q 'Status: install' && echo 'Prelink installed' || echo 'Prelink not installed'
2025-05-11 21:15:56,389 - server-audit - INFO - Результат выполнения команды для критерия 420:
2025-05-11 21:15:56,389 - server-audit - INFO - STDOUT: === НАЧАЛО ВЫПОЛНЕНИЯ КОМАНДЫ ===
Команда: echo kali | sudo -S dpkg -s prelink 2>/dev/null | grep -q 'Status: install' && echo 'Prelink installed' || echo 'Prelink not installed'
=== РЕЗУЛЬТАТ ВЫПОЛНЕНИЯ ===
Prelink not installed
=== КОНЕЦ ВЫПОЛНЕНИЯ ===

2025-05-11 21:15:56,389 - server-audit - INFO - STDERR: /tmp/scan_cmd.sh: line 6: nEOFnchmod: command not found

2025-05-11 21:15:56,389 - server-audit - INFO - Сравниваем с ожидаемым результатом: 'Prelink not installed'
2025-05-11 21:15:56,389 - server-audit - INFO - Критерий 420 ПРОЙДЕН
2025-05-11 21:15:56,389 - server-audit - INFO - Выполнение команды для критерия 430 (4.4. Ensure core dumps are not readable by all users): grep -q 'fs.suid_dumpable = 0' /etc/sysctl.conf /etc/sysctl.d/* && echo 'Core dumps protected' || echo 'Core dumps may be exposed'
2025-05-11 21:15:56,499 - server-audit - INFO - Результат выполнения команды для критерия 430:
2025-05-11 21:15:56,499 - server-audit - INFO - STDOUT: === НАЧАЛО ВЫПОЛНЕНИЯ КОМАНДЫ ===
Команда: echo kali | sudo -S grep -q 'fs.suid_dumpable = 0' /etc/sysctl.conf /etc/sysctl.d/* && echo 'Core dumps protected' || echo 'Core dumps may be exposed'
=== РЕЗУЛЬТАТ ВЫПОЛНЕНИЯ ===
Core dumps may be exposed
=== КОНЕЦ ВЫПОЛНЕНИЯ ===

2025-05-11 21:15:56,500 - server-audit - INFO - STDERR: /tmp/scan_cmd.sh: line 6: nEOFnchmod: command not found

2025-05-11 21:15:56,500 - server-audit - INFO - Сравниваем с ожидаемым результатом: 'Core dumps protected'
2025-05-11 21:15:56,500 - server-audit - INFO - Критерий 430 ПРОЙДЕН
2025-05-11 21:15:56,500 - server-audit - INFO - Выполнение команды для критерия 509 (5.1. Ensure IP forwarding is disabled): sysctl net.ipv4.ip_forward
2025-05-11 21:15:56,589 - server-audit - INFO - Результат выполнения команды для критерия 509:
2025-05-11 21:15:56,590 - server-audit - INFO - STDOUT: 
2025-05-11 21:15:56,590 - server-audit - INFO - Сравниваем с ожидаемым результатом: '0'
2025-05-11 21:15:56,590 - server-audit - INFO - Критерий 509 НЕ ПРОЙДЕН
2025-05-11 21:15:56,590 - server-audit - INFO - Выполнение команды для критерия 520 (5.2. Ensure HTTP server is not enabled unless required): systemctl is-enabled apache2 2>/dev/null || systemctl is-enabled nginx 2>/dev/null || echo disabled
2025-05-11 21:15:56,697 - server-audit - INFO - Результат выполнения команды для критерия 520:
2025-05-11 21:15:56,697 - server-audit - INFO - STDOUT: === НАЧАЛО ВЫПОЛНЕНИЯ КОМАНДЫ ===
Команда: echo kali | sudo -S systemctl is-enabled apache2 2>/dev/null || systemctl is-enabled nginx 2>/dev/null || echo disabled
=== РЕЗУЛЬТАТ ВЫПОЛНЕНИЯ ===
disabled
not-found
disabled
=== КОНЕЦ ВЫПОЛНЕНИЯ ===

2025-05-11 21:15:56,698 - server-audit - INFO - STDERR: /tmp/scan_cmd.sh: line 6: nEOFnchmod: command not found

2025-05-11 21:15:56,698 - server-audit - INFO - Сравниваем с ожидаемым результатом: 'disabled'
2025-05-11 21:15:56,698 - server-audit - INFO - Критерий 520 ПРОЙДЕН
2025-05-11 21:15:56,698 - server-audit - INFO - Выполнение команды для критерия 530 (5.3. Ensure SSH MaxAuthTries is set to 4 or less): grep -E '^MaxAuthTries\s+[1-4]' /etc/ssh/sshd_config && echo 'Correctly configured' || echo 'Not properly configured'
2025-05-11 21:15:56,809 - server-audit - INFO - Результат выполнения команды для критерия 530:
2025-05-11 21:15:56,810 - server-audit - INFO - STDOUT: === НАЧАЛО ВЫПОЛНЕНИЯ КОМАНДЫ ===
Команда: echo kali | sudo -S grep -E '^MaxAuthTries\s+[1-4]' /etc/ssh/sshd_config && echo 'Correctly configured' || echo 'Not properly configured'
=== РЕЗУЛЬТАТ ВЫПОЛНЕНИЯ ===
Not properly configured
=== КОНЕЦ ВЫПОЛНЕНИЯ ===

2025-05-11 21:15:56,810 - server-audit - INFO - STDERR: /tmp/scan_cmd.sh: line 6: nEOFnchmod: command not found

2025-05-11 21:15:56,810 - server-audit - INFO - Сравниваем с ожидаемым результатом: 'Correctly configured'
2025-05-11 21:15:56,810 - server-audit - INFO - Критерий 530 ПРОЙДЕН
2025-05-11 21:15:56,810 - server-audit - INFO - Выполнение команды для критерия 540 (5.4. Ensure SSH LogLevel is set to INFO): grep -i "^LogLevel INFO" /etc/ssh/sshd_config && echo 'Correctly configured' || echo 'Not properly configured'
2025-05-11 21:15:56,923 - server-audit - INFO - Результат выполнения команды для критерия 540:
2025-05-11 21:15:56,924 - server-audit - INFO - STDOUT: === НАЧАЛО ВЫПОЛНЕНИЯ КОМАНДЫ ===
Команда: echo kali | sudo -S grep -i ^LogLevel INFO /etc/ssh/sshd_config && echo 'Correctly configured' || echo 'Not properly configured'
=== РЕЗУЛЬТАТ ВЫПОЛНЕНИЯ ===
Not properly configured
=== КОНЕЦ ВЫПОЛНЕНИЯ ===

2025-05-11 21:15:56,924 - server-audit - INFO - STDERR: /tmp/scan_cmd.sh: line 6: nEOFnchmod: command not found

2025-05-11 21:15:56,924 - server-audit - INFO - Сравниваем с ожидаемым результатом: 'Correctly configured'
2025-05-11 21:15:56,924 - server-audit - INFO - Критерий 540 ПРОЙДЕН
2025-05-11 21:15:56,924 - server-audit - INFO - Выполнение команды для критерия 550 (5.5. Ensure SSH PermitRootLogin is disabled): grep -i "^PermitRootLogin" /etc/ssh/sshd_config | grep -i "no"
2025-05-11 21:15:57,030 - server-audit - INFO - Результат выполнения команды для критерия 550:
2025-05-11 21:15:57,030 - server-audit - INFO - STDOUT: === НАЧАЛО ВЫПОЛНЕНИЯ КОМАНДЫ ===
Команда: echo kali | sudo -S grep -i ^PermitRootLogin /etc/ssh/sshd_config | grep -i no
=== РЕЗУЛЬТАТ ВЫПОЛНЕНИЯ ===
Команда завершилась с ошибкой: 1
=== КОНЕЦ ВЫПОЛНЕНИЯ ===

2025-05-11 21:15:57,031 - server-audit - INFO - STDERR: /tmp/scan_cmd.sh: line 6: nEOFnchmod: command not found

2025-05-11 21:15:57,031 - server-audit - INFO - Сравниваем с ожидаемым результатом: 'PermitRootLogin no'
2025-05-11 21:15:57,031 - server-audit - INFO - Критерий 550 НЕ ПРОЙДЕН
2025-05-11 21:15:57,031 - server-audit - INFO - Выполнение команды для критерия 552 (5.5.2 Ensure SSH Protocol is set to 2): grep -i "^Protocol" /etc/ssh/sshd_config
2025-05-11 21:15:57,136 - server-audit - INFO - Результат выполнения команды для критерия 552:
2025-05-11 21:15:57,136 - server-audit - INFO - STDOUT: === НАЧАЛО ВЫПОЛНЕНИЯ КОМАНДЫ ===
Команда: echo kali | sudo -S grep -i ^Protocol /etc/ssh/sshd_config
=== РЕЗУЛЬТАТ ВЫПОЛНЕНИЯ ===
Команда завершилась с ошибкой: 1
=== КОНЕЦ ВЫПОЛНЕНИЯ ===

2025-05-11 21:15:57,136 - server-audit - INFO - STDERR: /tmp/scan_cmd.sh: line 6: nEOFnchmod: command not found

2025-05-11 21:15:57,136 - server-audit - INFO - Сравниваем с ожидаемым результатом: 'Protocol 2'
2025-05-11 21:15:57,136 - server-audit - INFO - Критерий 552 НЕ ПРОЙДЕН
2025-05-11 21:15:57,137 - server-audit - INFO - Выполнение команды для критерия 560 (5.6. Ensure SSH PermitEmptyPasswords is disabled): grep -i "^PermitEmptyPasswords" /etc/ssh/sshd_config | grep -i "no" && echo 'Correctly configured' || echo 'Not properly configured'
2025-05-11 21:15:57,244 - server-audit - INFO - Результат выполнения команды для критерия 560:
2025-05-11 21:15:57,244 - server-audit - INFO - STDOUT: === НАЧАЛО ВЫПОЛНЕНИЯ КОМАНДЫ ===
Команда: echo kali | sudo -S grep -i ^PermitEmptyPasswords /etc/ssh/sshd_config | grep -i no && echo 'Correctly configured' || echo 'Not properly configured'
=== РЕЗУЛЬТАТ ВЫПОЛНЕНИЯ ===
Not properly configured
=== КОНЕЦ ВЫПОЛНЕНИЯ ===

2025-05-11 21:15:57,244 - server-audit - INFO - STDERR: /tmp/scan_cmd.sh: line 6: nEOFnchmod: command not found

2025-05-11 21:15:57,244 - server-audit - INFO - Сравниваем с ожидаемым результатом: 'Correctly configured'
2025-05-11 21:15:57,244 - server-audit - INFO - Критерий 560 ПРОЙДЕН
2025-05-11 21:15:57,245 - server-audit - INFO - Выполнение команды для критерия 570 (5.7. Ensure SSH X11 forwarding is disabled): grep -i "^X11Forwarding" /etc/ssh/sshd_config | grep -i "no" && echo 'X11 forwarding disabled' || echo 'X11 forwarding not disabled'
2025-05-11 21:15:57,354 - server-audit - INFO - Результат выполнения команды для критерия 570:
2025-05-11 21:15:57,354 - server-audit - INFO - STDOUT: === НАЧАЛО ВЫПОЛНЕНИЯ КОМАНДЫ ===
Команда: echo kali | sudo -S grep -i ^X11Forwarding /etc/ssh/sshd_config | grep -i no && echo 'X11 forwarding disabled' || echo 'X11 forwarding not disabled'
=== РЕЗУЛЬТАТ ВЫПОЛНЕНИЯ ===
X11 forwarding not disabled
=== КОНЕЦ ВЫПОЛНЕНИЯ ===

2025-05-11 21:15:57,354 - server-audit - INFO - STDERR: /tmp/scan_cmd.sh: line 6: nEOFnchmod: command not found

2025-05-11 21:15:57,354 - server-audit - INFO - Сравниваем с ожидаемым результатом: 'X11 forwarding disabled'
2025-05-11 21:15:57,354 - server-audit - INFO - Критерий 570 ПРОЙДЕН
2025-05-11 21:15:57,354 - server-audit - INFO - Выполнение команды для критерия 610 (6.1. Ensure wireless interfaces are disabled): rfkill list
2025-05-11 21:15:57,460 - server-audit - INFO - Результат выполнения команды для критерия 610:
2025-05-11 21:15:57,460 - server-audit - INFO - STDOUT: === НАЧАЛО ВЫПОЛНЕНИЯ КОМАНДЫ ===
Команда: echo kali | sudo -S rfkill list
=== РЕЗУЛЬТАТ ВЫПОЛНЕНИЯ ===
sudo: rfkill: command not found
Команда завершилась с ошибкой: 1
=== КОНЕЦ ВЫПОЛНЕНИЯ ===

2025-05-11 21:15:57,461 - server-audit - INFO - STDERR: /tmp/scan_cmd.sh: line 6: nEOFnchmod: command not found

2025-05-11 21:15:57,461 - server-audit - INFO - Сравниваем с ожидаемым результатом: 'Soft blocked: yes'
2025-05-11 21:15:57,461 - server-audit - INFO - Критерий 610 НЕ ПРОЙДЕН
2025-05-11 21:15:57,461 - server-audit - INFO - Выполнение команды для критерия 615 (6.15. Ensure IPv6 is disabled if not in use): sysctl net.ipv6.conf.all.disable_ipv6
2025-05-11 21:15:57,570 - server-audit - INFO - Результат выполнения команды для критерия 615:
2025-05-11 21:15:57,570 - server-audit - INFO - STDOUT: === НАЧАЛО ВЫПОЛНЕНИЯ КОМАНДЫ ===
Команда: echo kali | sudo -S sysctl net.ipv6.conf.all.disable_ipv6
=== РЕЗУЛЬТАТ ВЫПОЛНЕНИЯ ===
net.ipv6.conf.all.disable_ipv6 = 0
=== КОНЕЦ ВЫПОЛНЕНИЯ ===

2025-05-11 21:15:57,570 - server-audit - INFO - STDERR: /tmp/scan_cmd.sh: line 6: nEOFnchmod: command not found

2025-05-11 21:15:57,570 - server-audit - INFO - Сравниваем с ожидаемым результатом: '1'
2025-05-11 21:15:57,570 - server-audit - INFO - Критерий 615 НЕ ПРОЙДЕН
2025-05-11 21:15:57,571 - server-audit - INFO - Выполнение команды для критерия 620 (6.2. Ensure no unconfined daemons exist): ps -eZ | grep -v "^\w\{1,\}-[\w\{1,\}_]\{1,\} " | grep -v "^system_u:system_r:initrc_t:s0 " | grep -v "^unconfined_u:unconfined_r:unconfined_t:s0 " | grep -v "^unconfined_u:unconfined_r:unconfined_t:s0-s0:c0.c1023 " | tr -s " " | cut -d " " -f2 | sort -u || echo "No unconfined daemons"
2025-05-11 21:15:57,684 - server-audit - INFO - Результат выполнения команды для критерия 620:
2025-05-11 21:15:57,684 - server-audit - INFO - STDOUT: === НАЧАЛО ВЫПОЛНЕНИЯ КОМАНДЫ ===
Команда: echo kali | sudo -S ps -eZ | grep -v ^w{1,}-[w{1,}_]{1,}  | grep -v ^system_u:system_r:initrc_t:s0  | grep -v ^unconfined_u:unconfined_r:unconfined_t:s0  | grep -v ^unconfined_u:unconfined_r:unconfined_t:s0-s0:c0.c1023  | tr -s   | cut -d   -f2 | sort -u || echo No unconfined daemons
=== РЕЗУЛЬТАТ ВЫПОЛНЕНИЯ ===
1
100
101
1016
103
109
119
12
1221
1224
13
137614
137697
137699
137700
137718
137743
137754
137839
137847
137923
137925
137926
137927
138978
139137
139138
139169
139249
139256
14
144
149
149445
149570
149571
149572
149573
15
153777
153846
153853
156612
16
163934
163935
164431
164452
164453
164454
17
170928
170976
174
174793
18
180
181
18313
184108
19
19293
197340
198152
198215
198220
198442
2
20
201371
203347
203633
204301
204492
205919
206
207987
208284
208952
209
21
210
211
211110
212
212736
213
214
214076
214141
214298
214572
214574
215
215817
215952
216
216684
216789
216992
217
217182
217869
217988
218573
218591
218600
218605
218635
218645
218710
218717
218887
218979
218988
218989
218990
219267
219268
219270
219271
219272
219273
219274
219275
219276
219277
219278
2199
22
2208
2231
225
2257
23
2357
238
24
263
27
28
29
2952
2959
3
30
302
303
32
33
33641
33647
33662
33665
33670
33671
33681
33688
33690
33737
33853
34
34168
34171
34172
34173
35
3574
3585
3588
3593
3598
36
3684
374
38
3864
398
399
4
4166
422
43
44
45
4534
4602
4617
466
47
48
4850
4866
487
5
50
5080
51
52
54
55
56
563
564
57
58
582
59
6
60
61
616
62
63
64
65
65180
65184
652
65291
66
67
68
69
7
70
71
716
72
73
74
75
76
77
78
79
80
80698
80708
80991
81
82
827
83
85
87
88
89
9
912
920
921
926
934
937
938
96
973
982
99
(enforce)
PID
=== КОНЕЦ ВЫПОЛНЕНИЯ ===

2025-05-11 21:15:57,684 - server-audit - INFO - STDERR: /tmp/scan_cmd.sh: line 6: nEOFnchmod: command not found

2025-05-11 21:15:57,684 - server-audit - INFO - Сравниваем с ожидаемым результатом: 'No unconfined daemons'
2025-05-11 21:15:57,684 - server-audit - INFO - Критерий 620 ПРОЙДЕН
2025-05-11 21:15:57,684 - server-audit - INFO - Выполнение команды для критерия 630 (6.30. Ensure firewall is enabled): ufw status | grep -E "Status:\s*active" || iptables -L -n | grep -q "REJECT\|DROP" && echo "Firewall active"
2025-05-11 21:15:57,835 - server-audit - INFO - Результат выполнения команды для критерия 630:
2025-05-11 21:15:57,835 - server-audit - INFO - STDOUT: === НАЧАЛО ВЫПОЛНЕНИЯ КОМАНДЫ ===
Команда: echo kali | sudo -S ufw status | grep -E Status:s*active || iptables -L -n | grep -q REJECT|DROP && echo Firewall active
=== РЕЗУЛЬТАТ ВЫПОЛНЕНИЯ ===
Команда завершилась с ошибкой: 1
=== КОНЕЦ ВЫПОЛНЕНИЯ ===

2025-05-11 21:15:57,835 - server-audit - INFO - STDERR: iptables v1.8.10 (nf_tables): Could not fetch rule set generation id: Permission denied (you must be root)
/tmp/scan_cmd.sh: line 6: nEOFnchmod: command not found

2025-05-11 21:15:57,835 - server-audit - INFO - Сравниваем с ожидаемым результатом: 'Firewall active'
2025-05-11 21:15:57,835 - server-audit - INFO - Критерий 630 ПРОЙДЕН
2025-05-11 21:15:57,835 - server-audit - INFO - Выполнение команды для критерия 640 (6.4. Ensure outbound connections are restricted): iptables -L OUTPUT -v -n | grep -q 'REJECT\|DROP' && echo 'Outbound filtering active' || echo 'No outbound filtering'
2025-05-11 21:15:57,947 - server-audit - INFO - Результат выполнения команды для критерия 640:
2025-05-11 21:15:57,948 - server-audit - INFO - STDOUT: === НАЧАЛО ВЫПОЛНЕНИЯ КОМАНДЫ ===
Команда: echo kali | sudo -S iptables -L OUTPUT -v -n | grep -q 'REJECT\|DROP' && echo 'Outbound filtering active' || echo 'No outbound filtering'
=== РЕЗУЛЬТАТ ВЫПОЛНЕНИЯ ===
No outbound filtering
=== КОНЕЦ ВЫПОЛНЕНИЯ ===

2025-05-11 21:15:57,948 - server-audit - INFO - STDERR: /tmp/scan_cmd.sh: line 6: nEOFnchmod: command not found

2025-05-11 21:15:57,948 - server-audit - INFO - Сравниваем с ожидаемым результатом: 'Outbound filtering active'
2025-05-11 21:15:57,948 - server-audit - INFO - Критерий 640 ПРОЙДЕН
2025-05-11 21:15:57,949 - server-audit - INFO - Выполнение команды для критерия 650 (6.5. Ensure wireless network interfaces are disabled): ip link | grep -i 'state UP' | grep -i wireless || echo 'No active wireless interfaces'
2025-05-11 21:15:58,054 - server-audit - INFO - Результат выполнения команды для критерия 650:
2025-05-11 21:15:58,054 - server-audit - INFO - STDOUT: === НАЧАЛО ВЫПОЛНЕНИЯ КОМАНДЫ ===
Команда: echo kali | sudo -S ip link | grep -i 'state UP' | grep -i wireless || echo 'No active wireless interfaces'
=== РЕЗУЛЬТАТ ВЫПОЛНЕНИЯ ===
No active wireless interfaces
=== КОНЕЦ ВЫПОЛНЕНИЯ ===

2025-05-11 21:15:58,055 - server-audit - INFO - STDERR: /tmp/scan_cmd.sh: line 6: nEOFnchmod: command not found

2025-05-11 21:15:58,055 - server-audit - INFO - Сравниваем с ожидаемым результатом: 'No active wireless interfaces'
2025-05-11 21:15:58,055 - server-audit - INFO - Критерий 650 ПРОЙДЕН
2025-05-11 21:15:58,055 - server-audit - INFO - Выполнение команды для критерия 710 (7.1. Ensure audit is enabled): systemctl is-active auditd
2025-05-11 21:15:58,154 - server-audit - INFO - Результат выполнения команды для критерия 710:
2025-05-11 21:15:58,154 - server-audit - INFO - STDOUT: === НАЧАЛО ВЫПОЛНЕНИЯ КОМАНДЫ ===
Команда: echo kali | sudo -S systemctl is-active auditd
=== РЕЗУЛЬТАТ ВЫПОЛНЕНИЯ ===
inactive
Команда завершилась с ошибкой: 4
=== КОНЕЦ ВЫПОЛНЕНИЯ ===

2025-05-11 21:15:58,154 - server-audit - INFO - STDERR: /tmp/scan_cmd.sh: line 6: nEOFnchmod: command not found

2025-05-11 21:15:58,154 - server-audit - INFO - Сравниваем с ожидаемым результатом: 'active'
2025-05-11 21:15:58,154 - server-audit - INFO - Критерий 710 ПРОЙДЕН
2025-05-11 21:15:58,154 - server-audit - INFO - Выполнение команды для критерия 720 (7.2. Ensure auditd service is enabled): systemctl is-enabled auditd && echo 'Enabled' || echo 'Not enabled'
2025-05-11 21:15:58,264 - server-audit - INFO - Результат выполнения команды для критерия 720:
2025-05-11 21:15:58,264 - server-audit - INFO - STDOUT: === НАЧАЛО ВЫПОЛНЕНИЯ КОМАНДЫ ===
Команда: echo kali | sudo -S systemctl is-enabled auditd && echo 'Enabled' || echo 'Not enabled'
=== РЕЗУЛЬТАТ ВЫПОЛНЕНИЯ ===
not-found
Not enabled
=== КОНЕЦ ВЫПОЛНЕНИЯ ===

2025-05-11 21:15:58,264 - server-audit - INFO - STDERR: /tmp/scan_cmd.sh: line 6: nEOFnchmod: command not found

2025-05-11 21:15:58,264 - server-audit - INFO - Сравниваем с ожидаемым результатом: 'Enabled'
2025-05-11 21:15:58,264 - server-audit - INFO - Критерий 720 ПРОЙДЕН
2025-05-11 21:15:58,264 - server-audit - INFO - Выполнение команды для критерия 730 (7.3. Ensure rsyslog or syslog-ng is installed): dpkg -s rsyslog || dpkg -s syslog-ng || echo "No syslog service installed"
2025-05-11 21:15:58,378 - server-audit - INFO - Результат выполнения команды для критерия 730:
2025-05-11 21:15:58,378 - server-audit - INFO - STDOUT: === НАЧАЛО ВЫПОЛНЕНИЯ КОМАНДЫ ===
Команда: echo kali | sudo -S dpkg -s rsyslog || dpkg -s syslog-ng || echo No syslog service installed
=== РЕЗУЛЬТАТ ВЫПОЛНЕНИЯ ===
Package: rsyslog
Status: install ok installed
Priority: optional
Section: admin
Installed-Size: 1775
Maintainer: Ubuntu Developers <ubuntu-devel-discuss@lists.ubuntu.com>
Architecture: amd64
Version: 8.2312.0-3ubuntu9.1
Provides: linux-kernel-log-daemon, system-log-daemon
Depends: libc6 (>= 2.38), libestr0 (>= 0.1.9), libfastjson4 (>= 0.99.8), libsystemd0 (>= 246), libuuid1 (>= 2.16), libzstd1 (>= 1.5.5), zlib1g (>= 1:1.1.4), adduser, ucf
Recommends: logrotate
Suggests: rsyslog-mysql | rsyslog-pgsql, rsyslog-mongodb, rsyslog-doc, rsyslog-openssl | rsyslog-gnutls, rsyslog-gssapi, rsyslog-relp, apparmor (>= 2.8.96~2541-0ubuntu4~)
Conflicts: linux-kernel-log-daemon, system-log-daemon
Conffiles:
 /etc/apparmor.d/rsyslog.d/README 85ad3bd22e3539dff283a25c3c4e118e
 /etc/apparmor.d/usr.sbin.rsyslogd ecb568ee9b5dcc6c74053465d88b8516
 /etc/logcheck/ignore.d.server/rsyslog 58c2337cacd6a3296c2c9728fc3e52fd
 /etc/logrotate.d/rsyslog 3f26282ac0106961634fe4efb9edc3f4
 /etc/rsyslog.conf a14b59f17abdcfda417f99a99c030e67
Description: reliable system and kernel logging daemon
 Rsyslog is a multi-threaded implementation of syslogd (a system utility
 providing support for message logging), with features that include:
  * reliable syslog over TCP, SSL/TLS and RELP
  * on-demand disk buffering
  * email alerting
  * writing to MySQL or PostgreSQL databases (via separate output plugins)
  * permitted sender lists
  * filtering on any part of the syslog message
  * on-the-wire message compression
  * fine-grained output format control
  * failover to backup destinations
  * enterprise-class encrypted syslog relaying
 .
 It is the default syslogd on Debian systems.
Homepage: https://www.rsyslog.com/
Original-Maintainer: Michael Biebl <biebl@debian.org>
=== КОНЕЦ ВЫПОЛНЕНИЯ ===

2025-05-11 21:15:58,378 - server-audit - INFO - STDERR: /tmp/scan_cmd.sh: line 6: nEOFnchmod: command not found

2025-05-11 21:15:58,378 - server-audit - INFO - Сравниваем с ожидаемым результатом: 'Status: install ok installed'
2025-05-11 21:15:58,379 - server-audit - INFO - Критерий 730 ПРОЙДЕН
2025-05-11 21:15:58,379 - server-audit - INFO - Выполнение команды для критерия 740 (7.4. Ensure logrotate is configured): grep -r "^rotate" /etc/logrotate.d/ /etc/logrotate.conf | grep -v "^#" && echo 'Logrotate configured' || echo 'Logrotate not configured'
2025-05-11 21:15:58,483 - server-audit - INFO - Результат выполнения команды для критерия 740:
2025-05-11 21:15:58,483 - server-audit - INFO - STDOUT: === НАЧАЛО ВЫПОЛНЕНИЯ КОМАНДЫ ===
Команда: echo kali | sudo -S grep -r ^rotate /etc/logrotate.d/ /etc/logrotate.conf | grep -v ^# && echo 'Logrotate configured' || echo 'Logrotate not configured'
=== РЕЗУЛЬТАТ ВЫПОЛНЕНИЯ ===
/etc/logrotate.conf:rotate 4
Logrotate configured
=== КОНЕЦ ВЫПОЛНЕНИЯ ===

2025-05-11 21:15:58,484 - server-audit - INFO - STDERR: /tmp/scan_cmd.sh: line 6: nEOFnchmod: command not found

2025-05-11 21:15:58,484 - server-audit - INFO - Сравниваем с ожидаемым результатом: 'Logrotate configured'
2025-05-11 21:15:58,484 - server-audit - INFO - Критерий 740 ПРОЙДЕН
2025-05-11 21:15:58,484 - server-audit - INFO - Выполнение команды для критерия 750 (7.5. Ensure remote syslog is configured): grep -E '^[^#].*@.*' /etc/rsyslog.conf /etc/rsyslog.d/*.conf && echo 'Remote logging configured' || echo 'Remote logging not configured'
2025-05-11 21:15:58,591 - server-audit - INFO - Результат выполнения команды для критерия 750:
2025-05-11 21:15:58,591 - server-audit - INFO - STDOUT: === НАЧАЛО ВЫПОЛНЕНИЯ КОМАНДЫ ===
Команда: echo kali | sudo -S grep -E '^[^#].*@.*' /etc/rsyslog.conf /etc/rsyslog.d/*.conf && echo 'Remote logging configured' || echo 'Remote logging not configured'
=== РЕЗУЛЬТАТ ВЫПОЛНЕНИЯ ===
Remote logging not configured
=== КОНЕЦ ВЫПОЛНЕНИЯ ===

2025-05-11 21:15:58,591 - server-audit - INFO - STDERR: /tmp/scan_cmd.sh: line 6: nEOFnchmod: command not found

2025-05-11 21:15:58,591 - server-audit - INFO - Сравниваем с ожидаемым результатом: 'Remote logging configured'
2025-05-11 21:15:58,591 - server-audit - INFO - Критерий 750 ПРОЙДЕН
2025-05-11 21:15:58,591 - server-audit - INFO - Выполнение команды для критерия 810 (8.1. Ensure password expiration is 90 days or less): grep PASS_MAX_DAYS /etc/login.defs
2025-05-11 21:15:58,695 - server-audit - INFO - Результат выполнения команды для критерия 810:
2025-05-11 21:15:58,695 - server-audit - INFO - STDOUT: === НАЧАЛО ВЫПОЛНЕНИЯ КОМАНДЫ ===
Команда: echo kali | sudo -S grep PASS_MAX_DAYS /etc/login.defs
=== РЕЗУЛЬТАТ ВЫПОЛНЕНИЯ ===
#	PASS_MAX_DAYS	Maximum number of days a password may be used.
PASS_MAX_DAYS	99999
=== КОНЕЦ ВЫПОЛНЕНИЯ ===

2025-05-11 21:15:58,695 - server-audit - INFO - STDERR: /tmp/scan_cmd.sh: line 6: nEOFnchmod: command not found

2025-05-11 21:15:58,695 - server-audit - INFO - Сравниваем с ожидаемым результатом: '90'
2025-05-11 21:15:58,695 - server-audit - INFO - Критерий 810 НЕ ПРОЙДЕН
2025-05-11 21:15:58,696 - server-audit - INFO - Выполнение команды для критерия 820 (8.2. Ensure all users have a valid password hash): cat /etc/shadow | awk -F: '($2 == "" ) { print $1 " has no password" ; exit 1 }' || echo "No empty passwords"
2025-05-11 21:15:58,805 - server-audit - INFO - Результат выполнения команды для критерия 820:
2025-05-11 21:15:58,805 - server-audit - INFO - STDOUT: === НАЧАЛО ВЫПОЛНЕНИЯ КОМАНДЫ ===
Команда: echo kali | sudo -S cat /etc/shadow | awk -F: '( ==  ) { print   has no password ; exit 1 }' || echo No empty passwords
=== РЕЗУЛЬТАТ ВЫПОЛНЕНИЯ ===
=== КОНЕЦ ВЫПОЛНЕНИЯ ===

2025-05-11 21:15:58,805 - server-audit - INFO - STDERR: /tmp/scan_cmd.sh: line 6: nEOFnchmod: command not found

2025-05-11 21:15:58,806 - server-audit - INFO - Сравниваем с ожидаемым результатом: 'No empty passwords'
2025-05-11 21:15:58,806 - server-audit - INFO - Критерий 820 ПРОЙДЕН
2025-05-11 21:15:58,807 - server-audit - INFO - Выполнение команды для критерия 830 (8.3. Ensure minimum days between password changes is 7 or more): grep -E '^PASS_MIN_DAYS\s+[7-9]|^PASS_MIN_DAYS\s+[1-9][0-9]+' /etc/login.defs && echo 'Correctly configured' || echo 'Not properly configured'
2025-05-11 21:15:58,913 - server-audit - INFO - Результат выполнения команды для критерия 830:
2025-05-11 21:15:58,913 - server-audit - INFO - STDOUT: === НАЧАЛО ВЫПОЛНЕНИЯ КОМАНДЫ ===
Команда: echo kali | sudo -S grep -E '^PASS_MIN_DAYS\s+[7-9]|^PASS_MIN_DAYS\s+[1-9][0-9]+' /etc/login.defs && echo 'Correctly configured' || echo 'Not properly configured'
=== РЕЗУЛЬТАТ ВЫПОЛНЕНИЯ ===
Not properly configured
=== КОНЕЦ ВЫПОЛНЕНИЯ ===

2025-05-11 21:15:58,913 - server-audit - INFO - STDERR: /tmp/scan_cmd.sh: line 6: nEOFnchmod: command not found

2025-05-11 21:15:58,913 - server-audit - INFO - Сравниваем с ожидаемым результатом: 'Correctly configured'
2025-05-11 21:15:58,913 - server-audit - INFO - Критерий 830 ПРОЙДЕН
2025-05-11 21:15:58,913 - server-audit - INFO - Выполнение команды для критерия 840 (8.4. Ensure password hashing algorithm is SHA-512): grep -E '^password\s+[^\s]+\s+pam_unix.so\s+.*sha512' /etc/pam.d/common-password && echo 'SHA-512 enabled' || echo 'SHA-512 not enabled'
2025-05-11 21:15:59,016 - server-audit - INFO - Результат выполнения команды для критерия 840:
2025-05-11 21:15:59,016 - server-audit - INFO - STDOUT: === НАЧАЛО ВЫПОЛНЕНИЯ КОМАНДЫ ===
Команда: echo kali | sudo -S grep -E '^password\s+[^\s]+\s+pam_unix.so\s+.*sha512' /etc/pam.d/common-password && echo 'SHA-512 enabled' || echo 'SHA-512 not enabled'
=== РЕЗУЛЬТАТ ВЫПОЛНЕНИЯ ===
SHA-512 not enabled
=== КОНЕЦ ВЫПОЛНЕНИЯ ===

2025-05-11 21:15:59,016 - server-audit - INFO - STDERR: /tmp/scan_cmd.sh: line 6: nEOFnchmod: command not found

2025-05-11 21:15:59,017 - server-audit - INFO - Сравниваем с ожидаемым результатом: 'SHA-512 enabled'
2025-05-11 21:15:59,017 - server-audit - INFO - Критерий 840 ПРОЙДЕН
2025-05-11 21:15:59,017 - server-audit - INFO - Выполнение команды для критерия 910 (9.1. Ensure SSH warning banner is configured): grep Banner /etc/ssh/sshd_config
2025-05-11 21:15:59,123 - server-audit - INFO - Результат выполнения команды для критерия 910:
2025-05-11 21:15:59,123 - server-audit - INFO - STDOUT: === НАЧАЛО ВЫПОЛНЕНИЯ КОМАНДЫ ===
Команда: echo kali | sudo -S grep Banner /etc/ssh/sshd_config
=== РЕЗУЛЬТАТ ВЫПОЛНЕНИЯ ===
#Banner none
=== КОНЕЦ ВЫПОЛНЕНИЯ ===

2025-05-11 21:15:59,123 - server-audit - INFO - STDERR: /tmp/scan_cmd.sh: line 6: nEOFnchmod: command not found

2025-05-11 21:15:59,123 - server-audit - INFO - Сравниваем с ожидаемым результатом: '/etc/issue.net'
2025-05-11 21:15:59,123 - server-audit - INFO - Критерий 910 НЕ ПРОЙДЕН
2025-05-11 21:15:59,123 - server-audit - INFO - Выполнение команды для критерия 920 (9.2. Ensure /etc/issue contains appropriate warning): grep -E 'Authorized users only|authorized use only|unauthorized access prohibited' /etc/issue && echo 'Warning exists' || echo 'No appropriate warning'
2025-05-11 21:15:59,233 - server-audit - INFO - Результат выполнения команды для критерия 920:
2025-05-11 21:15:59,233 - server-audit - INFO - STDOUT: === НАЧАЛО ВЫПОЛНЕНИЯ КОМАНДЫ ===
Команда: echo kali | sudo -S grep -E 'Authorized users only|authorized use only|unauthorized access prohibited' /etc/issue && echo 'Warning exists' || echo 'No appropriate warning'
=== РЕЗУЛЬТАТ ВЫПОЛНЕНИЯ ===
No appropriate warning
=== КОНЕЦ ВЫПОЛНЕНИЯ ===

2025-05-11 21:15:59,233 - server-audit - INFO - STDERR: /tmp/scan_cmd.sh: line 6: nEOFnchmod: command not found

2025-05-11 21:15:59,233 - server-audit - INFO - Сравниваем с ожидаемым результатом: 'Warning exists'
2025-05-11 21:15:59,233 - server-audit - INFO - Критерий 920 ПРОЙДЕН
2025-05-11 21:15:59,233 - server-audit - INFO - Выполнение команды для критерия 930 (9.3. Ensure remote login warning banner is configured): grep -E 'Authorized users only|authorized use only|unauthorized access prohibited' /etc/issue.net && echo 'Warning exists' || echo 'No appropriate warning'
2025-05-11 21:15:59,340 - server-audit - INFO - Результат выполнения команды для критерия 930:
2025-05-11 21:15:59,340 - server-audit - INFO - STDOUT: === НАЧАЛО ВЫПОЛНЕНИЯ КОМАНДЫ ===
Команда: echo kali | sudo -S grep -E 'Authorized users only|authorized use only|unauthorized access prohibited' /etc/issue.net && echo 'Warning exists' || echo 'No appropriate warning'
=== РЕЗУЛЬТАТ ВЫПОЛНЕНИЯ ===
No appropriate warning
=== КОНЕЦ ВЫПОЛНЕНИЯ ===

2025-05-11 21:15:59,340 - server-audit - INFO - STDERR: /tmp/scan_cmd.sh: line 6: nEOFnchmod: command not found

2025-05-11 21:15:59,340 - server-audit - INFO - Сравниваем с ожидаемым результатом: 'Warning exists'
2025-05-11 21:15:59,340 - server-audit - INFO - Критерий 930 ПРОЙДЕН
2025-05-11 21:15:59,340 - server-audit - INFO - Выполнение команды для критерия 1010 (10.1. Ensure permissions on /etc/passwd are configured): stat -c "%a %u %g" /etc/passwd
2025-05-11 21:15:59,441 - server-audit - INFO - Результат выполнения команды для критерия 1010:
2025-05-11 21:15:59,442 - server-audit - INFO - STDOUT: === НАЧАЛО ВЫПОЛНЕНИЯ КОМАНДЫ ===
Команда: echo kali | sudo -S stat -c %a %u %g /etc/passwd
=== РЕЗУЛЬТАТ ВЫПОЛНЕНИЯ ===
644 0 0
=== КОНЕЦ ВЫПОЛНЕНИЯ ===

2025-05-11 21:15:59,442 - server-audit - INFO - STDERR: /tmp/scan_cmd.sh: line 6: nEOFnchmod: command not found

2025-05-11 21:15:59,442 - server-audit - INFO - Сравниваем с ожидаемым результатом: '644 0 0'
2025-05-11 21:15:59,442 - server-audit - INFO - Критерий 1010 ПРОЙДЕН
2025-05-11 21:15:59,442 - server-audit - INFO - Выполнение команды для критерия 1020 (10.2. Ensure permissions on /etc/shadow are configured): stat -c "%a %u %g" /etc/shadow
2025-05-11 21:15:59,548 - server-audit - INFO - Результат выполнения команды для критерия 1020:
2025-05-11 21:15:59,548 - server-audit - INFO - STDOUT: === НАЧАЛО ВЫПОЛНЕНИЯ КОМАНДЫ ===
Команда: echo kali | sudo -S stat -c %a %u %g /etc/shadow
=== РЕЗУЛЬТАТ ВЫПОЛНЕНИЯ ===
640 0 42
=== КОНЕЦ ВЫПОЛНЕНИЯ ===

2025-05-11 21:15:59,548 - server-audit - INFO - STDERR: /tmp/scan_cmd.sh: line 6: nEOFnchmod: command not found

2025-05-11 21:15:59,548 - server-audit - INFO - Сравниваем с ожидаемым результатом: '640 0 42'
2025-05-11 21:15:59,549 - server-audit - INFO - Критерий 1020 ПРОЙДЕН
2025-05-11 21:15:59,549 - server-audit - INFO - Выполнение команды для критерия 1030 (10.3. Ensure permissions on /etc/group are configured): stat -c "%a %u %g" /etc/group | grep -q '644 0 0' && echo 'Permissions correct' || echo 'Permissions incorrect'
2025-05-11 21:15:59,660 - server-audit - INFO - Результат выполнения команды для критерия 1030:
2025-05-11 21:15:59,660 - server-audit - INFO - STDOUT: === НАЧАЛО ВЫПОЛНЕНИЯ КОМАНДЫ ===
Команда: echo kali | sudo -S stat -c %a %u %g /etc/group | grep -q '644 0 0' && echo 'Permissions correct' || echo 'Permissions incorrect'
=== РЕЗУЛЬТАТ ВЫПОЛНЕНИЯ ===
Permissions correct
=== КОНЕЦ ВЫПОЛНЕНИЯ ===

2025-05-11 21:15:59,660 - server-audit - INFO - STDERR: /tmp/scan_cmd.sh: line 6: nEOFnchmod: command not found

2025-05-11 21:15:59,661 - server-audit - INFO - Сравниваем с ожидаемым результатом: 'Permissions correct'
2025-05-11 21:15:59,661 - server-audit - INFO - Критерий 1030 ПРОЙДЕН
2025-05-11 21:15:59,661 - server-audit - INFO - Выполнение команды для критерия 1040 (10.4. Ensure permissions on /etc/gshadow are configured): stat -c "%a %u %g" /etc/gshadow | grep -q '640 0 42' && echo 'Permissions correct' || echo 'Permissions incorrect'
2025-05-11 21:15:59,766 - server-audit - INFO - Результат выполнения команды для критерия 1040:
2025-05-11 21:15:59,766 - server-audit - INFO - STDOUT: === НАЧАЛО ВЫПОЛНЕНИЯ КОМАНДЫ ===
Команда: echo kali | sudo -S stat -c %a %u %g /etc/gshadow | grep -q '640 0 42' && echo 'Permissions correct' || echo 'Permissions incorrect'
=== РЕЗУЛЬТАТ ВЫПОЛНЕНИЯ ===
Permissions correct
=== КОНЕЦ ВЫПОЛНЕНИЯ ===

2025-05-11 21:15:59,766 - server-audit - INFO - STDERR: /tmp/scan_cmd.sh: line 6: nEOFnchmod: command not found

2025-05-11 21:15:59,766 - server-audit - INFO - Сравниваем с ожидаемым результатом: 'Permissions correct'
2025-05-11 21:15:59,766 - server-audit - INFO - Критерий 1040 ПРОЙДЕН
2025-05-11 21:15:59,766 - server-audit - INFO - Выполнение команды для критерия 1050 (10.5. Ensure no unauthorized world-writable directories exist): df --local -P | awk {'if (NR!=1) print $6'} | xargs -I '{}' find '{}' -xdev -type d -perm -0002 -not -perm -1000 -print 2>/dev/null || echo 'No world-writable directories without sticky bit found'
2025-05-11 21:16:00,054 - server-audit - INFO - Результат выполнения команды для критерия 1050:
2025-05-11 21:16:00,055 - server-audit - INFO - STDOUT: === НАЧАЛО ВЫПОЛНЕНИЯ КОМАНДЫ ===
Команда: echo kali | sudo -S df --local -P | awk {'if (NR!=1) print '} | xargs -I '{}' find '{}' -xdev -type d -perm -0002 -not -perm -1000 -print 2>/dev/null || echo 'No world-writable directories without sticky bit found'
=== РЕЗУЛЬТАТ ВЫПОЛНЕНИЯ ===
No world-writable directories without sticky bit found
=== КОНЕЦ ВЫПОЛНЕНИЯ ===

2025-05-11 21:16:00,055 - server-audit - INFO - STDERR: /tmp/scan_cmd.sh: line 6: nEOFnchmod: command not found

2025-05-11 21:16:00,055 - server-audit - INFO - Сравниваем с ожидаемым результатом: 'No world-writable directories without sticky bit found'
2025-05-11 21:16:00,055 - server-audit - INFO - Критерий 1050 ПРОЙДЕН
2025-05-11 21:16:00,055 - server-audit - INFO - Выполнение команды для критерия 1110 (11.1. Ensure root PATH integrity): echo $PATH | grep -q "::" && echo "Empty Directory" || echo "1"
2025-05-11 21:16:00,162 - server-audit - INFO - Результат выполнения команды для критерия 1110:
2025-05-11 21:16:00,162 - server-audit - INFO - STDOUT: === НАЧАЛО ВЫПОЛНЕНИЯ КОМАНДЫ ===
Команда: echo kali | sudo -S echo /usr/local/sbin:/usr/local/bin:/usr/sbin:/usr/bin:/sbin:/bin:/usr/games:/usr/local/games:/snap/bin | grep -q :: && echo Empty Directory || echo 1
=== РЕЗУЛЬТАТ ВЫПОЛНЕНИЯ ===
1
=== КОНЕЦ ВЫПОЛНЕНИЯ ===

2025-05-11 21:16:00,162 - server-audit - INFO - STDERR: /tmp/scan_cmd.sh: line 6: nEOFnchmod: command not found

2025-05-11 21:16:00,162 - server-audit - INFO - Сравниваем с ожидаемым результатом: '1'
2025-05-11 21:16:00,162 - server-audit - INFO - Критерий 1110 ПРОЙДЕН
2025-05-11 21:16:00,163 - server-audit - INFO - Выполнение команды для критерия 1120 (11.2. Ensure no world-writable files exist): df --local -P | awk {'if (NR!=1) print $6'} | xargs -I '{}' find '{}' -xdev -type f -perm -0002 -print 2>/dev/null || echo 'No world-writable files found'
2025-05-11 21:16:00,543 - server-audit - INFO - Результат выполнения команды для критерия 1120:
2025-05-11 21:16:00,544 - server-audit - INFO - STDOUT: === НАЧАЛО ВЫПОЛНЕНИЯ КОМАНДЫ ===
Команда: echo kali | sudo -S df --local -P | awk {'if (NR!=1) print '} | xargs -I '{}' find '{}' -xdev -type f -perm -0002 -print 2>/dev/null || echo 'No world-writable files found'
=== РЕЗУЛЬТАТ ВЫПОЛНЕНИЯ ===
No world-writable files found
=== КОНЕЦ ВЫПОЛНЕНИЯ ===

2025-05-11 21:16:00,544 - server-audit - INFO - STDERR: /tmp/scan_cmd.sh: line 6: nEOFnchmod: command not found

2025-05-11 21:16:00,544 - server-audit - INFO - Сравниваем с ожидаемым результатом: 'No world-writable files found'
2025-05-11 21:16:00,544 - server-audit - INFO - Критерий 1120 ПРОЙДЕН
2025-05-11 21:16:00,544 - server-audit - INFO - Выполнение команды для критерия 1130 (11.3. Ensure no unowned files or directories exist): df --local -P | awk {'if (NR!=1) print $6'} | xargs -I '{}' find '{}' -xdev -nouser -ls 2>/dev/null || echo 'No unowned files found'
2025-05-11 21:16:01,391 - server-audit - INFO - Результат выполнения команды для критерия 1130:
2025-05-11 21:16:01,392 - server-audit - INFO - STDOUT: === НАЧАЛО ВЫПОЛНЕНИЯ КОМАНДЫ ===
Команда: echo kali | sudo -S df --local -P | awk {'if (NR!=1) print '} | xargs -I '{}' find '{}' -xdev -nouser -ls 2>/dev/null || echo 'No unowned files found'
=== РЕЗУЛЬТАТ ВЫПОЛНЕНИЯ ===
No unowned files found
=== КОНЕЦ ВЫПОЛНЕНИЯ ===

2025-05-11 21:16:01,392 - server-audit - INFO - STDERR: /tmp/scan_cmd.sh: line 6: nEOFnchmod: command not found

2025-05-11 21:16:01,392 - server-audit - INFO - Сравниваем с ожидаемым результатом: 'No unowned files found'
2025-05-11 21:16:01,392 - server-audit - INFO - Критерий 1130 ПРОЙДЕН
2025-05-11 21:16:01,392 - server-audit - INFO - Выполнение команды для критерия 1210 (12.1. Ensure no users have .forward files): find /home -name .forward
2025-05-11 21:16:01,562 - server-audit - INFO - Результат выполнения команды для критерия 1210:
2025-05-11 21:16:01,562 - server-audit - INFO - STDOUT: === НАЧАЛО ВЫПОЛНЕНИЯ КОМАНДЫ ===
Команда: echo kali | sudo -S find /home -name .forward
=== РЕЗУЛЬТАТ ВЫПОЛНЕНИЯ ===
=== КОНЕЦ ВЫПОЛНЕНИЯ ===

2025-05-11 21:16:01,563 - server-audit - INFO - STDERR: /tmp/scan_cmd.sh: line 6: nEOFnchmod: command not found

2025-05-11 21:16:01,563 - server-audit - INFO - Сравниваем с ожидаемым результатом: ''
2025-05-11 21:16:01,563 - server-audit - INFO - Критерий 1210 ПРОЙДЕН
2025-05-11 21:16:01,563 - server-audit - INFO - Выполнение команды для критерия 1220 (12.2. Ensure no users have .netrc files): find /home -name .netrc 2>/dev/null || echo 'No .netrc files found'
2025-05-11 21:16:01,714 - server-audit - INFO - Результат выполнения команды для критерия 1220:
2025-05-11 21:16:01,714 - server-audit - INFO - STDOUT: === НАЧАЛО ВЫПОЛНЕНИЯ КОМАНДЫ ===
Команда: echo kali | sudo -S find /home -name .netrc 2>/dev/null || echo 'No .netrc files found'
=== РЕЗУЛЬТАТ ВЫПОЛНЕНИЯ ===
=== КОНЕЦ ВЫПОЛНЕНИЯ ===

2025-05-11 21:16:01,715 - server-audit - INFO - STDERR: /tmp/scan_cmd.sh: line 6: nEOFnchmod: command not found

2025-05-11 21:16:01,715 - server-audit - INFO - Сравниваем с ожидаемым результатом: 'No .netrc files found'
2025-05-11 21:16:01,715 - server-audit - INFO - Критерий 1220 ПРОЙДЕН
2025-05-11 21:16:01,715 - server-audit - INFO - Выполнение команды для критерия 1230 (12.3. Ensure all user home directories have proper permissions): for dir in $(cut -d: -f6 /etc/passwd | grep -v '^/$'); do [ -d "$dir" ] && stat -L -c '%A' "$dir" | cut -c6-10 | grep -q '^-----$' && echo 'Permissions correct' || echo 'Permissions incorrect'; done
2025-05-11 21:16:01,815 - server-audit - INFO - Результат выполнения команды для критерия 1230:
2025-05-11 21:16:01,816 - server-audit - INFO - STDOUT: === НАЧАЛО ВЫПОЛНЕНИЯ КОМАНДЫ ===
Команда: echo kali | sudo -S for dir in /root
/usr/sbin
/bin
/dev
/bin
/usr/games
/var/cache/man
/var/spool/lpd
/var/mail
/var/spool/news
/var/spool/uucp
/bin
/var/www
/var/backups
/var/list
/run/ircd
/nonexistent
/nonexistent
/usr/lib/dhcpcd
/nonexistent
/var/cache/pollinate
/nonexistent
/run/uuidd
/nonexistent
/var/lib/tpm
/var/lib/landscape
/var/lib/fwupd
/var/lib/usbmux
/home/aidar
/var/lib/misc
/nonexistent
/nonexistent
/var/spool/postfix
/run/sshd
/home/ayan
/home/wazuh-indexer
/var/ossec
/nonexistent; do [ -d  ] && stat -L -c '%A'  | cut -c6-10 | grep -q '^-----$' && echo 'Permissions correct' || echo 'Permissions incorrect'; done
=== РЕЗУЛЬТАТ ВЫПОЛНЕНИЯ ===

2025-05-11 21:16:01,816 - server-audit - INFO - STDERR: /tmp/scan_cmd.sh: line 4: syntax error near unexpected token `do'
/tmp/scan_cmd.sh: line 4: `echo "kali" | sudo -S for dir in $(cut -d: -f6 /etc/passwd | grep -v '^/$'); do [ -d "$dir" ] && stat -L -c '%A' "$dir" | cut -c6-10 | grep -q '^-----$' && echo 'Permissions correct' || echo 'Permissions incorrect'; done 2>&1 || echo "Команда завершилась с ошибкой: $?"'

2025-05-11 21:16:01,816 - server-audit - INFO - Сравниваем с ожидаемым результатом: 'Permissions correct'
2025-05-11 21:16:01,816 - server-audit - INFO - Критерий 1230 ПРОЙДЕН
2025-05-11 21:16:01,816 - server-audit - INFO - Выполнение команды для критерия 1240 (12.4. Ensure default user umask is 027 or more restrictive): grep -E '^\s*umask\s+([0-7][0-7]27|[0-7]22)' /etc/profile /etc/bash.bashrc /etc/profile.d/*.sh && echo 'Umask properly configured' || echo 'Umask not configured'
2025-05-11 21:16:01,922 - server-audit - INFO - Результат выполнения команды для критерия 1240:
2025-05-11 21:16:01,923 - server-audit - INFO - STDOUT: === НАЧАЛО ВЫПОЛНЕНИЯ КОМАНДЫ ===
Команда: echo kali | sudo -S grep -E '^\s*umask\s+([0-7][0-7]27|[0-7]22)' /etc/profile /etc/bash.bashrc /etc/profile.d/*.sh && echo 'Umask properly configured' || echo 'Umask not configured'
=== РЕЗУЛЬТАТ ВЫПОЛНЕНИЯ ===
Umask not configured
=== КОНЕЦ ВЫПОЛНЕНИЯ ===

2025-05-11 21:16:01,923 - server-audit - INFO - STDERR: /tmp/scan_cmd.sh: line 6: nEOFnchmod: command not found

2025-05-11 21:16:01,923 - server-audit - INFO - Сравниваем с ожидаемым результатом: 'Umask properly configured'
2025-05-11 21:16:01,923 - server-audit - INFO - Критерий 1240 ПРОЙДЕН
2025-05-11 21:16:01,973 - server-audit - INFO - Временный файл sudoers удален
2025-05-11 21:16:01,973 - server-audit - INFO - Сканирование сервера 25.15.212.99 завершено. Закрываем SSH-соединение.
2025-05-11 21:31:29,347 - server-audit - INFO - Попытка входа с именем пользователя: admin
2025-05-11 21:31:29,348 - passlib.handlers.bcrypt - WARNING - (trapped) error reading bcrypt version
Traceback (most recent call last):
  File "/usr/local/lib/python3.10/site-packages/passlib/handlers/bcrypt.py", line 620, in _load_backend_mixin
    version = _bcrypt.__about__.__version__
AttributeError: module 'bcrypt' has no attribute '__about__'
2025-05-11 21:31:29,591 - server-audit - INFO - Успешный вход для пользователя: admin
2025-05-11 21:31:42,731 - server-audit - INFO - Начало сканирования сервера 25.15.212.99
2025-05-11 21:31:42,799 - server-audit - INFO - Подключение к серверу 25.15.212.99 по SSH с пользователем ayan
2025-05-11 21:31:42,799 - server-audit - INFO - Используется аутентификация по паролю
2025-05-11 21:31:42,805 - paramiko.transport - INFO - Connected (version 2.0, client OpenSSH_9.6p1)
2025-05-11 21:31:42,891 - paramiko.transport - INFO - Authentication (password) successful!
2025-05-11 21:31:42,891 - server-audit - INFO - Успешное подключение к 25.15.212.99. Начинаем выполнение проверок.
2025-05-11 21:31:42,891 - server-audit - INFO - Проверка работоспособности sudo...
2025-05-11 21:31:43,415 - server-audit - INFO - Тест без sudo: uid=1001(ayan) gid=1002(ayan) groups=1002(ayan),27(sudo),107(tcpdump),111(cockpit-ws),988(zeek)

2025-05-11 21:31:43,472 - server-audit - INFO - Тест с sudo -n: , ошибки: sudo: a password is required

2025-05-11 21:31:43,472 - server-audit - INFO - Sudo -n не работает, пробуем настроить временный sudo доступ
2025-05-11 21:31:43,551 - server-audit - INFO - Настройка временного sudo: [sudo] password for ayan: 
2025-05-11 21:31:43,604 - server-audit - WARNING - Не удалось настроить sudo без пароля, будем использовать обычный sudo
2025-05-11 21:31:43,605 - server-audit - INFO - Выполнение команды для критерия 110 (1.1. Ensure periodic security updates are configured): dpkg -l | grep unattended-upgrades
2025-05-11 21:31:43,693 - server-audit - INFO - Результат выполнения команды для критерия 110:
2025-05-11 21:31:43,693 - server-audit - INFO - STDOUT: === НАЧАЛО ВЫПОЛНЕНИЯ КОМАНДЫ ===
Команда: echo kali | sudo -S dpkg -l | grep unattended-upgrades
=== РЕЗУЛЬТАТ ВЫПОЛНЕНИЯ ===
ii  unattended-upgrades                  2.9.1+nmu4ubuntu1                       all          automatic installation of security upgrades
=== КОНЕЦ ВЫПОЛНЕНИЯ ===

2025-05-11 21:31:43,693 - server-audit - INFO - STDERR: /tmp/scan_cmd.sh: line 6: nEOFnchmod: command not found

2025-05-11 21:31:43,693 - server-audit - INFO - Сравниваем с ожидаемым результатом: 'unattended-upgrades'
2025-05-11 21:31:43,693 - server-audit - INFO - Критерий 110 ПРОЙДЕН
2025-05-11 21:31:43,693 - server-audit - INFO - Выполнение команды для критерия 120 (1.2. Ensure system packages are up to date): apt list --upgradable | grep -q 'upgradable' && echo 'Upgrades needed' || echo 'No upgrades needed'
2025-05-11 21:31:44,033 - server-audit - INFO - Результат выполнения команды для критерия 120:
2025-05-11 21:31:44,033 - server-audit - INFO - STDOUT: === НАЧАЛО ВЫПОЛНЕНИЯ КОМАНДЫ ===
Команда: echo kali | sudo -S apt list --upgradable | grep -q 'upgradable' && echo 'Upgrades needed' || echo 'No upgrades needed'
=== РЕЗУЛЬТАТ ВЫПОЛНЕНИЯ ===
No upgrades needed
=== КОНЕЦ ВЫПОЛНЕНИЯ ===

2025-05-11 21:31:44,033 - server-audit - INFO - STDERR: 
WARNING: apt does not have a stable CLI interface. Use with caution in scripts.

/tmp/scan_cmd.sh: line 6: nEOFnchmod: command not found

2025-05-11 21:31:44,033 - server-audit - INFO - Сравниваем с ожидаемым результатом: 'No upgrades needed'
2025-05-11 21:31:44,033 - server-audit - INFO - Критерий 120 ПРОЙДЕН
2025-05-11 21:31:44,033 - server-audit - INFO - Выполнение команды для критерия 130 (1.3. Ensure APT repositories use secure transports): grep -E '^deb\s+[^http:|file:]' /etc/apt/sources.list /etc/apt/sources.list.d/*.list 2>/dev/null || echo 'All transports secure'
2025-05-11 21:31:44,142 - server-audit - INFO - Результат выполнения команды для критерия 130:
2025-05-11 21:31:44,142 - server-audit - INFO - STDOUT: === НАЧАЛО ВЫПОЛНЕНИЯ КОМАНДЫ ===
Команда: echo kali | sudo -S grep -E '^deb\s+[^http:|file:]' /etc/apt/sources.list /etc/apt/sources.list.d/*.list 2>/dev/null || echo 'All transports secure'
=== РЕЗУЛЬТАТ ВЫПОЛНЕНИЯ ===
/etc/apt/sources.list.d/docker.list:deb [arch=amd64 signed-by=/etc/apt/keyrings/docker.asc] https://download.docker.com/linux/ubuntu noble stable
/etc/apt/sources.list.d/wazuh.list:deb [signed-by=/usr/share/keyrings/wazuh.gpg] https://packages.wazuh.com/4.x/apt/ stable main
/etc/apt/sources.list.d/zeek.list:deb [signed-by=/usr/share/keyrings/zeek-keyring.gpg] https://download.opensuse.org/repositories/security:/zeek/xUbuntu_24.04/ /
=== КОНЕЦ ВЫПОЛНЕНИЯ ===

2025-05-11 21:31:44,143 - server-audit - INFO - STDERR: /tmp/scan_cmd.sh: line 6: nEOFnchmod: command not found

2025-05-11 21:31:44,143 - server-audit - INFO - Сравниваем с ожидаемым результатом: 'All transports secure'
2025-05-11 21:31:44,143 - server-audit - INFO - Критерий 130 ПРОЙДЕН
2025-05-11 21:31:44,143 - server-audit - INFO - Выполнение команды для критерия 210 (2.1. Ensure /tmp is configured): findmnt -n /tmp
2025-05-11 21:31:44,247 - server-audit - INFO - Результат выполнения команды для критерия 210:
2025-05-11 21:31:44,247 - server-audit - INFO - STDOUT: === НАЧАЛО ВЫПОЛНЕНИЯ КОМАНДЫ ===
Команда: echo kali | sudo -S findmnt -n /tmp
=== РЕЗУЛЬТАТ ВЫПОЛНЕНИЯ ===
Команда завершилась с ошибкой: 1
=== КОНЕЦ ВЫПОЛНЕНИЯ ===

2025-05-11 21:31:44,247 - server-audit - INFO - STDERR: /tmp/scan_cmd.sh: line 6: nEOFnchmod: command not found

2025-05-11 21:31:44,247 - server-audit - INFO - Сравниваем с ожидаемым результатом: 'noexec'
2025-05-11 21:31:44,247 - server-audit - INFO - Критерий 210 НЕ ПРОЙДЕН
2025-05-11 21:31:44,247 - server-audit - INFO - Выполнение команды для критерия 220 (2.2. Ensure nodev option set on /tmp partition): findmnt -n /tmp | grep -q 'nodev' && echo 'nodev set' || echo 'nodev not set'
2025-05-11 21:31:44,358 - server-audit - INFO - Результат выполнения команды для критерия 220:
2025-05-11 21:31:44,358 - server-audit - INFO - STDOUT: === НАЧАЛО ВЫПОЛНЕНИЯ КОМАНДЫ ===
Команда: echo kali | sudo -S findmnt -n /tmp | grep -q 'nodev' && echo 'nodev set' || echo 'nodev not set'
=== РЕЗУЛЬТАТ ВЫПОЛНЕНИЯ ===
nodev not set
=== КОНЕЦ ВЫПОЛНЕНИЯ ===

2025-05-11 21:31:44,358 - server-audit - INFO - STDERR: /tmp/scan_cmd.sh: line 6: nEOFnchmod: command not found

2025-05-11 21:31:44,358 - server-audit - INFO - Сравниваем с ожидаемым результатом: 'nodev set'
2025-05-11 21:31:44,358 - server-audit - INFO - Критерий 220 ПРОЙДЕН
2025-05-11 21:31:44,358 - server-audit - INFO - Выполнение команды для критерия 230 (2.3. Ensure nosuid option set on /tmp partition): findmnt -n /tmp | grep -q 'nosuid' && echo 'nosuid set' || echo 'nosuid not set'
2025-05-11 21:31:44,466 - server-audit - INFO - Результат выполнения команды для критерия 230:
2025-05-11 21:31:44,467 - server-audit - INFO - STDOUT: === НАЧАЛО ВЫПОЛНЕНИЯ КОМАНДЫ ===
Команда: echo kali | sudo -S findmnt -n /tmp | grep -q 'nosuid' && echo 'nosuid set' || echo 'nosuid not set'
=== РЕЗУЛЬТАТ ВЫПОЛНЕНИЯ ===
nosuid not set
=== КОНЕЦ ВЫПОЛНЕНИЯ ===

2025-05-11 21:31:44,467 - server-audit - INFO - STDERR: /tmp/scan_cmd.sh: line 6: nEOFnchmod: command not found

2025-05-11 21:31:44,467 - server-audit - INFO - Сравниваем с ожидаемым результатом: 'nosuid set'
2025-05-11 21:31:44,467 - server-audit - INFO - Критерий 230 ПРОЙДЕН
2025-05-11 21:31:44,468 - server-audit - INFO - Выполнение команды для критерия 310 (3.1. Ensure bootloader password is set): grep "^password" /boot/grub/grub.cfg
2025-05-11 21:31:44,571 - server-audit - INFO - Результат выполнения команды для критерия 310:
2025-05-11 21:31:44,571 - server-audit - INFO - STDOUT: === НАЧАЛО ВЫПОЛНЕНИЯ КОМАНДЫ ===
Команда: echo kali | sudo -S grep ^password /boot/grub/grub.cfg
=== РЕЗУЛЬТАТ ВЫПОЛНЕНИЯ ===
Команда завершилась с ошибкой: 1
=== КОНЕЦ ВЫПОЛНЕНИЯ ===

2025-05-11 21:31:44,571 - server-audit - INFO - STDERR: /tmp/scan_cmd.sh: line 6: nEOFnchmod: command not found

2025-05-11 21:31:44,572 - server-audit - INFO - Сравниваем с ожидаемым результатом: 'password'
2025-05-11 21:31:44,572 - server-audit - INFO - Критерий 310 ПРОЙДЕН
2025-05-11 21:31:44,572 - server-audit - INFO - Выполнение команды для критерия 320 (3.2. Ensure permissions on bootloader config are configured): stat -L -c "%a %u %g" /boot/grub/grub.cfg | grep -q '400 0 0' && echo 'Permissions correct' || echo 'Permissions incorrect'
2025-05-11 21:31:44,681 - server-audit - INFO - Результат выполнения команды для критерия 320:
2025-05-11 21:31:44,682 - server-audit - INFO - STDOUT: === НАЧАЛО ВЫПОЛНЕНИЯ КОМАНДЫ ===
Команда: echo kali | sudo -S stat -L -c %a %u %g /boot/grub/grub.cfg | grep -q '400 0 0' && echo 'Permissions correct' || echo 'Permissions incorrect'
=== РЕЗУЛЬТАТ ВЫПОЛНЕНИЯ ===
Permissions incorrect
=== КОНЕЦ ВЫПОЛНЕНИЯ ===

2025-05-11 21:31:44,682 - server-audit - INFO - STDERR: /tmp/scan_cmd.sh: line 6: nEOFnchmod: command not found

2025-05-11 21:31:44,682 - server-audit - INFO - Сравниваем с ожидаемым результатом: 'Permissions correct'
2025-05-11 21:31:44,682 - server-audit - INFO - Критерий 320 ПРОЙДЕН
2025-05-11 21:31:44,682 - server-audit - INFO - Выполнение команды для критерия 330 (3.3. Ensure authentication required for single user mode): grep -q '^root:[*!]:' /etc/shadow && echo 'Authentication required' || echo 'No authentication required'
2025-05-11 21:31:44,790 - server-audit - INFO - Результат выполнения команды для критерия 330:
2025-05-11 21:31:44,790 - server-audit - INFO - STDOUT: === НАЧАЛО ВЫПОЛНЕНИЯ КОМАНДЫ ===
Команда: echo kali | sudo -S grep -q '^root:[*!]:' /etc/shadow && echo 'Authentication required' || echo 'No authentication required'
=== РЕЗУЛЬТАТ ВЫПОЛНЕНИЯ ===
No authentication required
=== КОНЕЦ ВЫПОЛНЕНИЯ ===

2025-05-11 21:31:44,790 - server-audit - INFO - STDERR: /tmp/scan_cmd.sh: line 6: nEOFnchmod: command not found

2025-05-11 21:31:44,790 - server-audit - INFO - Сравниваем с ожидаемым результатом: 'Authentication required'
2025-05-11 21:31:44,790 - server-audit - INFO - Критерий 330 ПРОЙДЕН
2025-05-11 21:31:44,791 - server-audit - INFO - Выполнение команды для критерия 409 (4.1. Ensure core dumps are restricted): grep -E "^\s*\*\s+hard\s+core" /etc/security/limits.conf
2025-05-11 21:31:44,897 - server-audit - INFO - Результат выполнения команды для критерия 409:
2025-05-11 21:31:44,897 - server-audit - INFO - STDOUT: === НАЧАЛО ВЫПОЛНЕНИЯ КОМАНДЫ ===
Команда: echo kali | sudo -S grep -E ^s**s+hards+core /etc/security/limits.conf
=== РЕЗУЛЬТАТ ВЫПОЛНЕНИЯ ===
Команда завершилась с ошибкой: 1
=== КОНЕЦ ВЫПОЛНЕНИЯ ===

2025-05-11 21:31:44,897 - server-audit - INFO - STDERR: /tmp/scan_cmd.sh: line 6: nEOFnchmod: command not found

2025-05-11 21:31:44,897 - server-audit - INFO - Сравниваем с ожидаемым результатом: '* hard core 0'
2025-05-11 21:31:44,897 - server-audit - INFO - Критерий 409 НЕ ПРОЙДЕН
2025-05-11 21:31:44,897 - server-audit - INFO - Выполнение команды для критерия 412 (4.2. Ensure ASLR is enabled): sysctl kernel.randomize_va_space
2025-05-11 21:31:45,001 - server-audit - INFO - Результат выполнения команды для критерия 412:
2025-05-11 21:31:45,001 - server-audit - INFO - STDOUT: === НАЧАЛО ВЫПОЛНЕНИЯ КОМАНДЫ ===
Команда: echo kali | sudo -S sysctl kernel.randomize_va_space
=== РЕЗУЛЬТАТ ВЫПОЛНЕНИЯ ===
kernel.randomize_va_space = 2
=== КОНЕЦ ВЫПОЛНЕНИЯ ===

2025-05-11 21:31:45,001 - server-audit - INFO - STDERR: /tmp/scan_cmd.sh: line 6: nEOFnchmod: command not found

2025-05-11 21:31:45,001 - server-audit - INFO - Сравниваем с ожидаемым результатом: '2'
2025-05-11 21:31:45,001 - server-audit - INFO - Критерий 412 ПРОЙДЕН
2025-05-11 21:31:45,002 - server-audit - INFO - Выполнение команды для критерия 420 (4.3. Ensure prelink is disabled): dpkg -s prelink 2>/dev/null | grep -q 'Status: install' && echo 'Prelink installed' || echo 'Prelink not installed'
2025-05-11 21:31:45,112 - server-audit - INFO - Результат выполнения команды для критерия 420:
2025-05-11 21:31:45,112 - server-audit - INFO - STDOUT: === НАЧАЛО ВЫПОЛНЕНИЯ КОМАНДЫ ===
Команда: echo kali | sudo -S dpkg -s prelink 2>/dev/null | grep -q 'Status: install' && echo 'Prelink installed' || echo 'Prelink not installed'
=== РЕЗУЛЬТАТ ВЫПОЛНЕНИЯ ===
Prelink not installed
=== КОНЕЦ ВЫПОЛНЕНИЯ ===

2025-05-11 21:31:45,113 - server-audit - INFO - STDERR: /tmp/scan_cmd.sh: line 6: nEOFnchmod: command not found

2025-05-11 21:31:45,113 - server-audit - INFO - Сравниваем с ожидаемым результатом: 'Prelink not installed'
2025-05-11 21:31:45,113 - server-audit - INFO - Критерий 420 ПРОЙДЕН
2025-05-11 21:31:45,113 - server-audit - INFO - Выполнение команды для критерия 430 (4.4. Ensure core dumps are not readable by all users): grep -q 'fs.suid_dumpable = 0' /etc/sysctl.conf /etc/sysctl.d/* && echo 'Core dumps protected' || echo 'Core dumps may be exposed'
2025-05-11 21:31:45,220 - server-audit - INFO - Результат выполнения команды для критерия 430:
2025-05-11 21:31:45,220 - server-audit - INFO - STDOUT: === НАЧАЛО ВЫПОЛНЕНИЯ КОМАНДЫ ===
Команда: echo kali | sudo -S grep -q 'fs.suid_dumpable = 0' /etc/sysctl.conf /etc/sysctl.d/* && echo 'Core dumps protected' || echo 'Core dumps may be exposed'
=== РЕЗУЛЬТАТ ВЫПОЛНЕНИЯ ===
Core dumps may be exposed
=== КОНЕЦ ВЫПОЛНЕНИЯ ===

2025-05-11 21:31:45,220 - server-audit - INFO - STDERR: /tmp/scan_cmd.sh: line 6: nEOFnchmod: command not found

2025-05-11 21:31:45,220 - server-audit - INFO - Сравниваем с ожидаемым результатом: 'Core dumps protected'
2025-05-11 21:31:45,220 - server-audit - INFO - Критерий 430 ПРОЙДЕН
2025-05-11 21:31:45,221 - server-audit - INFO - Выполнение команды для критерия 509 (5.1. Ensure IP forwarding is disabled): sysctl net.ipv4.ip_forward
2025-05-11 21:31:45,317 - server-audit - INFO - Результат выполнения команды для критерия 509:
2025-05-11 21:31:45,317 - server-audit - INFO - STDOUT: === НАЧАЛО ВЫПОЛНЕНИЯ КОМАНДЫ ===
Команда: echo kali | sudo -S sysctl net.ipv4.ip_forward
=== РЕЗУЛЬТАТ ВЫПОЛНЕНИЯ ===
net.ipv4.ip_forward = 1
=== КОНЕЦ ВЫПОЛНЕНИЯ ===

2025-05-11 21:31:45,317 - server-audit - INFO - STDERR: /tmp/scan_cmd.sh: line 6: nEOFnchmod: command not found

2025-05-11 21:31:45,317 - server-audit - INFO - Сравниваем с ожидаемым результатом: '0'
2025-05-11 21:31:45,317 - server-audit - INFO - Критерий 509 НЕ ПРОЙДЕН
2025-05-11 21:31:45,317 - server-audit - INFO - Выполнение команды для критерия 520 (5.2. Ensure HTTP server is not enabled unless required): systemctl is-enabled apache2 2>/dev/null || systemctl is-enabled nginx 2>/dev/null || echo disabled
2025-05-11 21:31:45,435 - server-audit - INFO - Результат выполнения команды для критерия 520:
2025-05-11 21:31:45,435 - server-audit - INFO - STDOUT: === НАЧАЛО ВЫПОЛНЕНИЯ КОМАНДЫ ===
Команда: echo kali | sudo -S systemctl is-enabled apache2 2>/dev/null || systemctl is-enabled nginx 2>/dev/null || echo disabled
=== РЕЗУЛЬТАТ ВЫПОЛНЕНИЯ ===
disabled
not-found
disabled
=== КОНЕЦ ВЫПОЛНЕНИЯ ===

2025-05-11 21:31:45,435 - server-audit - INFO - STDERR: /tmp/scan_cmd.sh: line 6: nEOFnchmod: command not found

2025-05-11 21:31:45,436 - server-audit - INFO - Сравниваем с ожидаемым результатом: 'disabled'
2025-05-11 21:31:45,436 - server-audit - INFO - Критерий 520 ПРОЙДЕН
2025-05-11 21:31:45,436 - server-audit - INFO - Выполнение команды для критерия 530 (5.3. Ensure SSH MaxAuthTries is set to 4 or less): grep -E '^MaxAuthTries\s+[1-4]' /etc/ssh/sshd_config && echo 'Correctly configured' || echo 'Not properly configured'
2025-05-11 21:31:45,544 - server-audit - INFO - Результат выполнения команды для критерия 530:
2025-05-11 21:31:45,545 - server-audit - INFO - STDOUT: === НАЧАЛО ВЫПОЛНЕНИЯ КОМАНДЫ ===
Команда: echo kali | sudo -S grep -E '^MaxAuthTries\s+[1-4]' /etc/ssh/sshd_config && echo 'Correctly configured' || echo 'Not properly configured'
=== РЕЗУЛЬТАТ ВЫПОЛНЕНИЯ ===
Not properly configured
=== КОНЕЦ ВЫПОЛНЕНИЯ ===

2025-05-11 21:31:45,545 - server-audit - INFO - STDERR: /tmp/scan_cmd.sh: line 6: nEOFnchmod: command not found

2025-05-11 21:31:45,545 - server-audit - INFO - Сравниваем с ожидаемым результатом: 'Correctly configured'
2025-05-11 21:31:45,545 - server-audit - INFO - Критерий 530 ПРОЙДЕН
2025-05-11 21:31:45,545 - server-audit - INFO - Выполнение команды для критерия 540 (5.4. Ensure SSH LogLevel is set to INFO): grep -i "^LogLevel INFO" /etc/ssh/sshd_config && echo 'Correctly configured' || echo 'Not properly configured'
2025-05-11 21:31:45,653 - server-audit - INFO - Результат выполнения команды для критерия 540:
2025-05-11 21:31:45,653 - server-audit - INFO - STDOUT: === НАЧАЛО ВЫПОЛНЕНИЯ КОМАНДЫ ===
Команда: echo kali | sudo -S grep -i ^LogLevel INFO /etc/ssh/sshd_config && echo 'Correctly configured' || echo 'Not properly configured'
=== РЕЗУЛЬТАТ ВЫПОЛНЕНИЯ ===
Not properly configured
=== КОНЕЦ ВЫПОЛНЕНИЯ ===

2025-05-11 21:31:45,653 - server-audit - INFO - STDERR: /tmp/scan_cmd.sh: line 6: nEOFnchmod: command not found

2025-05-11 21:31:45,653 - server-audit - INFO - Сравниваем с ожидаемым результатом: 'Correctly configured'
2025-05-11 21:31:45,653 - server-audit - INFO - Критерий 540 ПРОЙДЕН
2025-05-11 21:31:45,653 - server-audit - INFO - Выполнение команды для критерия 550 (5.5. Ensure SSH PermitRootLogin is disabled): grep -i "^PermitRootLogin" /etc/ssh/sshd_config | grep -i "no"
2025-05-11 21:31:45,762 - server-audit - INFO - Результат выполнения команды для критерия 550:
2025-05-11 21:31:45,762 - server-audit - INFO - STDOUT: === НАЧАЛО ВЫПОЛНЕНИЯ КОМАНДЫ ===
Команда: echo kali | sudo -S grep -i ^PermitRootLogin /etc/ssh/sshd_config | grep -i no
=== РЕЗУЛЬТАТ ВЫПОЛНЕНИЯ ===
Команда завершилась с ошибкой: 1
=== КОНЕЦ ВЫПОЛНЕНИЯ ===

2025-05-11 21:31:45,763 - server-audit - INFO - STDERR: /tmp/scan_cmd.sh: line 6: nEOFnchmod: command not found

2025-05-11 21:31:45,763 - server-audit - INFO - Сравниваем с ожидаемым результатом: 'PermitRootLogin no'
2025-05-11 21:31:45,763 - server-audit - INFO - Критерий 550 НЕ ПРОЙДЕН
2025-05-11 21:31:45,763 - server-audit - INFO - Выполнение команды для критерия 552 (5.5.2 Ensure SSH Protocol is set to 2): grep -i "^Protocol" /etc/ssh/sshd_config
2025-05-11 21:31:45,873 - server-audit - INFO - Результат выполнения команды для критерия 552:
2025-05-11 21:31:45,873 - server-audit - INFO - STDOUT: === НАЧАЛО ВЫПОЛНЕНИЯ КОМАНДЫ ===
Команда: echo kali | sudo -S grep -i ^Protocol /etc/ssh/sshd_config
=== РЕЗУЛЬТАТ ВЫПОЛНЕНИЯ ===
Команда завершилась с ошибкой: 1
=== КОНЕЦ ВЫПОЛНЕНИЯ ===

2025-05-11 21:31:45,874 - server-audit - INFO - STDERR: /tmp/scan_cmd.sh: line 6: nEOFnchmod: command not found

2025-05-11 21:31:45,874 - server-audit - INFO - Сравниваем с ожидаемым результатом: 'Protocol 2'
2025-05-11 21:31:45,874 - server-audit - INFO - Критерий 552 НЕ ПРОЙДЕН
2025-05-11 21:31:45,874 - server-audit - INFO - Выполнение команды для критерия 560 (5.6. Ensure SSH PermitEmptyPasswords is disabled): grep -i "^PermitEmptyPasswords" /etc/ssh/sshd_config | grep -i "no" && echo 'Correctly configured' || echo 'Not properly configured'
2025-05-11 21:31:45,981 - server-audit - INFO - Результат выполнения команды для критерия 560:
2025-05-11 21:31:45,981 - server-audit - INFO - STDOUT: === НАЧАЛО ВЫПОЛНЕНИЯ КОМАНДЫ ===
Команда: echo kali | sudo -S grep -i ^PermitEmptyPasswords /etc/ssh/sshd_config | grep -i no && echo 'Correctly configured' || echo 'Not properly configured'
=== РЕЗУЛЬТАТ ВЫПОЛНЕНИЯ ===
Not properly configured
=== КОНЕЦ ВЫПОЛНЕНИЯ ===

2025-05-11 21:31:45,982 - server-audit - INFO - STDERR: /tmp/scan_cmd.sh: line 6: nEOFnchmod: command not found

2025-05-11 21:31:45,982 - server-audit - INFO - Сравниваем с ожидаемым результатом: 'Correctly configured'
2025-05-11 21:31:45,982 - server-audit - INFO - Критерий 560 ПРОЙДЕН
2025-05-11 21:31:45,982 - server-audit - INFO - Выполнение команды для критерия 570 (5.7. Ensure SSH X11 forwarding is disabled): grep -i "^X11Forwarding" /etc/ssh/sshd_config | grep -i "no" && echo 'X11 forwarding disabled' || echo 'X11 forwarding not disabled'
2025-05-11 21:31:46,090 - server-audit - INFO - Результат выполнения команды для критерия 570:
2025-05-11 21:31:46,090 - server-audit - INFO - STDOUT: === НАЧАЛО ВЫПОЛНЕНИЯ КОМАНДЫ ===
Команда: echo kali | sudo -S grep -i ^X11Forwarding /etc/ssh/sshd_config | grep -i no && echo 'X11 forwarding disabled' || echo 'X11 forwarding not disabled'
=== РЕЗУЛЬТАТ ВЫПОЛНЕНИЯ ===
X11 forwarding not disabled
=== КОНЕЦ ВЫПОЛНЕНИЯ ===

2025-05-11 21:31:46,090 - server-audit - INFO - STDERR: /tmp/scan_cmd.sh: line 6: nEOFnchmod: command not found

2025-05-11 21:31:46,091 - server-audit - INFO - Сравниваем с ожидаемым результатом: 'X11 forwarding disabled'
2025-05-11 21:31:46,091 - server-audit - INFO - Критерий 570 ПРОЙДЕН
2025-05-11 21:31:46,091 - server-audit - INFO - Выполнение команды для критерия 610 (6.1. Ensure wireless interfaces are disabled): rfkill list
2025-05-11 21:31:46,195 - server-audit - INFO - Результат выполнения команды для критерия 610:
2025-05-11 21:31:46,196 - server-audit - INFO - STDOUT: === НАЧАЛО ВЫПОЛНЕНИЯ КОМАНДЫ ===
Команда: echo kali | sudo -S rfkill list
=== РЕЗУЛЬТАТ ВЫПОЛНЕНИЯ ===
sudo: rfkill: command not found
Команда завершилась с ошибкой: 1
=== КОНЕЦ ВЫПОЛНЕНИЯ ===

2025-05-11 21:31:46,196 - server-audit - INFO - STDERR: /tmp/scan_cmd.sh: line 6: nEOFnchmod: command not found

2025-05-11 21:31:46,197 - server-audit - INFO - Сравниваем с ожидаемым результатом: 'Soft blocked: yes'
2025-05-11 21:31:46,197 - server-audit - INFO - Критерий 610 НЕ ПРОЙДЕН
2025-05-11 21:31:46,197 - server-audit - INFO - Выполнение команды для критерия 615 (6.15. Ensure IPv6 is disabled if not in use): sysctl net.ipv6.conf.all.disable_ipv6
2025-05-11 21:31:46,298 - server-audit - INFO - Результат выполнения команды для критерия 615:
2025-05-11 21:31:46,298 - server-audit - INFO - STDOUT: === НАЧАЛО ВЫПОЛНЕНИЯ КОМАНДЫ ===
Команда: echo kali | sudo -S sysctl net.ipv6.conf.all.disable_ipv6
=== РЕЗУЛЬТАТ ВЫПОЛНЕНИЯ ===
net.ipv6.conf.all.disable_ipv6 = 0
=== КОНЕЦ ВЫПОЛНЕНИЯ ===

2025-05-11 21:31:46,298 - server-audit - INFO - STDERR: /tmp/scan_cmd.sh: line 6: nEOFnchmod: command not found

2025-05-11 21:31:46,298 - server-audit - INFO - Сравниваем с ожидаемым результатом: '1'
2025-05-11 21:31:46,298 - server-audit - INFO - Критерий 615 НЕ ПРОЙДЕН
2025-05-11 21:31:46,299 - server-audit - INFO - Выполнение команды для критерия 620 (6.2. Ensure no unconfined daemons exist): ps -eZ | grep -v "^\w\{1,\}-[\w\{1,\}_]\{1,\} " | grep -v "^system_u:system_r:initrc_t:s0 " | grep -v "^unconfined_u:unconfined_r:unconfined_t:s0 " | grep -v "^unconfined_u:unconfined_r:unconfined_t:s0-s0:c0.c1023 " | tr -s " " | cut -d " " -f2 | sort -u || echo "No unconfined daemons"
2025-05-11 21:31:46,416 - server-audit - INFO - Результат выполнения команды для критерия 620:
2025-05-11 21:31:46,416 - server-audit - INFO - STDOUT: === НАЧАЛО ВЫПОЛНЕНИЯ КОМАНДЫ ===
Команда: echo kali | sudo -S ps -eZ | grep -v ^w{1,}-[w{1,}_]{1,}  | grep -v ^system_u:system_r:initrc_t:s0  | grep -v ^unconfined_u:unconfined_r:unconfined_t:s0  | grep -v ^unconfined_u:unconfined_r:unconfined_t:s0-s0:c0.c1023  | tr -s   | cut -d   -f2 | sort -u || echo No unconfined daemons
=== РЕЗУЛЬТАТ ВЫПОЛНЕНИЯ ===
1
100
101
1016
103
109
119
12
1221
1224
13
137614
137697
137699
137700
137718
137743
137754
137839
137847
137923
137925
137926
137927
138978
139137
139138
139169
139249
139256
14
144
149
149445
149570
149571
149572
149573
15
156612
16
163934
163935
164431
164452
164453
164454
17
174
174793
18
180
181
18313
19
19293
198442
2
20
203347
203633
204492
205919
206
207987
208284
209
21
210
211
211110
212
213
214
215
215952
216
217
217988
218573
218591
218600
218635
219612
219821
2199
22
220055
220056
220451
220641
220736
220737
2208
221651
221781
221782
221873
221874
222553
2231
224523
224524
224525
224615
224689
224720
224789
224958
224960
225
225033
225059
225236
225248
225262
225263
225289
225422
225423
225424
225425
225435
225505
225511
225623
2257
225703
225768
225775
225798
225854
225862
226249
226383
226392
226393
226394
226655
226656
226658
226659
226660
226661
226662
226663
226664
226665
226666
23
2357
238
24
263
27
28
29
2952
2959
3
30
302
303
32
33
33641
33647
33662
33665
33670
33671
33681
33688
33690
33737
33853
34
34168
34171
34172
34173
35
3574
3585
3588
3593
3598
36
3684
374
38
3864
398
399
4
4166
422
43
44
45
4534
4602
4617
466
47
48
4850
4866
487
5
50
5080
51
52
54
55
56
563
564
57
58
582
59
6
60
61
616
62
63
64
65
65180
65184
652
65291
66
67
68
69
7
70
71
716
72
73
74
75
76
77
78
79
80
80698
80708
80991
81
82
827
83
85
87
88
89
9
912
920
921
926
934
937
938
96
973
982
99
(enforce)
PID
=== КОНЕЦ ВЫПОЛНЕНИЯ ===

2025-05-11 21:31:46,416 - server-audit - INFO - STDERR: /tmp/scan_cmd.sh: line 6: nEOFnchmod: command not found

2025-05-11 21:31:46,416 - server-audit - INFO - Сравниваем с ожидаемым результатом: 'No unconfined daemons'
2025-05-11 21:31:46,416 - server-audit - INFO - Критерий 620 ПРОЙДЕН
2025-05-11 21:31:46,417 - server-audit - INFO - Выполнение команды для критерия 630 (6.30. Ensure firewall is enabled): ufw status | grep -E "Status:\s*active" || iptables -L -n | grep -q "REJECT\|DROP" && echo "Firewall active"
2025-05-11 21:31:46,601 - server-audit - INFO - Результат выполнения команды для критерия 630:
2025-05-11 21:31:46,602 - server-audit - INFO - STDOUT: === НАЧАЛО ВЫПОЛНЕНИЯ КОМАНДЫ ===
Команда: echo kali | sudo -S ufw status | grep -E Status:s*active || iptables -L -n | grep -q REJECT|DROP && echo Firewall active
=== РЕЗУЛЬТАТ ВЫПОЛНЕНИЯ ===
Команда завершилась с ошибкой: 1
=== КОНЕЦ ВЫПОЛНЕНИЯ ===

2025-05-11 21:31:46,602 - server-audit - INFO - STDERR: iptables v1.8.10 (nf_tables): Could not fetch rule set generation id: Permission denied (you must be root)
/tmp/scan_cmd.sh: line 6: nEOFnchmod: command not found

2025-05-11 21:31:46,602 - server-audit - INFO - Сравниваем с ожидаемым результатом: 'Firewall active'
2025-05-11 21:31:46,602 - server-audit - INFO - Критерий 630 ПРОЙДЕН
2025-05-11 21:31:46,602 - server-audit - INFO - Выполнение команды для критерия 640 (6.4. Ensure outbound connections are restricted): iptables -L OUTPUT -v -n | grep -q 'REJECT\|DROP' && echo 'Outbound filtering active' || echo 'No outbound filtering'
2025-05-11 21:31:46,708 - server-audit - INFO - Результат выполнения команды для критерия 640:
2025-05-11 21:31:46,708 - server-audit - INFO - STDOUT: === НАЧАЛО ВЫПОЛНЕНИЯ КОМАНДЫ ===
Команда: echo kali | sudo -S iptables -L OUTPUT -v -n | grep -q 'REJECT\|DROP' && echo 'Outbound filtering active' || echo 'No outbound filtering'
=== РЕЗУЛЬТАТ ВЫПОЛНЕНИЯ ===
No outbound filtering
=== КОНЕЦ ВЫПОЛНЕНИЯ ===

2025-05-11 21:31:46,708 - server-audit - INFO - STDERR: /tmp/scan_cmd.sh: line 6: nEOFnchmod: command not found

2025-05-11 21:31:46,708 - server-audit - INFO - Сравниваем с ожидаемым результатом: 'Outbound filtering active'
2025-05-11 21:31:46,708 - server-audit - INFO - Критерий 640 ПРОЙДЕН
2025-05-11 21:31:46,708 - server-audit - INFO - Выполнение команды для критерия 650 (6.5. Ensure wireless network interfaces are disabled): ip link | grep -i 'state UP' | grep -i wireless || echo 'No active wireless interfaces'
2025-05-11 21:31:46,805 - server-audit - INFO - Результат выполнения команды для критерия 650:
2025-05-11 21:31:46,805 - server-audit - INFO - STDOUT: === НАЧАЛО ВЫПОЛНЕНИЯ КОМАНДЫ ===
Команда: echo kali | sudo -S ip link | grep -i 'state UP' | grep -i wireless || echo 'No active wireless interfaces'
=== РЕЗУЛЬТАТ ВЫПОЛНЕНИЯ ===
No active wireless interfaces
=== КОНЕЦ ВЫПОЛНЕНИЯ ===

2025-05-11 21:31:46,806 - server-audit - INFO - STDERR: /tmp/scan_cmd.sh: line 6: nEOFnchmod: command not found

2025-05-11 21:31:46,806 - server-audit - INFO - Сравниваем с ожидаемым результатом: 'No active wireless interfaces'
2025-05-11 21:31:46,806 - server-audit - INFO - Критерий 650 ПРОЙДЕН
2025-05-11 21:31:46,806 - server-audit - INFO - Выполнение команды для критерия 710 (7.1. Ensure audit is enabled): systemctl is-active auditd
2025-05-11 21:31:46,912 - server-audit - INFO - Результат выполнения команды для критерия 710:
2025-05-11 21:31:46,912 - server-audit - INFO - STDOUT: === НАЧАЛО ВЫПОЛНЕНИЯ КОМАНДЫ ===
Команда: echo kali | sudo -S systemctl is-active auditd
=== РЕЗУЛЬТАТ ВЫПОЛНЕНИЯ ===
inactive
Команда завершилась с ошибкой: 4
=== КОНЕЦ ВЫПОЛНЕНИЯ ===

2025-05-11 21:31:46,912 - server-audit - INFO - STDERR: /tmp/scan_cmd.sh: line 6: nEOFnchmod: command not found

2025-05-11 21:31:46,913 - server-audit - INFO - Сравниваем с ожидаемым результатом: 'active'
2025-05-11 21:31:46,913 - server-audit - INFO - Критерий 710 ПРОЙДЕН
2025-05-11 21:31:46,913 - server-audit - INFO - Выполнение команды для критерия 720 (7.2. Ensure auditd service is enabled): systemctl is-enabled auditd && echo 'Enabled' || echo 'Not enabled'
2025-05-11 21:31:47,021 - server-audit - INFO - Результат выполнения команды для критерия 720:
2025-05-11 21:31:47,021 - server-audit - INFO - STDOUT: === НАЧАЛО ВЫПОЛНЕНИЯ КОМАНДЫ ===
Команда: echo kali | sudo -S systemctl is-enabled auditd && echo 'Enabled' || echo 'Not enabled'
=== РЕЗУЛЬТАТ ВЫПОЛНЕНИЯ ===
not-found
Not enabled
=== КОНЕЦ ВЫПОЛНЕНИЯ ===

2025-05-11 21:31:47,021 - server-audit - INFO - STDERR: /tmp/scan_cmd.sh: line 6: nEOFnchmod: command not found

2025-05-11 21:31:47,022 - server-audit - INFO - Сравниваем с ожидаемым результатом: 'Enabled'
2025-05-11 21:31:47,022 - server-audit - INFO - Критерий 720 ПРОЙДЕН
2025-05-11 21:31:47,023 - server-audit - INFO - Выполнение команды для критерия 730 (7.3. Ensure rsyslog or syslog-ng is installed): dpkg -s rsyslog || dpkg -s syslog-ng || echo "No syslog service installed"
2025-05-11 21:31:47,134 - server-audit - INFO - Результат выполнения команды для критерия 730:
2025-05-11 21:31:47,134 - server-audit - INFO - STDOUT: === НАЧАЛО ВЫПОЛНЕНИЯ КОМАНДЫ ===
Команда: echo kali | sudo -S dpkg -s rsyslog || dpkg -s syslog-ng || echo No syslog service installed
=== РЕЗУЛЬТАТ ВЫПОЛНЕНИЯ ===
Package: rsyslog
Status: install ok installed
Priority: optional
Section: admin
Installed-Size: 1775
Maintainer: Ubuntu Developers <ubuntu-devel-discuss@lists.ubuntu.com>
Architecture: amd64
Version: 8.2312.0-3ubuntu9.1
Provides: linux-kernel-log-daemon, system-log-daemon
Depends: libc6 (>= 2.38), libestr0 (>= 0.1.9), libfastjson4 (>= 0.99.8), libsystemd0 (>= 246), libuuid1 (>= 2.16), libzstd1 (>= 1.5.5), zlib1g (>= 1:1.1.4), adduser, ucf
Recommends: logrotate
Suggests: rsyslog-mysql | rsyslog-pgsql, rsyslog-mongodb, rsyslog-doc, rsyslog-openssl | rsyslog-gnutls, rsyslog-gssapi, rsyslog-relp, apparmor (>= 2.8.96~2541-0ubuntu4~)
Conflicts: linux-kernel-log-daemon, system-log-daemon
Conffiles:
 /etc/apparmor.d/rsyslog.d/README 85ad3bd22e3539dff283a25c3c4e118e
 /etc/apparmor.d/usr.sbin.rsyslogd ecb568ee9b5dcc6c74053465d88b8516
 /etc/logcheck/ignore.d.server/rsyslog 58c2337cacd6a3296c2c9728fc3e52fd
 /etc/logrotate.d/rsyslog 3f26282ac0106961634fe4efb9edc3f4
 /etc/rsyslog.conf a14b59f17abdcfda417f99a99c030e67
Description: reliable system and kernel logging daemon
 Rsyslog is a multi-threaded implementation of syslogd (a system utility
 providing support for message logging), with features that include:
  * reliable syslog over TCP, SSL/TLS and RELP
  * on-demand disk buffering
  * email alerting
  * writing to MySQL or PostgreSQL databases (via separate output plugins)
  * permitted sender lists
  * filtering on any part of the syslog message
  * on-the-wire message compression
  * fine-grained output format control
  * failover to backup destinations
  * enterprise-class encrypted syslog relaying
 .
 It is the default syslogd on Debian systems.
Homepage: https://www.rsyslog.com/
Original-Maintainer: Michael Biebl <biebl@debian.org>
=== КОНЕЦ ВЫПОЛНЕНИЯ ===

2025-05-11 21:31:47,134 - server-audit - INFO - STDERR: /tmp/scan_cmd.sh: line 6: nEOFnchmod: command not found

2025-05-11 21:31:47,134 - server-audit - INFO - Сравниваем с ожидаемым результатом: 'Status: install ok installed'
2025-05-11 21:31:47,135 - server-audit - INFO - Критерий 730 ПРОЙДЕН
2025-05-11 21:31:47,135 - server-audit - INFO - Выполнение команды для критерия 740 (7.4. Ensure logrotate is configured): grep -r "^rotate" /etc/logrotate.d/ /etc/logrotate.conf | grep -v "^#" && echo 'Logrotate configured' || echo 'Logrotate not configured'
2025-05-11 21:31:47,243 - server-audit - INFO - Результат выполнения команды для критерия 740:
2025-05-11 21:31:47,243 - server-audit - INFO - STDOUT: === НАЧАЛО ВЫПОЛНЕНИЯ КОМАНДЫ ===
Команда: echo kali | sudo -S grep -r ^rotate /etc/logrotate.d/ /etc/logrotate.conf | grep -v ^# && echo 'Logrotate configured' || echo 'Logrotate not configured'
=== РЕЗУЛЬТАТ ВЫПОЛНЕНИЯ ===
/etc/logrotate.conf:rotate 4
Logrotate configured
=== КОНЕЦ ВЫПОЛНЕНИЯ ===

2025-05-11 21:31:47,243 - server-audit - INFO - STDERR: /tmp/scan_cmd.sh: line 6: nEOFnchmod: command not found

2025-05-11 21:31:47,244 - server-audit - INFO - Сравниваем с ожидаемым результатом: 'Logrotate configured'
2025-05-11 21:31:47,244 - server-audit - INFO - Критерий 740 ПРОЙДЕН
2025-05-11 21:31:47,244 - server-audit - INFO - Выполнение команды для критерия 750 (7.5. Ensure remote syslog is configured): grep -E '^[^#].*@.*' /etc/rsyslog.conf /etc/rsyslog.d/*.conf && echo 'Remote logging configured' || echo 'Remote logging not configured'
2025-05-11 21:31:47,354 - server-audit - INFO - Результат выполнения команды для критерия 750:
2025-05-11 21:31:47,354 - server-audit - INFO - STDOUT: === НАЧАЛО ВЫПОЛНЕНИЯ КОМАНДЫ ===
Команда: echo kali | sudo -S grep -E '^[^#].*@.*' /etc/rsyslog.conf /etc/rsyslog.d/*.conf && echo 'Remote logging configured' || echo 'Remote logging not configured'
=== РЕЗУЛЬТАТ ВЫПОЛНЕНИЯ ===
Remote logging not configured
=== КОНЕЦ ВЫПОЛНЕНИЯ ===

2025-05-11 21:31:47,354 - server-audit - INFO - STDERR: /tmp/scan_cmd.sh: line 6: nEOFnchmod: command not found

2025-05-11 21:31:47,354 - server-audit - INFO - Сравниваем с ожидаемым результатом: 'Remote logging configured'
2025-05-11 21:31:47,354 - server-audit - INFO - Критерий 750 ПРОЙДЕН
2025-05-11 21:31:47,355 - server-audit - INFO - Выполнение команды для критерия 810 (8.1. Ensure password expiration is 90 days or less): grep PASS_MAX_DAYS /etc/login.defs
2025-05-11 21:31:47,466 - server-audit - INFO - Результат выполнения команды для критерия 810:
2025-05-11 21:31:47,467 - server-audit - INFO - STDOUT: === НАЧАЛО ВЫПОЛНЕНИЯ КОМАНДЫ ===
Команда: echo kali | sudo -S grep PASS_MAX_DAYS /etc/login.defs
=== РЕЗУЛЬТАТ ВЫПОЛНЕНИЯ ===
#	PASS_MAX_DAYS	Maximum number of days a password may be used.
PASS_MAX_DAYS	99999
=== КОНЕЦ ВЫПОЛНЕНИЯ ===

2025-05-11 21:31:47,467 - server-audit - INFO - STDERR: /tmp/scan_cmd.sh: line 6: nEOFnchmod: command not found

2025-05-11 21:31:47,467 - server-audit - INFO - Сравниваем с ожидаемым результатом: '90'
2025-05-11 21:31:47,467 - server-audit - INFO - Критерий 810 НЕ ПРОЙДЕН
2025-05-11 21:31:47,467 - server-audit - INFO - Выполнение команды для критерия 820 (8.2. Ensure all users have a valid password hash): cat /etc/shadow | awk -F: '($2 == "" ) { print $1 " has no password" ; exit 1 }' || echo "No empty passwords"
2025-05-11 21:31:47,568 - server-audit - INFO - Результат выполнения команды для критерия 820:
2025-05-11 21:31:47,568 - server-audit - INFO - STDOUT: === НАЧАЛО ВЫПОЛНЕНИЯ КОМАНДЫ ===
Команда: echo kali | sudo -S cat /etc/shadow | awk -F: '( ==  ) { print   has no password ; exit 1 }' || echo No empty passwords
=== РЕЗУЛЬТАТ ВЫПОЛНЕНИЯ ===
=== КОНЕЦ ВЫПОЛНЕНИЯ ===

2025-05-11 21:31:47,568 - server-audit - INFO - STDERR: /tmp/scan_cmd.sh: line 6: nEOFnchmod: command not found

2025-05-11 21:31:47,569 - server-audit - INFO - Сравниваем с ожидаемым результатом: 'No empty passwords'
2025-05-11 21:31:47,569 - server-audit - INFO - Критерий 820 ПРОЙДЕН
2025-05-11 21:31:47,569 - server-audit - INFO - Выполнение команды для критерия 830 (8.3. Ensure minimum days between password changes is 7 or more): grep -E '^PASS_MIN_DAYS\s+[7-9]|^PASS_MIN_DAYS\s+[1-9][0-9]+' /etc/login.defs && echo 'Correctly configured' || echo 'Not properly configured'
2025-05-11 21:31:47,678 - server-audit - INFO - Результат выполнения команды для критерия 830:
2025-05-11 21:31:47,679 - server-audit - INFO - STDOUT: === НАЧАЛО ВЫПОЛНЕНИЯ КОМАНДЫ ===
Команда: echo kali | sudo -S grep -E '^PASS_MIN_DAYS\s+[7-9]|^PASS_MIN_DAYS\s+[1-9][0-9]+' /etc/login.defs && echo 'Correctly configured' || echo 'Not properly configured'
=== РЕЗУЛЬТАТ ВЫПОЛНЕНИЯ ===
Not properly configured
=== КОНЕЦ ВЫПОЛНЕНИЯ ===

2025-05-11 21:31:47,679 - server-audit - INFO - STDERR: /tmp/scan_cmd.sh: line 6: nEOFnchmod: command not found

2025-05-11 21:31:47,679 - server-audit - INFO - Сравниваем с ожидаемым результатом: 'Correctly configured'
2025-05-11 21:31:47,679 - server-audit - INFO - Критерий 830 ПРОЙДЕН
2025-05-11 21:31:47,679 - server-audit - INFO - Выполнение команды для критерия 840 (8.4. Ensure password hashing algorithm is SHA-512): grep -E '^password\s+[^\s]+\s+pam_unix.so\s+.*sha512' /etc/pam.d/common-password && echo 'SHA-512 enabled' || echo 'SHA-512 not enabled'
2025-05-11 21:31:47,782 - server-audit - INFO - Результат выполнения команды для критерия 840:
2025-05-11 21:31:47,782 - server-audit - INFO - STDOUT: === НАЧАЛО ВЫПОЛНЕНИЯ КОМАНДЫ ===
Команда: echo kali | sudo -S grep -E '^password\s+[^\s]+\s+pam_unix.so\s+.*sha512' /etc/pam.d/common-password && echo 'SHA-512 enabled' || echo 'SHA-512 not enabled'
=== РЕЗУЛЬТАТ ВЫПОЛНЕНИЯ ===
SHA-512 not enabled
=== КОНЕЦ ВЫПОЛНЕНИЯ ===

2025-05-11 21:31:47,782 - server-audit - INFO - STDERR: /tmp/scan_cmd.sh: line 6: nEOFnchmod: command not found

2025-05-11 21:31:47,782 - server-audit - INFO - Сравниваем с ожидаемым результатом: 'SHA-512 enabled'
2025-05-11 21:31:47,782 - server-audit - INFO - Критерий 840 ПРОЙДЕН
2025-05-11 21:31:47,782 - server-audit - INFO - Выполнение команды для критерия 910 (9.1. Ensure SSH warning banner is configured): grep Banner /etc/ssh/sshd_config
2025-05-11 21:31:47,887 - server-audit - INFO - Результат выполнения команды для критерия 910:
2025-05-11 21:31:47,888 - server-audit - INFO - STDOUT: === НАЧАЛО ВЫПОЛНЕНИЯ КОМАНДЫ ===
Команда: echo kali | sudo -S grep Banner /etc/ssh/sshd_config
=== РЕЗУЛЬТАТ ВЫПОЛНЕНИЯ ===
#Banner none
=== КОНЕЦ ВЫПОЛНЕНИЯ ===

2025-05-11 21:31:47,888 - server-audit - INFO - STDERR: /tmp/scan_cmd.sh: line 6: nEOFnchmod: command not found

2025-05-11 21:31:47,888 - server-audit - INFO - Сравниваем с ожидаемым результатом: '/etc/issue.net'
2025-05-11 21:31:47,888 - server-audit - INFO - Критерий 910 НЕ ПРОЙДЕН
2025-05-11 21:31:47,888 - server-audit - INFO - Выполнение команды для критерия 920 (9.2. Ensure /etc/issue contains appropriate warning): grep -E 'Authorized users only|authorized use only|unauthorized access prohibited' /etc/issue && echo 'Warning exists' || echo 'No appropriate warning'
2025-05-11 21:31:47,995 - server-audit - INFO - Результат выполнения команды для критерия 920:
2025-05-11 21:31:47,996 - server-audit - INFO - STDOUT: === НАЧАЛО ВЫПОЛНЕНИЯ КОМАНДЫ ===
Команда: echo kali | sudo -S grep -E 'Authorized users only|authorized use only|unauthorized access prohibited' /etc/issue && echo 'Warning exists' || echo 'No appropriate warning'
=== РЕЗУЛЬТАТ ВЫПОЛНЕНИЯ ===
No appropriate warning
=== КОНЕЦ ВЫПОЛНЕНИЯ ===

2025-05-11 21:31:47,996 - server-audit - INFO - STDERR: /tmp/scan_cmd.sh: line 6: nEOFnchmod: command not found

2025-05-11 21:31:47,996 - server-audit - INFO - Сравниваем с ожидаемым результатом: 'Warning exists'
2025-05-11 21:31:47,996 - server-audit - INFO - Критерий 920 ПРОЙДЕН
2025-05-11 21:31:47,996 - server-audit - INFO - Выполнение команды для критерия 930 (9.3. Ensure remote login warning banner is configured): grep -E 'Authorized users only|authorized use only|unauthorized access prohibited' /etc/issue.net && echo 'Warning exists' || echo 'No appropriate warning'
2025-05-11 21:31:48,109 - server-audit - INFO - Результат выполнения команды для критерия 930:
2025-05-11 21:31:48,110 - server-audit - INFO - STDOUT: === НАЧАЛО ВЫПОЛНЕНИЯ КОМАНДЫ ===
Команда: echo kali | sudo -S grep -E 'Authorized users only|authorized use only|unauthorized access prohibited' /etc/issue.net && echo 'Warning exists' || echo 'No appropriate warning'
=== РЕЗУЛЬТАТ ВЫПОЛНЕНИЯ ===
No appropriate warning
=== КОНЕЦ ВЫПОЛНЕНИЯ ===

2025-05-11 21:31:48,110 - server-audit - INFO - STDERR: /tmp/scan_cmd.sh: line 6: nEOFnchmod: command not found

2025-05-11 21:31:48,110 - server-audit - INFO - Сравниваем с ожидаемым результатом: 'Warning exists'
2025-05-11 21:31:48,110 - server-audit - INFO - Критерий 930 ПРОЙДЕН
2025-05-11 21:31:48,111 - server-audit - INFO - Выполнение команды для критерия 1010 (10.1. Ensure permissions on /etc/passwd are configured): stat -c "%a %u %g" /etc/passwd
2025-05-11 21:31:48,214 - server-audit - INFO - Результат выполнения команды для критерия 1010:
2025-05-11 21:31:48,214 - server-audit - INFO - STDOUT: === НАЧАЛО ВЫПОЛНЕНИЯ КОМАНДЫ ===
Команда: echo kali | sudo -S stat -c %a %u %g /etc/passwd
=== РЕЗУЛЬТАТ ВЫПОЛНЕНИЯ ===
644 0 0
=== КОНЕЦ ВЫПОЛНЕНИЯ ===

2025-05-11 21:31:48,214 - server-audit - INFO - STDERR: /tmp/scan_cmd.sh: line 6: nEOFnchmod: command not found

2025-05-11 21:31:48,214 - server-audit - INFO - Сравниваем с ожидаемым результатом: '644 0 0'
2025-05-11 21:31:48,214 - server-audit - INFO - Критерий 1010 ПРОЙДЕН
2025-05-11 21:31:48,214 - server-audit - INFO - Выполнение команды для критерия 1020 (10.2. Ensure permissions on /etc/shadow are configured): stat -c "%a %u %g" /etc/shadow
2025-05-11 21:31:48,316 - server-audit - INFO - Результат выполнения команды для критерия 1020:
2025-05-11 21:31:48,317 - server-audit - INFO - STDOUT: === НАЧАЛО ВЫПОЛНЕНИЯ КОМАНДЫ ===
Команда: echo kali | sudo -S stat -c %a %u %g /etc/shadow
=== РЕЗУЛЬТАТ ВЫПОЛНЕНИЯ ===
640 0 42
=== КОНЕЦ ВЫПОЛНЕНИЯ ===

2025-05-11 21:31:48,317 - server-audit - INFO - STDERR: /tmp/scan_cmd.sh: line 6: nEOFnchmod: command not found

2025-05-11 21:31:48,318 - server-audit - INFO - Сравниваем с ожидаемым результатом: '640 0 42'
2025-05-11 21:31:48,318 - server-audit - INFO - Критерий 1020 ПРОЙДЕН
2025-05-11 21:31:48,318 - server-audit - INFO - Выполнение команды для критерия 1030 (10.3. Ensure permissions on /etc/group are configured): stat -c "%a %u %g" /etc/group | grep -q '644 0 0' && echo 'Permissions correct' || echo 'Permissions incorrect'
2025-05-11 21:31:48,426 - server-audit - INFO - Результат выполнения команды для критерия 1030:
2025-05-11 21:31:48,427 - server-audit - INFO - STDOUT: === НАЧАЛО ВЫПОЛНЕНИЯ КОМАНДЫ ===
Команда: echo kali | sudo -S stat -c %a %u %g /etc/group | grep -q '644 0 0' && echo 'Permissions correct' || echo 'Permissions incorrect'
=== РЕЗУЛЬТАТ ВЫПОЛНЕНИЯ ===
Permissions correct
=== КОНЕЦ ВЫПОЛНЕНИЯ ===

2025-05-11 21:31:48,427 - server-audit - INFO - STDERR: /tmp/scan_cmd.sh: line 6: nEOFnchmod: command not found

2025-05-11 21:31:48,427 - server-audit - INFO - Сравниваем с ожидаемым результатом: 'Permissions correct'
2025-05-11 21:31:48,427 - server-audit - INFO - Критерий 1030 ПРОЙДЕН
2025-05-11 21:31:48,427 - server-audit - INFO - Выполнение команды для критерия 1040 (10.4. Ensure permissions on /etc/gshadow are configured): stat -c "%a %u %g" /etc/gshadow | grep -q '640 0 42' && echo 'Permissions correct' || echo 'Permissions incorrect'
2025-05-11 21:31:48,533 - server-audit - INFO - Результат выполнения команды для критерия 1040:
2025-05-11 21:31:48,533 - server-audit - INFO - STDOUT: === НАЧАЛО ВЫПОЛНЕНИЯ КОМАНДЫ ===
Команда: echo kali | sudo -S stat -c %a %u %g /etc/gshadow | grep -q '640 0 42' && echo 'Permissions correct' || echo 'Permissions incorrect'
=== РЕЗУЛЬТАТ ВЫПОЛНЕНИЯ ===
Permissions correct
=== КОНЕЦ ВЫПОЛНЕНИЯ ===

2025-05-11 21:31:48,533 - server-audit - INFO - STDERR: /tmp/scan_cmd.sh: line 6: nEOFnchmod: command not found

2025-05-11 21:31:48,533 - server-audit - INFO - Сравниваем с ожидаемым результатом: 'Permissions correct'
2025-05-11 21:31:48,533 - server-audit - INFO - Критерий 1040 ПРОЙДЕН
2025-05-11 21:31:48,533 - server-audit - INFO - Выполнение команды для критерия 1050 (10.5. Ensure no unauthorized world-writable directories exist): df --local -P | awk {'if (NR!=1) print $6'} | xargs -I '{}' find '{}' -xdev -type d -perm -0002 -not -perm -1000 -print 2>/dev/null || echo 'No world-writable directories without sticky bit found'
2025-05-11 21:31:49,336 - server-audit - INFO - Результат выполнения команды для критерия 1050:
2025-05-11 21:31:49,337 - server-audit - INFO - STDOUT: === НАЧАЛО ВЫПОЛНЕНИЯ КОМАНДЫ ===
Команда: echo kali | sudo -S df --local -P | awk {'if (NR!=1) print '} | xargs -I '{}' find '{}' -xdev -type d -perm -0002 -not -perm -1000 -print 2>/dev/null || echo 'No world-writable directories without sticky bit found'
=== РЕЗУЛЬТАТ ВЫПОЛНЕНИЯ ===
No world-writable directories without sticky bit found
=== КОНЕЦ ВЫПОЛНЕНИЯ ===

2025-05-11 21:31:49,337 - server-audit - INFO - STDERR: /tmp/scan_cmd.sh: line 6: nEOFnchmod: command not found

2025-05-11 21:31:49,337 - server-audit - INFO - Сравниваем с ожидаемым результатом: 'No world-writable directories without sticky bit found'
2025-05-11 21:31:49,337 - server-audit - INFO - Критерий 1050 ПРОЙДЕН
2025-05-11 21:31:49,337 - server-audit - INFO - Выполнение команды для критерия 1110 (11.1. Ensure root PATH integrity): echo $PATH | grep -q "::" && echo "Empty Directory" || echo "1"
2025-05-11 21:31:49,446 - server-audit - INFO - Результат выполнения команды для критерия 1110:
2025-05-11 21:31:49,447 - server-audit - INFO - STDOUT: === НАЧАЛО ВЫПОЛНЕНИЯ КОМАНДЫ ===
Команда: echo kali | sudo -S echo /usr/local/sbin:/usr/local/bin:/usr/sbin:/usr/bin:/sbin:/bin:/usr/games:/usr/local/games:/snap/bin | grep -q :: && echo Empty Directory || echo 1
=== РЕЗУЛЬТАТ ВЫПОЛНЕНИЯ ===
1
=== КОНЕЦ ВЫПОЛНЕНИЯ ===

2025-05-11 21:31:49,447 - server-audit - INFO - STDERR: /tmp/scan_cmd.sh: line 6: nEOFnchmod: command not found

2025-05-11 21:31:49,447 - server-audit - INFO - Сравниваем с ожидаемым результатом: '1'
2025-05-11 21:31:49,447 - server-audit - INFO - Критерий 1110 ПРОЙДЕН
2025-05-11 21:31:49,447 - server-audit - INFO - Выполнение команды для критерия 1120 (11.2. Ensure no world-writable files exist): df --local -P | awk {'if (NR!=1) print $6'} | xargs -I '{}' find '{}' -xdev -type f -perm -0002 -print 2>/dev/null || echo 'No world-writable files found'
2025-05-11 21:31:49,836 - server-audit - INFO - Результат выполнения команды для критерия 1120:
2025-05-11 21:31:49,837 - server-audit - INFO - STDOUT: === НАЧАЛО ВЫПОЛНЕНИЯ КОМАНДЫ ===
Команда: echo kali | sudo -S df --local -P | awk {'if (NR!=1) print '} | xargs -I '{}' find '{}' -xdev -type f -perm -0002 -print 2>/dev/null || echo 'No world-writable files found'
=== РЕЗУЛЬТАТ ВЫПОЛНЕНИЯ ===
No world-writable files found
=== КОНЕЦ ВЫПОЛНЕНИЯ ===

2025-05-11 21:31:49,837 - server-audit - INFO - STDERR: /tmp/scan_cmd.sh: line 6: nEOFnchmod: command not found

2025-05-11 21:31:49,837 - server-audit - INFO - Сравниваем с ожидаемым результатом: 'No world-writable files found'
2025-05-11 21:31:49,837 - server-audit - INFO - Критерий 1120 ПРОЙДЕН
2025-05-11 21:31:49,837 - server-audit - INFO - Выполнение команды для критерия 1130 (11.3. Ensure no unowned files or directories exist): df --local -P | awk {'if (NR!=1) print $6'} | xargs -I '{}' find '{}' -xdev -nouser -ls 2>/dev/null || echo 'No unowned files found'
2025-05-11 21:31:50,729 - server-audit - INFO - Результат выполнения команды для критерия 1130:
2025-05-11 21:31:50,730 - server-audit - INFO - STDOUT: === НАЧАЛО ВЫПОЛНЕНИЯ КОМАНДЫ ===
Команда: echo kali | sudo -S df --local -P | awk {'if (NR!=1) print '} | xargs -I '{}' find '{}' -xdev -nouser -ls 2>/dev/null || echo 'No unowned files found'
=== РЕЗУЛЬТАТ ВЫПОЛНЕНИЯ ===
No unowned files found
=== КОНЕЦ ВЫПОЛНЕНИЯ ===

2025-05-11 21:31:50,730 - server-audit - INFO - STDERR: /tmp/scan_cmd.sh: line 6: nEOFnchmod: command not found

2025-05-11 21:31:50,730 - server-audit - INFO - Сравниваем с ожидаемым результатом: 'No unowned files found'
2025-05-11 21:31:50,730 - server-audit - INFO - Критерий 1130 ПРОЙДЕН
2025-05-11 21:31:50,730 - server-audit - INFO - Выполнение команды для критерия 1210 (12.1. Ensure no users have .forward files): find /home -name .forward
2025-05-11 21:31:50,893 - server-audit - INFO - Результат выполнения команды для критерия 1210:
2025-05-11 21:31:50,893 - server-audit - INFO - STDOUT: === НАЧАЛО ВЫПОЛНЕНИЯ КОМАНДЫ ===
Команда: echo kali | sudo -S find /home -name .forward
=== РЕЗУЛЬТАТ ВЫПОЛНЕНИЯ ===
=== КОНЕЦ ВЫПОЛНЕНИЯ ===

2025-05-11 21:31:50,893 - server-audit - INFO - STDERR: /tmp/scan_cmd.sh: line 6: nEOFnchmod: command not found

2025-05-11 21:31:50,894 - server-audit - INFO - Сравниваем с ожидаемым результатом: ''
2025-05-11 21:31:50,894 - server-audit - INFO - Критерий 1210 ПРОЙДЕН
2025-05-11 21:31:50,894 - server-audit - INFO - Выполнение команды для критерия 1220 (12.2. Ensure no users have .netrc files): find /home -name .netrc 2>/dev/null || echo 'No .netrc files found'
2025-05-11 21:31:51,050 - server-audit - INFO - Результат выполнения команды для критерия 1220:
2025-05-11 21:31:51,050 - server-audit - INFO - STDOUT: === НАЧАЛО ВЫПОЛНЕНИЯ КОМАНДЫ ===
Команда: echo kali | sudo -S find /home -name .netrc 2>/dev/null || echo 'No .netrc files found'
=== РЕЗУЛЬТАТ ВЫПОЛНЕНИЯ ===
=== КОНЕЦ ВЫПОЛНЕНИЯ ===

2025-05-11 21:31:51,050 - server-audit - INFO - STDERR: /tmp/scan_cmd.sh: line 6: nEOFnchmod: command not found

2025-05-11 21:31:51,050 - server-audit - INFO - Сравниваем с ожидаемым результатом: 'No .netrc files found'
2025-05-11 21:31:51,050 - server-audit - INFO - Критерий 1220 ПРОЙДЕН
2025-05-11 21:31:51,050 - server-audit - INFO - Выполнение команды для критерия 1230 (12.3. Ensure all user home directories have proper permissions): for dir in $(cut -d: -f6 /etc/passwd | grep -v '^/$'); do [ -d "$dir" ] && stat -L -c '%A' "$dir" | cut -c6-10 | grep -q '^-----$' && echo 'Permissions correct' || echo 'Permissions incorrect'; done
2025-05-11 21:31:51,142 - server-audit - INFO - Результат выполнения команды для критерия 1230:
2025-05-11 21:31:51,143 - server-audit - INFO - STDOUT: === НАЧАЛО ВЫПОЛНЕНИЯ КОМАНДЫ ===
Команда: echo kali | sudo -S for dir in /root
/usr/sbin
/bin
/dev
/bin
/usr/games
/var/cache/man
/var/spool/lpd
/var/mail
/var/spool/news
/var/spool/uucp
/bin
/var/www
/var/backups
/var/list
/run/ircd
/nonexistent
/nonexistent
/usr/lib/dhcpcd
/nonexistent
/var/cache/pollinate
/nonexistent
/run/uuidd
/nonexistent
/var/lib/tpm
/var/lib/landscape
/var/lib/fwupd
/var/lib/usbmux
/home/aidar
/var/lib/misc
/nonexistent
/nonexistent
/var/spool/postfix
/run/sshd
/home/ayan
/home/wazuh-indexer
/var/ossec
/nonexistent; do [ -d  ] && stat -L -c '%A'  | cut -c6-10 | grep -q '^-----$' && echo 'Permissions correct' || echo 'Permissions incorrect'; done
=== РЕЗУЛЬТАТ ВЫПОЛНЕНИЯ ===

2025-05-11 21:31:51,143 - server-audit - INFO - STDERR: /tmp/scan_cmd.sh: line 4: syntax error near unexpected token `do'
/tmp/scan_cmd.sh: line 4: `echo "kali" | sudo -S for dir in $(cut -d: -f6 /etc/passwd | grep -v '^/$'); do [ -d "$dir" ] && stat -L -c '%A' "$dir" | cut -c6-10 | grep -q '^-----$' && echo 'Permissions correct' || echo 'Permissions incorrect'; done 2>&1 || echo "Команда завершилась с ошибкой: $?"'

2025-05-11 21:31:51,143 - server-audit - INFO - Сравниваем с ожидаемым результатом: 'Permissions correct'
2025-05-11 21:31:51,143 - server-audit - INFO - Критерий 1230 ПРОЙДЕН
2025-05-11 21:31:51,143 - server-audit - INFO - Выполнение команды для критерия 1240 (12.4. Ensure default user umask is 027 or more restrictive): grep -E '^\s*umask\s+([0-7][0-7]27|[0-7]22)' /etc/profile /etc/bash.bashrc /etc/profile.d/*.sh && echo 'Umask properly configured' || echo 'Umask not configured'
2025-05-11 21:31:51,252 - server-audit - INFO - Результат выполнения команды для критерия 1240:
2025-05-11 21:31:51,252 - server-audit - INFO - STDOUT: === НАЧАЛО ВЫПОЛНЕНИЯ КОМАНДЫ ===
Команда: echo kali | sudo -S grep -E '^\s*umask\s+([0-7][0-7]27|[0-7]22)' /etc/profile /etc/bash.bashrc /etc/profile.d/*.sh && echo 'Umask properly configured' || echo 'Umask not configured'
=== РЕЗУЛЬТАТ ВЫПОЛНЕНИЯ ===
Umask not configured
=== КОНЕЦ ВЫПОЛНЕНИЯ ===

2025-05-11 21:31:51,252 - server-audit - INFO - STDERR: /tmp/scan_cmd.sh: line 6: nEOFnchmod: command not found

2025-05-11 21:31:51,252 - server-audit - INFO - Сравниваем с ожидаемым результатом: 'Umask properly configured'
2025-05-11 21:31:51,252 - server-audit - INFO - Критерий 1240 ПРОЙДЕН
2025-05-11 21:31:51,299 - server-audit - INFO - Временный файл sudoers удален
2025-05-11 21:31:51,299 - server-audit - INFO - Сканирование сервера 25.15.212.99 завершено. Закрываем SSH-соединение.
